/*     
 * ChartNew.js  
 *
 * Vancoppenolle Francois - January 2014
 * francois.vancoppenolle@favomo.be
 *
 * Source location : http:\\www.favomo.be\graphjs
 * GitHub community : https://github.com/FVANCOP/ChartNew.js
 *
 * This file is originally an adaptation of the chart.js source developped by Nick Downie (2013)
 * https://github.com/nnnick/Chart.js. But since june 2014, Nick puts a new version with a
 * refunded code. Current code of ChartNew.js is no more comparable to the code of Chart.js 
 */
 function roundToWithThousands(e,t,n){var r=1*unFormat(e,t);if(typeof r=="number"&&n!="none"){if(n<=0){var i=-n;r=+(Math.round(r+"e+"+i)+"e-"+i)}else{var i=n;var s="1e+"+i;r=+Math.round(r/s)*s}}r=fmtChartJS(e,r,"none");return r}function unFormat(e,t){if((e.decimalSeparator!="."||e.thousandSeparator!="")&&typeof t=="string"){var n=""+t;if(e.thousandSeparator!=""){while(n.indexOf(e.thousandSeparator)>=0)n=""+n.replace(e.thousandSeparator,"")}if(e.decimalSeparator!=".")n=""+n.replace(e.decimalSeparator,".");return 1*n}else{return t}}function fmtChartJSPerso(e,t,n){switch(n){case"SampleJS_Format":if(typeof t=="number")return_value="My Format : "+t.toString()+" $";else return_value=t+"XX";break;case"Change_Month":if(typeof t=="string")return_value=t.toString()+" 2014";else return_value=t.toString()+"YY";break;default:return_value=t;break}return return_value}function fmtChartJS(e,t,n){var r;if(n=="notformatted"){r=t}else if(n=="none"&&typeof t=="number"){if(e.roundNumber!="none"){if(e.roundNumber<=0){var i=-e.roundNumber;t=+(Math.round(t+"e+"+i)+"e-"+i)}else{var i=e.roundNumber;var s="1e+"+i;t=+Math.round(t/s)*s}}if(e.decimalSeparator!="."||e.thousandSeparator!=""){r=t.toString().replace(/\./g,e.decimalSeparator);if(e.thousandSeparator!=""){var o=r;var u="";var a=o.indexOf(e.decimalSeparator);if(a>=0){u=o.substring(a+1,o.length);u=u.split("").reverse().join("");o=o.substring(0,a)}o=o.toString().replace(/\B(?=(\d{3})+(?!\d))/g,e.thousandSeparator);u=u.split("").reverse().join("");r=o;if(u!="")r=r+e.decimalSeparator+u}}else r=t}else if(n!="none"&&n!="notformatted"){r=fmtChartJSPerso(e,t,n)}else{r=t}return r}function addParameters2Function(data,fctName,fctList){var mathFunctions={mean:{data:data.data,datasetNr:data.v11},varianz:{data:data.data,datasetNr:data.v11},stddev:{data:data.data,datasetNr:data.v11},cv:{data:data.data,datasetNr:data.v11},median:{data:data.data,datasetNr:data.v11}};dif=false;if(fctName.substr(-3)=="Dif"){fctName=fctName.substr(0,fctName.length-3);dif=true}if(typeof eval(fctName)=="function"){var parameter=eval(fctList+"."+fctName);if(dif){return data.v3-window[fctName](parameter)}return window[fctName](parameter)}return}function isNumber(e){return!isNaN(parseFloat(e))&&isFinite(e)}function tmplbis(e,t){var n=["mean","varianz","stddev","cv","median"];var r=new RegExp("<%=((?:(?:.*?)\\W)??)((?:"+n.join("|")+")(?:Dif)?)\\(([0-9]*?)\\)(.*?)%>","g");while(r.test(e)){e=e.replace(r,function(e,n,r,i,s){if(i){var o=i}else{var o=2}var u=addParameters2Function(t,r,"mathFunctions");if(isNumber(u)){return"<%="+n+""+Math.round(Math.pow(10,o)*u)/Math.pow(10,o)+""+s+"%>"}return"<%= %>"})}var i=/^[A-Za-z][-A-Za-z0-9_:.]*$/.test(e)?cachebis[e]=cachebis[e]||tmplbis(document.getElementById(e).innerHTML):new Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};"+"with(obj){p.push('"+e.replace(/[\r\n]/g,"\\n").replace(/[\t]/g," ").split("<%").join("	").replace(/((^|%>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)%>/g,"',$1,'").split("	").join("');").split("%>").join("p.push('").split("\r").join("\\'")+"');}return p.join('');");return t?i(t):i}function createCursorDiv(){if(cursorDivCreated==false){var e=document.createElement("divCursor");e.id="divCursor";e.style.position="absolute";document.body.appendChild(e);cursorDivCreated=true}}function addResponsiveChart(e,t,n,r){initChartResize();var i=resizeGraph(t,r);if(typeof t.prevWidth!="undefined"){resizeCtx(t,i.newWidth,i.newHeight);t.prevWidth=i.newWidth}t.prevWidth=i.newWidth;t.prevHeight=i.newHeight;jsGraphResize[jsGraphResize.length]=[e,t.tpchart,t,n,r]}function initChartResize(){if(initChartJsResize==false){if(window.addEventListener){window.addEventListener("resize",chartJsResize)}else{window.attachEvent("resize",chartJsResize)}}}function getMaximumWidth(e){var t=e.parentNode;return t.clientWidth}function getMaximumHeight(e){var t=e.parentNode;return t.clientHeight}function resizeCtx(e,t,n){if(window.devicePixelRatio){e.canvas.style.width=t/window.devicePixelRatio+"px";e.canvas.style.height=n/window.devicePixelRatio+"px";e.canvas.height=n/window.devicePixelRatio*window.devicePixelRatio;e.canvas.width=t/window.devicePixelRatio*window.devicePixelRatio;e.scale(window.devicePixelRatio,window.devicePixelRatio)}else{e.canvas.height=n;e.canvas.width=t}}function resizeGraph(e,t){if(typeof t.maintainAspectRatio=="undefined")t.maintainAspectRatio=true;if(typeof t.responiveMinWidth=="undefined")t.responsiveMinWidth=0;if(typeof t.responsiveMinHeight=="undefined")t.responsiveMinHeight=0;if(typeof t.responsiveMaxWidth=="undefined")t.responsiveMaxWidth=9999999;if(typeof t.responsiveMaxHeight=="undefined")t.responsiveMaxHeight=9999999;var n=e.canvas;if(typeof e.aspectRatio=="undefined"){e.aspectRatio=n.width/n.height}var r=getMaximumWidth(n);var i=t.maintainAspectRatio?r/e.aspectRatio:getMaximumHeight(n);r=Math.min(t.responsiveMaxWidth,Math.max(t.responsiveMinWidth,r));i=Math.min(t.responsiveMaxHeight,Math.max(t.responsiveMinHeight,i));return{newWidth:parseInt(r),newHeight:parseInt(i)}}function chartJsResize(){for(var e=0;e<jsGraphResize.length;e++){if(typeof jsGraphResize[e][2].firstPass!="undefined"){if(jsGraphResize[e][2].firstPass==5)jsGraphResize[e][2].firstPass=6}subUpdateChart(jsGraphResize[e][2],jsGraphResize[e][3],jsGraphResize[e][4])}}function testRedraw(e,t,n){if(e.firstPass==2||e.firstPass==4||e.firstPass==9){e.firstPass=6;subUpdateChart(e,t,n);return true}else{e.firstPass=5;return false}}function updateChart(e,t,n,r,i){if(e.firstPass==5){e.runanimationcompletefunction=i;if(r)e.firstPass=0;else if(n.responsive)e.firstPass=7;else e.firstPass=7;subUpdateChart(e,t,n)}}function subUpdateChart(e,t,n){if(!dynamicFunction(t,n,e)){return}if(typeof e.firstPass=="undefined"){e.firstPass=1;var r=resizeGraph(e,n);if(n.responsive){resizeCtx(e,r.newWidth,r.newHeight);e.prevWidth=r.newWidth;e.prevHeight=r.newHeight}else{e.prevWidth=0;e.prevHeight=0}e.runanimationcompletefunction=true;redrawGraph(e,t,n)}else if(e.firstPass==0){e.firstPass=1;var r=resizeGraph(e,n);if(n.responsive){resizeCtx(e,r.newWidth,r.newHeight);e.prevWidth=r.newWidth;e.prevHeight=r.newHeight}else{e.prevWidth=0;e.prevHeight=0}redrawGraph(e,t,n)}else if(e.firstPass==1||e.firstPass==2){e.firstPass=2}else if(e.firstPass==3||e.firstPass==4){e.firstPass=4}else if(e.firstPass==5){e.firstPass=1;redrawGraph(e,t,n)}else if(e.firstPass==6){var r=resizeGraph(e,n);if(r.newWidth!=e.prevWidth||r.newHeight!=e.prevHeight){e.firstPass=3;e.clearRect(0,0,e.canvas.width,e.canvas.height);if(n.responsive){resizeCtx(e,r.newWidth,r.newHeight);e.prevWidth=r.newWidth;e.prevHeight=r.newHeight}else{e.prevWidth=0;e.prevHeight=0}redrawGraph(e,t,n)}else e.firstPass=5}else if(e.firstPass==7){var r=resizeGraph(e,n);e.firstPass=3;e.clearRect(0,0,e.canvas.width,e.canvas.height);if(n.responsive){resizeCtx(e,r.newWidth,r.newHeight);e.prevWidth=r.newWidth;e.prevHeight=r.newHeight}else{e.prevWidth=0;e.prevHeight=0}redrawGraph(e,t,n)}}function redrawGraph(e,t,n){var r=new Chart(e);switch(e.tpchart){case"Bar":r.Bar(t,n);break;case"Pie":r.Pie(t,n);break;case"Doughnut":r.Doughnut(t,n);break;case"Radar":r.Radar(t,n);break;case"PolarArea":r.PolarArea(t,n);break;case"HorizontalBar":r.HorizontalBar(t,n);break;case"StackedBar":r.StackedBar(t,n);break;case"HorizontalStackedBar":r.HorizontalStackedBar(t,n);break;case"Line":r.Line(t,n);break}}function checkBrowser(){this.ver=navigator.appVersion;this.dom=document.getElementById?1:0;this.ie5=this.ver.indexOf("MSIE 5")>-1&&this.dom?1:0;this.ie4=document.all&&!this.dom?1:0;this.ns5=this.dom&&parseInt(this.ver)>=5?1:0;this.ns4=document.layers&&!this.dom?1:0;this.bw=this.ie5||this.ie4||this.ns4||this.ns5;return this}function cursorInit(){scrolled=bw.ns4||bw.ns5?"window.pageYOffset":"document.body.scrollTop";if(bw.ns4)document.captureEvents(Event.MOUSEMOVE)}function makeCursorObj(obj,nest){createCursorDiv();nest=!nest?"":"document."+nest+".";this.css=bw.dom?document.getElementById(obj).style:bw.ie4?document.all[obj].style:bw.ns4?eval(nest+"document.layers."+obj):0;this.moveIt=b_moveIt;cursorInit();return this}function b_moveIt(e,t){this.x=e;this.y=t;this.css.left=this.x+"px";this.css.top=this.y+"px"}function isIE(){var e=navigator.userAgent.toLowerCase();return e.indexOf("msie")!=-1?parseInt(e.split("msie")[1]):false}function mergeChartConfig(e,t){var n={};for(var r in e){n[r]=e[r]}for(var r in t){n[r]=t[r]}return n}function sleep(e){var t=new Date;t.setTime(t.getTime()+e);while((new Date).getTime()<t.getTime()){}}function saveCanvas(e,t,n){cvSave=e.getImageData(0,0,e.canvas.width,e.canvas.height);var r={savePng:false,annotateDisplay:false,animation:false,dynamicDisplay:false};var i=mergeChartConfig(n,r);i.clearRect=false;redrawGraph(e,t,i);if(n.savePngOutput=="NewWindow"){var s=e.canvas.toDataURL();e.putImageData(cvSave,0,0);window.open(s,"_blank")}if(n.savePngOutput=="CurrentWindow"){var s=e.canvas.toDataURL();e.putImageData(cvSave,0,0);window.location.href=s}if(n.savePngOutput=="Save"){var s=e.canvas.toDataURL();var o=document.createElement("a");o.href=s;o.download=n.savePngName+".png";document.body.appendChild(o);o.click();document.body.removeChild(o)}}function dynamicFunction(e,t,n){if(isIE()<9&&isIE()!=false)return true;if(t.dynamicDisplay){if(n.canvas.id==""){var r=new Date;var i=r.getTime();n.canvas.id="Canvas_"+i}if(typeof dynamicDisplay[n.canvas.id]=="undefined"){dynamicDisplayList[dynamicDisplayList["length"]]=n.canvas.id;dynamicDisplay[n.canvas.id]=[n,false,false,e,t,n.canvas];dynamicDisplay[n.canvas.id][1]=isScrolledIntoView(n.canvas);window.onscroll=scrollFunction}else if(dynamicDisplay[n.canvas.id][2]==false){dynamicDisplay[n.canvas.id][1]=isScrolledIntoView(n.canvas)}if(dynamicDisplay[n.canvas.id][1]==false&&dynamicDisplay[n.canvas.id][2]==false){return false}dynamicDisplay[n.canvas.id][2]=true}return true}function isScrolledIntoView(e){var t=0;var n=0;elem=e;while(elem){t+=elem.offsetLeft-elem.scrollLeft+elem.clientLeft;n+=elem.offsetTop-elem.scrollTop+elem.clientTop;elem=elem.offsetParent}if(t+e.width/2>=window.pageXOffset&&t+e.width/2<=window.pageXOffset+window.innerWidth&&n+e.height/2>=window.pageYOffset&&n+e.height/2<=window.pageYOffset+window.innerHeight)return true;else return false}function scrollFunction(){for(var e=0;e<dynamicDisplayList["length"];e++){if(isScrolledIntoView(dynamicDisplay[dynamicDisplayList[e]][5])&&dynamicDisplay[dynamicDisplayList[e]][2]==false){dynamicDisplay[dynamicDisplayList[e]][1]=true;redrawGraph(dynamicDisplay[dynamicDisplayList[e]][0],dynamicDisplay[dynamicDisplayList[e]][3],dynamicDisplay[dynamicDisplayList[e]][4])}}}function clearAnnotate(e){jsGraphAnnotate[e]=[]}function getMousePos(e,t){var n=e.getBoundingClientRect();return{x:t.clientX-n.left,y:t.clientY-n.top}}function doMouseAction(config,ctx,event,data,action,funct){var onData=false;if(action=="annotate"){var annotateDIV=document.getElementById("divCursor");var show=false;annotateDIV.className=config.annotateClassName?config.annotateClassName:"";annotateDIV.style.border=config.annotateClassName?"":config.annotateBorder;annotateDIV.style.padding=config.annotateClassName?"":config.annotatePadding;annotateDIV.style.borderRadius=config.annotateClassName?"":config.annotateBorderRadius;annotateDIV.style.backgroundColor=config.annotateClassName?"":config.annotateBackgroundColor;annotateDIV.style.color=config.annotateClassName?"":config.annotateFontColor;annotateDIV.style.fontFamily=config.annotateClassName?"":config.annotateFontFamily;annotateDIV.style.fontSize=config.annotateClassName?"":config.annotateFontSize+"pt";annotateDIV.style.fontStyle=config.annotateClassName?"":config.annotateFontStyle}if(action=="annotate"){show=false;annotateDIV.style.display=show?"":"none"}canvas_pos=getMousePos(ctx.canvas,event);for(var i=0;i<jsGraphAnnotate[ctx.ChartNewId]["length"];i++){if(jsGraphAnnotate[ctx.ChartNewId][i][0]=="ARC"){myStatData=jsGraphAnnotate[ctx.ChartNewId][i][3][jsGraphAnnotate[ctx.ChartNewId][i][1]];distance=Math.sqrt((canvas_pos.x-myStatData.midPosX)*(canvas_pos.x-myStatData.midPosX)+(canvas_pos.y-myStatData.midPosY)*(canvas_pos.y-myStatData.midPosY));if(distance>myStatData.int_radius&&distance<myStatData.radiusOffset){angle=(Math.acos((canvas_pos.x-myStatData.midPosX)/distance)%(2*Math.PI)+2*Math.PI)%(2*Math.PI);if(canvas_pos.y<myStatData.midPosY)angle=-angle;angle=((angle+2*Math.PI)%(2*Math.PI)+2*Math.PI)%(2*Math.PI);myStatData.startAngle=((myStatData.startAngle+2*Math.PI)%(2*Math.PI)+2*Math.PI)%(2*Math.PI);myStatData.endAngle=((myStatData.endAngle+2*Math.PI)%(2*Math.PI)+2*Math.PI)%(2*Math.PI);if(myStatData.endAngle<myStatData.startAngle)myStatData.endAngle+=2*Math.PI;if(angle>myStatData.startAngle&&angle<myStatData.endAngle||angle>myStatData.startAngle-2*Math.PI&&angle<myStatData.endAngle-2*Math.PI||angle>myStatData.startAngle+2*Math.PI&&angle<myStatData.endAngle+2*Math.PI){myStatData.graphPosX=canvas_pos.x;myStatData.graphPosY=canvas_pos.y;onData=true;if(action=="annotate"){dispString=tmplbis(setOptionValue("ANNOTATELABEL",ctx,data,jsGraphAnnotate[ctx.ChartNewId][i][3],undefined,config.annotateLabel,jsGraphAnnotate[ctx.ChartNewId][i][12],-1,{otherVal:true}),myStatData);annotateDIV.innerHTML=dispString;show=true}else{funct(event,ctx,config,data,myStatData)}if(action=="annotate"){x=bw.ns4||bw.ns5?event.pageX:event.x;y=bw.ns4||bw.ns5?event.pageY:event.y;if(bw.ie4||bw.ie5)y=y+eval(scrolled);oCursor.moveIt(x+fromLeft,y+fromTop)}}}}else if(jsGraphAnnotate[ctx.ChartNewId][i][0]=="RECT"){myStatData=jsGraphAnnotate[ctx.ChartNewId][i][3][jsGraphAnnotate[ctx.ChartNewId][i][1]][jsGraphAnnotate[ctx.ChartNewId][i][2]];if(canvas_pos.x>Math.min(myStatData.xPosLeft,myStatData.xPosRight)&&canvas_pos.x<Math.max(myStatData.xPosLeft,myStatData.xPosRight)&&canvas_pos.y<Math.max(myStatData.yPosBottom,myStatData.yPosTop)&&canvas_pos.y>Math.min(myStatData.yPosBottom,myStatData.yPosTop)){myStatData.graphPosX=canvas_pos.x;myStatData.graphPosY=canvas_pos.y;onData=true;if(action=="annotate"){dispString=tmplbis(setOptionValue("ANNOTATELABEL",ctx,data,jsGraphAnnotate[ctx.ChartNewId][i][3],undefined,config.annotateLabel,jsGraphAnnotate[ctx.ChartNewId][i][1],jsGraphAnnotate[ctx.ChartNewId][i][2],{otherVal:true}),myStatData);annotateDIV.innerHTML=dispString;show=true}else{funct(event,ctx,config,data,myStatData)}if(action=="annotate"){x=bw.ns4||bw.ns5?event.pageX:event.x;y=bw.ns4||bw.ns5?event.pageY:event.y;if(bw.ie4||bw.ie5)y=y+eval(scrolled);oCursor.moveIt(x+fromLeft,y+fromTop)}}}else if(jsGraphAnnotate[ctx.ChartNewId][i][0]=="POINT"){myStatData=jsGraphAnnotate[ctx.ChartNewId][i][3][jsGraphAnnotate[ctx.ChartNewId][i][1]][jsGraphAnnotate[ctx.ChartNewId][i][2]];var distance;if(config.detectAnnotateOnFullLine){if(canvas_pos.x<Math.min(myStatData.annotateStartPosX,myStatData.annotateEndPosX)-config.pointHitDetectionRadius||canvas_pos.x>Math.max(myStatData.annotateStartPosX,myStatData.annotateEndPosX)+config.pointHitDetectionRadius||canvas_pos.y<Math.min(myStatData.annotateStartPosY,myStatData.annotateEndPosY)-config.pointHitDetectionRadius||canvas_pos.y>Math.max(myStatData.annotateStartPosY,myStatData.annotateEndPosY)+config.pointHitDetectionRadius){distance=config.pointHitDetectionRadius+1}else{if(typeof myStatData.D1A=="undefined"){distance=Math.abs(canvas_pos.x-myStatData.posX)}else if(typeof myStatData.D2A=="undefined"){distance=Math.abs(canvas_pos.y-myStatData.posY)}else{var D2B=-myStatData.D2A*canvas_pos.x+canvas_pos.y;var g=-(myStatData.D1B-D2B)/(myStatData.D1A-myStatData.D2A);var h=myStatData.D2A*g+D2B;distance=Math.sqrt((canvas_pos.x-g)*(canvas_pos.x-g)+(canvas_pos.y-h)*(canvas_pos.y-h))}}}else{distance=Math.sqrt((canvas_pos.x-myStatData.posX)*(canvas_pos.x-myStatData.posX)+(canvas_pos.y-myStatData.posY)*(canvas_pos.y-myStatData.posY))}if(distance<config.pointHitDetectionRadius){myStatData.graphPosX=canvas_pos.x;myStatData.graphPosY=canvas_pos.y;onData=true;if(action=="annotate"){dispString=tmplbis(setOptionValue("ANNOTATELABEL",ctx,data,jsGraphAnnotate[ctx.ChartNewId][i][3],undefined,config.annotateLabel,jsGraphAnnotate[ctx.ChartNewId][i][1],jsGraphAnnotate[ctx.ChartNewId][i][2],{otherVal:true}),myStatData);annotateDIV.innerHTML=dispString;show=true}else{funct(event,ctx,config,data,myStatData)}if(action=="annotate"){x=bw.ns4||bw.ns5?event.pageX:event.x;y=bw.ns4||bw.ns5?event.pageY:event.y;if(bw.ie4||bw.ie5)y=y+eval(scrolled);oCursor.moveIt(x+fromLeft,y+fromTop)}}}if(action=="annotate"){annotateDIV.style.display=show?"":"none"}}if(onData==false&&action!="annotate"){funct(event,ctx,config,data,null)}}function animationCorrection(e,t,n,r,i,s){var o=e;var u=0;if(i!=-1){if(o<1&&r<n.animationStartWithDataset-1&&n.animationStartWithDataset-1!=-1){o=1}if(o<1&&i<n.animationStartWithData-1&&n.animationStartWithData-1!=-1){o=1}var a=1;var f=e;if(o<1&&n.animationByDataset){o=0;a=0;var l=n.animationStartWithDataset-1;if(n.animationStartWithDataset-1==-1)l=0;var c=n.animationSteps/(t.datasets.length-l);if(e>=(r-l+1)*c/n.animationSteps)o=1;else if(e>=(r-l)*c/n.animationSteps){var h=e-(r-l)*c/n.animationSteps;if(!n.animationLeftToRight){o=h*(t.datasets.length-l)}else{f=h*(t.datasets.length-l)}a=1}}if(a==1&&o<1&&n.animationLeftToRight){o=0;var p=n.animationStartWithData-1;if(n.animationStartWithData-1==-1)p=0;var d=n.animationSteps/(t.datasets[r].data.length-p-1+s);if(f>=(i-p)*d/n.animationSteps){o=1;if(f<=(i+1-p)*d/n.animationSteps){u=(t.datasets[r].data.length-p-1)*(f-(i-p)*d/n.animationSteps)}}}}else{if(o<1&&r<n.animationStartWithData-1){o=1}}return{mainVal:o,subVal:u,animVal:o+u}}function drawLegend(e,t,n,r,i){if(n.legendBorders==true){r.save();r.beginPath();r.lineWidth=n.legendBordersWidth;r.strokeStyle=n.legendBordersColors;r.moveTo(e.xLegendBorderPos,e.yLegendBorderPos);r.lineTo(e.xLegendBorderPos,e.yLegendBorderPos+e.legendBorderHeight);r.lineTo(e.xLegendBorderPos+e.legendBorderWidth,e.yLegendBorderPos+e.legendBorderHeight);r.lineTo(e.xLegendBorderPos+e.legendBorderWidth,e.yLegendBorderPos);r.lineTo(e.xLegendBorderPos,e.yLegendBorderPos);r.lineTo(e.xLegendBorderPos+e.legendBorderWidth,e.yLegendBorderPos);r.lineTo(e.xLegendBorderPos,e.yLegendBorderPos);r.lineTo(e.xLegendBorderPos,e.yLegendBorderPos+e.legendBorderHeight);r.stroke();r.closePath();r.fillStyle="rgba(0,0,0,0)";r.fillStyle=n.legendFillColor;r.fill();r.restore()}nbcols=e.nbLegendCols-1;ypos=e.yFirstLegendTextPos-(n.legendFontSize+n.legendSpaceBetweenTextVertical);xpos=0;if(e.drawLegendOnData)fromi=t.datasets.length;else fromi=t.length;for(var s=fromi-1;s>=0;s--){orderi=s;if(e.reverseLegend){if(e.drawLegendOnData)orderi=t.datasets.length-s-1;else orderi=t.length-s-1}if(e.drawLegendOnData)tpof=typeof t.datasets[orderi].title;else tpof=typeof t[orderi].title;if(tpof=="string"){if(e.drawLegendOnData)lgtxt=fmtChartJS(n,t.datasets[orderi].title,n.fmtLegend).trim();else lgtxt=fmtChartJS(n,t[orderi].title,n.fmtLegend).trim();if(lgtxt!=""){nbcols++;if(nbcols==e.nbLegendCols){nbcols=0;xpos=e.xFirstLegendTextPos;ypos+=n.legendFontSize+n.legendSpaceBetweenTextVertical}else{xpos+=e.widestLegend+n.legendSpaceBetweenTextHorizontal}r.save();r.beginPath();var o=e.legendBox;if(r.tpchart=="Bar")if(t.datasets[orderi].type=="Line"&&!n.datasetFill)o=false;if(o){r.lineWidth=n.datasetStrokeWidth;r.beginPath();if(e.drawLegendOnData){r.strokeStyle=setOptionValue("LEGENDSTROKECOLOR",r,t,undefined,t.datasets[orderi].strokeColor,n.defaultFillColor,orderi,-1,{animationValue:1,xPosLeft:xpos,yPosBottom:ypos,xPosRight:xpos+n.legendBlockSize,yPosTop:ypos-n.legendFontSize})}else{r.strokeStyle=setOptionValue("LEGENDSTROKECOLOR",r,t,undefined,t[orderi].strokeColor,n.defaultFillColor,orderi,-1,{animationValue:1,xPosLeft:xpos,yPosBottom:ypos,xPosRight:xpos+n.legendBlockSize,yPosTop:ypos-n.legendFontSize})}r.moveTo(xpos,ypos);r.lineTo(xpos+n.legendBlockSize,ypos);r.lineTo(xpos+n.legendBlockSize,ypos-n.legendFontSize);r.lineTo(xpos,ypos-n.legendFontSize);r.lineTo(xpos,ypos);r.closePath();r.stroke();if(e.drawLegendOnData){r.fillStyle=setOptionValue("LEGENDFILLCOLOR",r,t,undefined,t.datasets[orderi].fillColor,n.defaultFillColor,orderi,-1,{animationValue:1,xPosLeft:xpos,yPosBottom:ypos,xPosRight:xpos+n.legendBlockSize,yPosTop:ypos-n.legendFontSize})}else{r.fillStyle=setOptionValue("LEGENDFILLCOLOR",r,t,undefined,t[orderi].color,n.defaultFillColor,orderi,-1,{animationValue:1,xPosLeft:xpos,yPosBottom:ypos,xPosRight:xpos+n.legendBlockSize,yPosTop:ypos-n.legendFontSize})}r.fill()}else{r.lineWidth=n.legendColorIndicatorStrokeWidth?n.legendColorIndicatorStrokeWidth:n.datasetStrokeWidth;if(n.legendColorIndicatorStrokeWidth&&n.legendColorIndicatorStrokeWidth>n.legendFontSize){r.lineWidth=n.legendFontSize}if(e.drawLegendOnData){r.strokeStyle=setOptionValue("LEGENDSTROKECOLOR",r,t,undefined,t.datasets[orderi].strokeColor,n.defaultFillColor,orderi,-1,{animationValue:1,xPosLeft:xpos,yPosBottom:ypos,xPosRight:xpos+n.legendBlockSize,yPosTop:ypos-n.legendFontSize})}else{r.strokeStyle=setOptionValue("LEGENDSTROKECOLOR",r,t,undefined,t[orderi].strokeColor,n.defaultFillColor,orderi,-1,{animationValue:1,xPosLeft:xpos,yPosBottom:ypos,xPosRight:xpos+n.legendBlockSize,yPosTop:ypos-n.legendFontSize})}r.moveTo(xpos+2,ypos-n.legendFontSize/2);r.lineTo(xpos+2+n.legendBlockSize,ypos-n.legendFontSize/2);r.stroke();r.fill();if(n.pointDot){r.beginPath();r.fillStyle=setOptionValue("LEGENDMARKERFILLCOLOR",r,t,undefined,t.datasets[orderi].pointColor,n.defaultStrokeColor,orderi,-1,{nullvalue:true});r.strokeStyle=setOptionValue("LEGENDMARKERSTROKESTYLE",r,t,undefined,t.datasets[orderi].pointStrokeColor,n.defaultStrokeColor,orderi,-1,{nullvalue:true});r.lineWidth=setOptionValue("LEGENDMARKERLINEWIDTH",r,t,undefined,t.datasets[orderi].pointDotStrokeWidth,n.pointDotStrokeWidth,orderi,-1,{nullvalue:true});var u=setOptionValue("LEGENDMARKERSHAPE",r,t,undefined,t.datasets[orderi].markerShape,n.markerShape,orderi,-1,{nullvalue:true});var a=setOptionValue("LEGENDMARKERRADIUS",r,t,undefined,t.datasets[orderi].pointDotRadius,n.pointDotRadius,orderi,-1,{nullvalue:true});drawMarker(r,xpos+2+n.legendBlockSize/2,ypos-n.legendFontSize/2,u,a)}r.fill()}r.restore();r.save();r.beginPath();r.font=n.legendFontStyle+" "+n.legendFontSize+"px "+n.legendFontFamily;r.fillStyle=n.legendFontColor;r.textAlign="left";r.textBaseline="bottom";r.translate(xpos+n.legendBlockSize+n.legendSpaceBetweenBoxAndText,ypos);r.fillText(lgtxt,0,0);r.restore()}}}}function drawMarker(e,t,n,r,i){switch(r){case"square":e.rect(t-i,n-i,2*i,2*i);e.stroke();e.fill();break;case"triangle":pointA_x=0;pointA_y=2/3*i;e.moveTo(t,n-pointA_y);e.lineTo(t+pointA_y*Math.sin(4/3),n+pointA_y*Math.cos(4/3));e.lineTo(t-pointA_y*Math.sin(4/3),n+pointA_y*Math.cos(4/3));e.lineTo(t,n-pointA_y);e.stroke();e.fill();break;case"diamond":e.moveTo(t,n+i);e.lineTo(t+i,n);e.lineTo(t,n-i);e.lineTo(t-i,n);e.lineTo(t,n+i);e.stroke();e.fill();break;case"plus":e.moveTo(t,n-i);e.lineTo(t,n+i);e.moveTo(t-i,n);e.lineTo(t+i,n);e.stroke();break;case"cross":e.moveTo(t-i,n-i);e.lineTo(t+i,n+i);e.moveTo(t-i,n+i);e.lineTo(t+i,n-i);e.stroke();break;case"circle":default:e.arc(t,n,i,0,2*Math.PI*1,true);e.stroke();e.fill();break}}function initPassVariableData_part1(e,t,n){switch(n.tpchart){case"Pie":case"Doughnut":case"PolarArea":var r=[];var i,s,o,u,a,f;a=((-t.startAngle*(Math.PI/180)+2*Math.PI)%(2*Math.PI)+2*Math.PI)%(2*Math.PI);f=((t.startAngle*(Math.PI/180)+2*Math.PI)%(2*Math.PI)+2*Math.PI)%(2*Math.PI);startAngle=a;s=0;notemptyval=0;var l=-1;var c=-1;var h=-1;var p=-Number.MAX_VALUE;var d=Number.MAX_VALUE;for(var v=0;v<e.length;v++){if(n.tpchart!="PolarArea"&&1*e[v].value<0)continue;if(!(typeof e[v].value=="undefined")){if(l==-1)l=v;p=Math.max(p,1*e[v].value);d=Math.min(d,1*e[v].value);notemptyval++;s+=1*e[v].value;c=v}}o=0;var m=-1;for(v=0;v<e.length;v++){if(typeof e[v].title=="string")i=e[v].title.trim();else i="";if(!(typeof e[v].value=="undefined")&&(n.tpchart=="PolarArea"||1*e[v].value>=0)){if(n.tpchart=="PolarArea"){if(notemptyval>0)u=Math.PI*2/notemptyval;else u=0}else u=1*e[v].value/s*Math.PI*2;if(u>=Math.PI*2)u=Math.PI*2-.001;o+=1*e[v].value;r[v]={config:t,v1:fmtChartJS(t,i,t.fmtV1),v2:fmtChartJS(t,1*e[v].value,t.fmtV2),v3:fmtChartJS(t,o,t.fmtV3),v4:fmtChartJS(t,s,t.fmtV4),v5:fmtChartJS(t,u,t.fmtV5),v6:roundToWithThousands(t,fmtChartJS(t,100*e[v].value/s,t.fmtV6),t.roundPct),v7:0,v8:0,v9:0,v10:0,v11:fmtChartJS(t,a-u,t.fmtV11),v12:fmtChartJS(t,a,t.fmtV12),v13:fmtChartJS(t,v,t.fmtV13),lgtxt:i,datavalue:1*e[v].value,cumvalue:o,totvalue:s,segmentAngle:u,firstAngle:startAngle,pctvalue:100*e[v].value/s,startAngle:a,realStartAngle:f,endAngle:a+u,maxvalue:p,minvalue:d,i:v,firstNotMissing:l,lastNotMissing:c,prevNotMissing:h,prevMissing:m,nextNotMissing:-1,radiusOffset:0,midPosX:0,midPosY:0,int_radius:0,ext_radius:0,data:e};a+=u;f-=u;if(h!=-1)r[h].nextNotMissing=v;h=v}else{r[v]={v1:i,maxvalue:p,minvalue:d,i:v,firstNotMissing:l,lastNotMissing:c,prevNotMissing:h};m=v}}break;case"Bar":case"Line":case"HorizontalBar":case"StackedBar":case"HorizontalStackedBar":case"Radar":var g;var r=[];var p=[];p[0]=[];p[1]=[];var d=[];d[0]=[];d[1]=[];var o=[];o[0]=[];o[1]=[];var s=[];s[0]=[];s[1]=[];var y=[];y[0]=[];y[1]=[];var b=[];b[0]=[];b[1]=[];var i,w,E;var S=[];var x=[];var T=[];var N=[];var C=[];S[0]=[];S[1]=[];for(var v=0;v<e.datasets.length;v++){if(typeof e.datasets[v].xPos!="undefined"&&tpdraw(n,e.datasets[v])=="Line"){for(var L=e.datasets[v].data.length;L<e.datasets[v].xPos.length;L++)e.datasets[v].data.push(undefined)}else{for(var L=e.datasets[v].data.length;L<e.labels.length;L++)e.datasets[v].data.push(undefined)}if(e.datasets[v].axis==2)g=0;else g=1;r[v]=[];y[0][v]=-Number.MAX_VALUE;y[1][v]=-Number.MAX_VALUE;b[0][v]=Number.MAX_VALUE;b[1][v]=Number.MAX_VALUE;x[v]=-1;T[v]=-1;for(var L=0;L<e.datasets[v].data.length;L++){if(typeof N[L]=="undefined"){N[L]=-1;C[L]=-1;s[0][L]=0;p[0][L]=-Number.MAX_VALUE;d[0][L]=Number.MAX_VALUE;s[1][L]=0;p[1][L]=-Number.MAX_VALUE;d[1][L]=Number.MAX_VALUE}if(!(typeof e.datasets[v].data[L]=="undefined")){if(x[v]==-1)x[v]=L;T[v]=L;if(N[L]==-1)N[L]=v;C[L]=v;s[g][L]+=1*e.datasets[v].data[L];p[g][L]=Math.max(p[g][L],1*e.datasets[v].data[L]);d[g][L]=Math.min(d[g][L],1*e.datasets[v].data[L]);y[g][v]=Math.max(y[g][v],1*e.datasets[v].data[L]);b[g][v]=Math.min(b[g][v],1*e.datasets[v].data[L])}}}for(var v=0;v<e.datasets.length;v++){if(e.datasets[v].axis==2)g=0;else g=1;if(typeof e.datasets[v].title=="string")i=e.datasets[v].title.trim();else i="";var A=-1;var O=-1;for(var L=0;L<e.datasets[v].data.length;L++){if(typeof o[0][L]=="undefined"){o[0][L]=0;S[0][L]=-1;o[1][L]=0;S[1][L]=-1}w="";if(typeof e.datasets[v].xPos!="undefined"){if(!(typeof e.datasets[v].xPos[L]=="undefined"))w=e.datasets[v].xPos[L]}if(w==""&&!(typeof e.labels[L]=="undefined"))w=e.labels[L];if(typeof w=="string")w=w.trim();if(!(typeof e.datasets[v].data[L]=="undefined")){o[g][L]+=1*e.datasets[v].data[L];switch(tpdraw(n,e.datasets[v])){case"Bar":case"StackedBar":case"HorizontalBar":case"HorizontalStackedBar":r[v][L]={config:t,v1:fmtChartJS(t,i,t.fmtV1),v2:fmtChartJS(t,w,t.fmtV2),v3:fmtChartJS(t,1*e.datasets[v].data[L],t.fmtV3),v4:fmtChartJS(t,o[g][L],t.fmtV4),v5:fmtChartJS(t,s[g][L],t.fmtV5),v6:roundToWithThousands(t,fmtChartJS(t,100*e.datasets[v].data[L]/s[g][L],t.fmtV6),t.roundPct),v11:fmtChartJS(t,v,t.fmtV11),v12:fmtChartJS(t,L,t.fmtV12),lgtxt:i,lgtxt2:w,datavalue:1*e.datasets[v].data[L],cumvalue:o[g][L],totvalue:s[g][L],pctvalue:100*e.datasets[v].data[L]/s[g][L],maxvalue:p[g][L],minvalue:d[g][L],lmaxvalue:y[g][v],lminvalue:b[g][v],firstNotMissing:N[L],lastNotMissing:C[L],prevNotMissing:A,prevMissing:O,nextNotMissing:-1,j:L,i:v,data:e};break;case"Line":case"Radar":r[v][L]={config:t,v1:fmtChartJS(t,i,t.fmtV1),v2:fmtChartJS(t,w,t.fmtV2),v3:fmtChartJS(t,1*e.datasets[v].data[L],t.fmtV3),v5:fmtChartJS(t,1*e.datasets[v].data[L],t.fmtV5),v6:fmtChartJS(t,p[g][L],t.fmtV7),v7:fmtChartJS(t,s[g][L],t.fmtV6),v8:roundToWithThousands(t,fmtChartJS(t,100*e.datasets[v].data[L]/s[g][L],t.fmtV8),t.roundPct),v11:fmtChartJS(t,v,t.fmtV11),v12:fmtChartJS(t,L,t.fmtV12),lgtxt:i,lgtxt2:w,datavalue:1*e.datasets[v].data[L],diffnext:1*e.datasets[v].data[L],pctvalue:100*e.datasets[v].data[L]/s[g][L],totvalue:s[g][L],cumvalue:o[g][L],maxvalue:p[g][L],minvalue:d[g][L],lmaxvalue:y[g][v],lminvalue:b[g][v],lminvalue:b[g][v],firstNotMissing:x[v],lastNotMissing:T[v],prevNotMissing:A,prevMissing:O,nextNotMissing:-1,j:L,i:v,data:e};if(S[g][L]>=0){r[v][L].v4=fmtChartJS(t,S[g][L]!=-1?1*e.datasets[v].data[L]-r[S[g][L]][L].datavalue:1*e.datasets[v].data[L],t.fmtV4);r[v][L].diffprev=S[g][L]!=-1?1*e.datasets[v].data[L]-r[S[g][L]][L].datavalue:1*e.datasets[v].data[L];r[S[g][L]][L].diffnext=e.datasets[S[g][L]].data[L]-e.datasets[v].data[L];r[S[g][L]][L].v5=r[S[g][L]][L].diffnext}else{r[v][L].v4=1*e.datasets[v].data[L]}S[g][L]=v;break;default:break}if(!(typeof e.datasets[v].data[L]=="undefined")){if(A!=-1){for(k=A;k<L;k++)r[v][k].nextNotMissing=L}A=L}}else{O=L;switch(tpdraw(n,e.datasets[v])){case"Bar":case"StackedBar":case"HorizontalBar":case"HorizontalStackedBar":r[v][L]={v1:i,lmaxvalue:y[g][v],lminvalue:b[g][v],firstNotMissing:N[L],lastNotMissing:C[L],prevNotMissing:A,prevMissing:O};break;case"Line":case"Radar":r[v][L]={v1:i,lmaxvalue:y[g][v],lminvalue:b[g][v],firstNotMissing:x[v],lastNotMissing:T[v],prevNotMissing:A,prevMissing:O};break}}}}break;default:break}return r}function initPassVariableData_part2(e,t,n,r,i){function h(e,t,r,i,s,o){if(typeof r.datasets[e].xPos=="object"){if(!(typeof r.datasets[e].xPos[Math.floor(t+n.zeroValue)]=="undefined")){var u=s*o;var a=typeof r.xBegin!="undefined"?r.xBegin:1*r.labels[0];var f=typeof r.xEnd!="undefined"?r.xEnd:1*r.labels[r.labels.length-1];if(f<=a)f=a+100;if(1*r.datasets[e].xPos[Math.floor(t+n.zeroValue)]>=a&&r.datasets[e].xPos[Math.floor(t+n.zeroValue)]<=f){var l=i+u*((1*r.datasets[e].xPos[Math.floor(t+n.zeroValue)]-a)/(f-a));var c=l;if(Math.abs(t-Math.floor(t+n.zeroValue))>n.zeroValue){var p=t+Math.floor(t+n.zeroValue);var c=h(e,Math.ceil(t-n.zeroValue),r)}return l+(t-Math.floor(t+n.zeroValue))*(c-l)}}}return i+s*t}function p(e){return Math.floor(Math.log(e)/Math.LN10)}function d(e,t,n,r){if(!e){var i=n.steps*n.stepValue;var s=t-n.graphMin;var o=m(s/i,1,0);return r*n.steps*o}else{return m(g(t)*r-p(n.graphMin)*r,undefined,0)}}function v(e,t,n){var r=t.steps*t.stepValue;var i=e-t.graphMin;var s=m(i/r,1,0);return n*t.steps*s}function m(e,t,n){if(isNumber(t)){if(e>t){return t}}if(isNumber(n)){if(e<n){return n}}return e}function g(e){return Math.log(e)/Math.LN10}var s=0;switch(r.tpchart){case"Pie":case"Doughnut":case"PolarArea":for(f=0;f<t.length;f++){e[f].v7=fmtChartJS(n,i.midPosX,n.fmtV7);e[f].v8=fmtChartJS(n,i.midPosY,n.fmtV8),e[f].v9=fmtChartJS(n,i.int_radius,n.fmtV9);e[f].v10=fmtChartJS(n,i.ext_radius,n.fmtV10);if(r.tpchart=="PolarArea"){e[f].radiusOffset=d(n.logarithmic,1*t[f].value,i.calculatedScale,i.scaleHop);e[f].v10=fmtChartJS(n,e[f].radiusOffset,n.fmtV10)}else{e[f].v10=fmtChartJS(n,i.ext_radius,n.fmtV10);e[f].radiusOffset=i.ext_radius}e[f].midPosX=i.midPosX;e[f].midPosY=i.midPosY;e[f].int_radius=i.int_radius;e[f].ext_radius=i.ext_radius}break;case"Radar":case"Line":case"Bar":case"StackedBar":case"HorizontalBar":case"HorizontalStackedBar":var o;var u=new Array(t.datasets.length);var a=new Array(t.datasets.length);for(var f=0;f<t.datasets.length;f++){switch(tpdraw(r,t.datasets[f])){case"Line":for(var l=0;l<t.datasets[f].data.length;l++){e[f][l].xAxisPosY=i.xAxisPosY;e[f][l].yAxisPosX=i.yAxisPosX;e[f][l].valueHop=i.valueHop;e[f][l].nbValueHop=i.nbValueHop;if(t.datasets[f].axis==2){e[f][l].scaleHop=i.scaleHop2;e[f][l].zeroY=i.zeroY2;e[f][l].calculatedScale=i.calculatedScale2;e[f][l].logarithmic=i.logarithmic2}else{e[f][l].scaleHop=i.scaleHop;e[f][l].zeroY=i.zeroY;e[f][l].calculatedScale=i.calculatedScale;e[f][l].logarithmic=i.logarithmic}e[f][l].xPos=h(f,l,t,i.yAxisPosX,i.valueHop,i.nbValueHop);e[f][l].yAxisPos=i.xAxisPosY-e[f][l].zeroY;if(r.tpchart=="Bar"){e[f][l].xPos+=i.valueHop/2;e[f][l].yAxisPosX+=i.valueHop/2}if(l==0){e[f][l].lmaxvalue_offset=d(e[f][l].logarithmic,e[f][l].lmaxvalue,e[f][l].calculatedScale,e[f][l].scaleHop)-e[f][l].zeroY;e[f][l].lminvalue_offset=d(e[f][l].logarithmic,e[f][l].lminvalue,e[f][l].calculatedScale,e[f][l].scaleHop)-e[f][l].zeroY}else{e[f][l].lmaxvalue_offset=e[f][0].lmaxvalue_offset;e[f][l].lminvalue_offset=e[f][0].lminvalue_offset}if(!(typeof t.datasets[f].data[l]=="undefined")){e[f][l].yPosOffset=d(e[f][l].logarithmic,t.datasets[f].data[l],e[f][l].calculatedScale,e[f][l].scaleHop)-e[f][l].zeroY;e[f][l].posY=e[f][l].yAxisPos-e[f][l].yPosOffset}e[f][l].posX=e[f][l].xPos;e[f][l].v9=e[f][l].xPos;e[f][l].v10=e[f][l].posY;e[f][l].annotateStartPosX=e[f][l].xPos;e[f][l].annotateEndPosX=e[f][l].xPos;e[f][l].annotateStartPosY=i.xAxisPosY;e[f][l].annotateEndPosY=i.xAxisPosY-i.msr.availableHeight;e[f][l].D1A=undefined;e[f][l].D1B=undefined}break;case"Radar":var c=2*Math.PI/t.datasets[0].data.length;for(var l=0;l<t.datasets[f].data.length;l++){e[f][l].midPosX=i.midPosX;e[f][l].midPosY=i.midPosY;e[f][l].int_radius=0;e[f][l].ext_radius=i.maxSize;e[f][l].radiusOffset=i.maxSize;e[f][l].calculated_offset=d(n.logarithmic,t.datasets[f].data[l],i.calculatedScale,i.scaleHop);e[f][l].offsetX=Math.cos(n.startAngle*Math.PI/180-l*c)*e[f][l].calculated_offset;e[f][l].offsetY=Math.sin(n.startAngle*Math.PI/180-l*c)*e[f][l].calculated_offset;e[f][l].v9=e[f][l].midPosX+e[f][l].offsetX;e[f][l].v10=e[f][l].midPosY-e[f][l].offsetY;e[f][l].posX=e[f][l].midPosX+e[f][l].offsetX;e[f][l].posY=e[f][l].midPosY-e[f][l].offsetY;if(l==0)e[f][l].calculated_offset_max=d(n.logarithmic,e[f][l].lmaxvalue,i.calculatedScale,i.scaleHop);else e[f][l].calculated_offset_max=e[0][l].calculated_offset_max;e[f][l].annotateStartPosX=i.midPosX;e[f][l].annotateEndPosX=i.midPosX+Math.cos(n.startAngle*Math.PI/180-l*c)*i.maxSize;e[f][l].annotateStartPosY=i.midPosY;e[f][l].annotateEndPosY=i.midPosY-Math.sin(n.startAngle*Math.PI/180-l*c)*i.maxSize;if(Math.abs(e[f][l].annotateStartPosX-e[f][l].annotateEndPosX)<n.zeroValue){e[f][l].D1A=undefined;e[f][l].D1B=undefined;e[f][l].D2A=0}else{e[f][l].D1A=(e[f][l].annotateStartPosY-e[f][l].annotateEndPosY)/(e[f][l].annotateStartPosX-e[f][l].annotateEndPosX);e[f][l].D1B=-e[f][l].D1A*e[f][l].annotateStartPosX+e[f][l].annotateStartPosY;if(Math.abs(e[f][l].D1A)>=n.zeroValue)e[f][l].D2A=-(1/e[f][l].D1A);else e[f][l].D2A=undefined}}break;case"Bar":for(var l=0;l<t.datasets[f].data.length;l++){e[f][l].xPosLeft=i.yAxisPosX+n.barValueSpacing+i.valueHop*l+i.barWidth*s+n.barDatasetSpacing*s+n.barStrokeWidth*s;e[f][l].xPosRight=e[f][l].xPosLeft+i.barWidth;e[f][l].yPosBottom=i.xAxisPosY-i.zeroY;e[f][l].barHeight=d(n.logarithmic,1*t.datasets[f].data[l],i.calculatedScale,i.scaleHop)-i.zeroY;if(t.datasets[f].axis==2){e[f][l].yPosBottom=i.xAxisPosY-i.zeroY2;e[f][l].barHeight=d(n.logarithmic2,1*t.datasets[f].data[l],i.calculatedScale2,i.scaleHop2)-i.zeroY2}else{e[f][l].yPosBottom=i.xAxisPosY-i.zeroY;e[f][l].barHeight=d(n.logarithmic,1*t.datasets[f].data[l],i.calculatedScale,i.scaleHop)-i.zeroY}e[f][l].yPosTop=e[f][l].yPosBottom-e[f][l].barHeight+n.barStrokeWidth/2;e[f][l].v7=e[f][l].xPosLeft;e[f][l].v8=e[f][l].yPosBottom;e[f][l].v9=e[f][l].xPosRight;e[f][l].v10=e[f][l].yPosTop}s++;break;case"StackedBar":for(var l=0;l<t.datasets[f].data.length;l++){if(typeof u[l]=="undefined"){u[l]=0;a[l]=0;zeroY=d(n.logarithmic,0,i.calculatedScale,i.scaleHop)}if(typeof t.datasets[f].data[l]=="undefined")continue;e[f][l].xPosLeft=i.yAxisPosX+n.barValueSpacing+i.valueHop*l;if(1*t.datasets[f].data[l]<0){e[f][l].botval=a[l];e[f][l].topval=a[l]+1*t.datasets[f].data[l];a[l]=a[l]+1*t.datasets[f].data[l]}else{e[f][l].botval=u[l];e[f][l].topval=u[l]+1*t.datasets[f].data[l];u[l]=u[l]+1*t.datasets[f].data[l]}e[f][l].xPosRight=e[f][l].xPosLeft+i.barWidth;e[f][l].botOffset=d(n.logarithmic,e[f][l].botval,i.calculatedScale,i.scaleHop);e[f][l].topOffset=d(n.logarithmic,e[f][l].topval,i.calculatedScale,i.scaleHop);e[f][l].yPosBottom=i.xAxisPosY-e[f][l].botOffset;e[f][l].yPosTop=i.xAxisPosY-e[f][l].topOffset;if(n.spaceBetweenBar>0){if(1*t.datasets[f].data[l]<0){e[f][l].yPosBottom+=n.spaceBetweenBar;if(a[l]==1*t.datasets[f].data[l])e[f][l].yPosBottom-=n.spaceBetweenBar/2;if(e[f][l].yPosTop<e[f][l].yPosBottom)e[f][l].yPosBottom=e[f][l].yPosTop}else if(1*t.datasets[f].data[l]>0){e[f][l].yPosBottom-=n.spaceBetweenBar;if(u[l]==1*t.datasets[f].data[l])e[f][l].yPosBottom+=n.spaceBetweenBar/2;if(e[f][l].yPosTop>e[f][l].yPosBottom)e[f][l].yPosBottom=e[f][l].yPosTop}}e[f][l].v7=e[f][l].xPosLeft;e[f][l].v8=e[f][l].yPosBottom;e[f][l].v9=e[f][l].xPosRight;e[f][l].v10=e[f][l].yPosTop}break;case"HorizontalBar":for(var l=0;l<t.datasets[f].data.length;l++){e[f][l].xPosLeft=i.yAxisPosX+i.zeroY;e[f][l].yPosTop=i.xAxisPosY+n.barValueSpacing-i.scaleHop*(l+1)+i.barWidth*f+n.barDatasetSpacing*f+n.barStrokeWidth*f;e[f][l].yPosBottom=e[f][l].yPosTop+i.barWidth;e[f][l].barWidth=d(n.logarithmic,1*t.datasets[f].data[l],i.calculatedScale,i.valueHop)-i.zeroY;e[f][l].xPosRight=e[f][l].xPosLeft+e[f][l].barWidth;e[f][l].v7=e[f][l].xPosLeft;e[f][l].v8=e[f][l].yPosBottom;e[f][l].v9=e[f][l].xPosRight;e[f][l].v10=e[f][l].yPosTop}break;case"HorizontalStackedBar":for(var l=0;l<t.datasets[f].data.length;l++){if(f==0){u[l]=0;a[l]=0}if(typeof t.datasets[f].data[l]=="undefined"||1*t.datasets[f].data[l]==0)continue;e[f][l].xPosLeft=i.yAxisPosX+n.barValueSpacing+i.valueHop*l;if(1*t.datasets[f].data[l]<0){e[f][l].leftval=a[l];e[f][l].rightval=a[l]+1*t.datasets[f].data[l];a[l]=a[l]+1*t.datasets[f].data[l]}else{e[f][l].leftval=u[l];e[f][l].rightval=u[l]+1*t.datasets[f].data[l];u[l]=u[l]+1*t.datasets[f].data[l]}e[f][l].rightOffset=v(e[f][l].rightval,i.calculatedScale,i.valueHop);e[f][l].leftOffset=v(e[f][l].leftval,i.calculatedScale,i.valueHop);e[f][l].xPosRight=i.yAxisPosX+e[f][l].rightOffset;e[f][l].xPosLeft=i.yAxisPosX+e[f][l].leftOffset;e[f][l].yPosTop=i.xAxisPosY+n.barValueSpacing-i.scaleHop*(l+1);e[f][l].yPosBottom=e[f][l].yPosTop+i.barWidth;if(n.spaceBetweenBar>0){if(1*t.datasets[f].data[l]<0){e[f][l].xPosLeft-=n.spaceBetweenBar;if(a[l]==1*t.datasets[f].data[l])e[f][l].xPosLeft+=n.spaceBetweenBar/2;if(e[f][l].xPosLeft<e[f][l].xPosRight)e[f][l].xPosLeft=e[f][l].xPosRight}else if(1*t.datasets[f].data[l]>0){e[f][l].xPosLeft+=n.spaceBetweenBar;if(u[l]==1*t.datasets[f].data[l])e[f][l].xPosLeft-=n.spaceBetweenBar/2;if(e[f][l].xPosLeft>e[f][l].xPosRight)e[f][l].xPosLeft=e[f][l].xPosRight}}e[f][l].v7=e[f][l].xPosLeft;e[f][l].v8=e[f][l].yPosBottom;e[f][l].v9=e[f][l].xPosRight;e[f][l].v10=e[f][l].yPosTop}break;default:break}}}}function isBooleanOptionTrue(e,t){if(typeof optionvar=="undefined"){if(typeof t=="function")return true;else if(typeof t=="object"){for(var n=0;n<t.length;n++)if(t[n])return true;return false}else return t}if(typeof optionvar=="function")return true;else if(typeof optionvar=="object"){for(var n=0;n<optionvar.length;n++)if(optionvar[n])return true;return false}else return optionvar}function setOptionValue(e,t,n,r,i,s,o,u,a){if(typeof i=="undefined"){if(typeof s=="function")return s(e,t,n,r,o,u,a);else if(typeof s=="object")return s[Math.min(s.length-1,Math.max(0,o))];else return s}if(typeof i=="function")return i(e,t,n,r,o,u,a);else if(typeof i=="object")return i[Math.min(i.length-1,Math.max(0,o))];else return i}function tpdraw(e,t){switch(e.tpchart){case"Bar":if(t.type=="Line"){tp="Line"}else{tp=e.tpchart}break;default:tp=e.tpchart;break}return tp}if(typeof String.prototype.trim!=="function"){String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}}if(!Array.prototype.indexOf){Array.prototype.indexOf=function(e){"use strict";if(this==null){throw new TypeError}var t=Object(this);var n=t.length>>>0;if(n===0){return-1}var r=0;if(arguments.length>0){r=Number(arguments[1]);if(r!=r){r=0}else if(r!=0&&r!=Infinity&&r!=-Infinity){r=(r>0||-1)*Math.floor(Math.abs(r))}}if(r>=n){return-1}var i=r>=0?r:Math.max(n-Math.abs(r),0);for(;i<n;i++){if(i in t&&t[i]===e){return i}}return-1}}var charJSPersonalDefaultOptions={};var charJSPersonalDefaultOptionsLine={};var charJSPersonalDefaultOptionsRadar={};var charJSPersonalDefaultOptionsPolarArea={};var charJSPersonalDefaultOptionsPie={};var charJSPersonalDefaultOptionsDoughnut={};var charJSPersonalDefaultOptionsBar={};var charJSPersonalDefaultOptionsStackedBar={};var charJSPersonalDefaultOptionsHorizontalBar={};var charJSPersonalDefaultOptionsHorizontalStackedBar={};var cachebis={};if(typeof CanvasRenderingContext2D!=="undefined"){CanvasRenderingContext2D.prototype.fillTextMultiLine=function(e,t,n,r,i,s){var o=(""+e).split("\n");if(r=="middle"){if(s)n-=(o.length-1)/2*i}else if(r=="bottom"){if(s)n-=(o.length-1)*i}for(var u=0;u<o.length;u++){this.fillText(o[u],t,n);n+=i}};CanvasRenderingContext2D.prototype.measureTextMultiLine=function(e,t){var n=0;var r;var i=(""+e).split("\n");var s=i.length*t;for(var o=0;o<i.length;o++){r=this.measureText(i[o]).width;if(r>n)n=r}return{textWidth:n,textHeight:s}}}cursorDivCreated=false;initChartJsResize=false;var jsGraphResize=new Array;bw=new checkBrowser;fromLeft=10;fromTop=10;if(typeof String.prototype.trim!=="function"){String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}}var dynamicDisplay=new Array;var dynamicDisplayList=new Array;var jsGraphAnnotate=new Array;window.Chart=function(context){function init_and_start(e,t,n){if(typeof e.ChartNewId===typeof undefined){e.runanimationcompletefunction=true;var r=new Date;var i=r.getTime();e.ChartNewId=e.tpchart+"_"+i;e._eventListeners={}}if(!dynamicFunction(t,n,e)){if(n.responsive&&typeof e.firstPass=="undefined"){if(!n.multiGraph){addResponsiveChart(e.ChartNewId,e,t,n)}}return false}if(n.responsive&&typeof e.firstPass=="undefined"){if(!n.multiGraph){addResponsiveChart(e.ChartNewId,e,t,n);subUpdateChart(e,t,n);return false}else{e.firstPass=1}}if(typeof jsGraphAnnotate[e.ChartNewId]=="undefined")jsGraphAnnotate[e.ChartNewId]=new Array;else if(!n.multiGraph)clearAnnotate(e.ChartNewId);defMouse(e,t,n);setRect(e,n);return true}function reverseData(e){e.labels=e.labels.reverse();for(var t=0;t<e.datasets.length;t++){for(var n in e.datasets[t]){if(Array.isArray(e.datasets[t][n])){e.datasets[t][n]=e.datasets[t][n].reverse()}}}return e}function calculateOffset(e,t,n,r){if(!e){var i=n.steps*n.stepValue;var s=t-n.graphMin;var o=CapValue(s/i,1,0);return r*n.steps*o}else{return CapValue(log10(t)*r-calculateOrderOfMagnitude(n.graphMin)*r,undefined,0)}}function animationLoop(e,t,n,r,i,s,o,u,a,f,l,c,h){function E(){var d=e.animation?CapValue(g(y),null,0):1;if(1*p>=1*CapValue(e.animationSteps,Number.MAX_VALUE,1)||e.animation==false||r.firstPass==3||r.firstPass==4||r.firstPass==8||r.firstPass==9)d=1;else if(d>=1)d=.9999;if(e.animation&&!(isIE()<9&&isIE()!=false)&&e.clearRect)r.clearRect(i,s,o,u);dispCrossImage(r,e,a,f,l,c,false,h,d,p);dispCrossText(r,e,a,f,l,c,false,h,d,p);if(e.scaleOverlay){n(d);t()}else{t();n(d)}dispCrossImage(r,e,a,f,l,c,true,h,d,p);dispCrossText(r,e,a,f,l,c,true,h,d,p)}function S(){p+=v;y+=v*m;if(p==e.animationSteps||e.animation==false||r.firstPass==3||r.firstPass==4||r.firstPass==8||r.firstPass==9)y=1;else if(y>=1)y=.999;E();if(v==-1&&p<=b){if(typeof e.onAnimationComplete=="function"&&r.runanimationcompletefunction==true)e.onAnimationComplete(r,e,h,0,d+1);v=1;requestAnimFrame(S)}else if(y<e.animationStopValue){requestAnimFrame(S)}else{if((d<e.animationCount||e.animationCount==0)&&(r.firstPass==1||r.firstPass!=2)){d++;if(e.animationBackward&&v==1){y-=m;v=-1}else{v=1;p=b-1;y=w-m}window.setTimeout(S,e.animationPauseTime*1e3)}else{if(!testRedraw(r,h,e)){if(typeof e.onAnimationComplete=="function"&&r.runanimationcompletefunction==true){e.onAnimationComplete(r,e,h,1,d+1);r.runanimationcompletefunction=false}}}}}var p=0;var d=1;var v=1;if(e.animationStartValue<0||e.animationStartValue>1)e.animation.StartValue=0;if(e.animationStopValue<0||e.animationStopValue>1)e.animation.StopValue=1;if(e.animationStopValue<e.animationStartValue)e.animationStopValue=e.animationStartValue;if(isIE()<9&&isIE()!=false)e.animation=false;var m=e.animation?1/CapValue(e.animationSteps,Number.MAX_VALUE,1):1,g=animationOptions[e.animationEasing],y=e.animation?0:1;if(e.animation&&e.animationStartValue>0&&e.animationStartValue<=1){while(y<e.animationStartValue){p++;y+=m}}var b=p;var w=y;if(typeof t!=="function")t=function(){};if(e.clearRect)requestAnimFrame(S);else S();}function calculateScale(e,t,n,r,i,s,o){var u,a,f,l,c,h,p,d;var v,m;if(e==2){v=t.logarithmic2;m=t.yAxisMinimumInterval2}else{v=t.logarithmic;m=t.yAxisMinimumInterval}if(!v){h=i-s;p=calculateOrderOfMagnitude(h);if(Math.abs(s)>t.zeroValue)u=Math.floor(s/(1*Math.pow(10,p)))*Math.pow(10,p);else u=0;if(Math.abs(i)>t.zeroValue)a=Math.ceil(i/(1*Math.pow(10,p)))*Math.pow(10,p);else a=0;if(typeof m=="number"){if(a>=0){u=u-u%m;while(u>s)u=u-m;if(a%m>t.zeroValue&&a%m<m-t.zeroValue){a=roundScale(t,(1+Math.floor(a/m))*m)}while(a<i)a=a+m}}}else{if(s==i)i=i+1;if(s==0)s=.01;var g=calculateOrderOfMagnitude(s);var y=calculateOrderOfMagnitude(i)+1;u=Math.pow(10,g);a=Math.pow(10,y);p=y-g}f=a-u;l=Math.pow(10,p);c=Math.round(f/l);if(!v){var b=false;while(!b&&(c<r||c>n)){if(c<r){if(typeof m=="number"){if(l/2<m)b=true}if(!b){l/=2;c=Math.round(f/l)}}else{l*=2;c=Math.round(f/l)}}if(typeof m=="number"){if(l<m){l=m;c=Math.round(f/l)}if(l%m>t.zeroValue&&l%m<m-t.zeroValue){if(2*l%m<t.zeroValue||2*l%m>m-t.zeroValue){l=2*l;c=Math.round(f/l)}else{l=roundScale(t,(1+Math.floor(l/m))*m);c=Math.round(f/l)}}}}else{c=p}var w=[];populateLabels(1,t,o,w,c,u,a,l);return{steps:c,stepValue:l,graphMin:u,labels:w,maxValue:i}}function roundScale(e,t){var n=0;var r=""+e.yAxisMinimumInterval;if(r.indexOf(".")>0){n=r.substr(r.indexOf(".")).length}return Math.round(t*Math.pow(10,n))/Math.pow(10,n)}function calculateOrderOfMagnitude(e){if(e==0)return 0;return Math.floor(Math.log(e)/Math.LN10)}function populateLabels(e,t,n,r,i,s,o,u){var a;if(e==2){a=t.logarithmic2;fmtYLabel=t.fmtYLabel2}else{a=t.logarithmic;fmtYLabel=t.fmtYLabel}if(n){if(!a){for(var f=0;f<i+1;f++){r.push(tmpl(n,{value:fmtChartJS(t,1*(s+u*f).toFixed(getDecimalPlaces(u)),fmtYLabel)}))}}else{var l=s;for(var f=0;f<i+1;f++){r.push(tmpl(n,{value:fmtChartJS(t,1*l.toFixed(getDecimalPlaces(l)),fmtYLabel)}));l*=10}}}}function Max(e){return Math.max.apply(Math,e)}function Min(e){return Math.min.apply(Math,e)}function Default(e,t){if(!e){return t}else{return e}}function CapValue(e,t,n){if(isNumber(t)){if(e>t){return t}}if(isNumber(n)){if(e<n){return n}}return e}function getDecimalPlaces(e){var t=(""+e).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);if(!t){return 0}return Math.max(0,(t[1]?t[1].length:0)-(t[2]?+t[2]:0))}function mergeChartConfig(e,t){var n={};for(var r in e){n[r]=e[r]}for(var r in t){n[r]=t[r]}return n}function tmpl(e,t){var n=!/\W/.test(e)?cache[e]=cache[e]||tmpl(document.getElementById(e).innerHTML):new Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};"+"with(obj){p.push('"+e.replace(/[\r\t\n]/g," ").split("<%").join("	").replace(/((^|%>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)%>/g,"',$1,'").split("	").join("');").split("%>").join("p.push('").split("\r").join("\\'")+"');}return p.join('');");return t?n(t):n}function dispCrossText(e,t,n,r,i,s,o,u,a,f){var l,c,h,p,d,v;for(l=0;l<t.crossText.length;l++){if(t.crossText[l]!=""&&t.crossTextOverlay[Min([l,t.crossTextOverlay.length-1])]==o&&(f==1&&t.crossTextIter[Min([l,t.crossTextIter.length-1])]=="first"||t.crossTextIter[Min([l,t.crossTextIter.length-1])]==f||t.crossTextIter[Min([l,t.crossTextIter.length-1])]=="all"||a==1&&t.crossTextIter[Min([l,t.crossTextIter.length-1])]=="last")){e.save();e.beginPath();e.font=t.crossTextFontStyle[Min([l,t.crossTextFontStyle.length-1])]+" "+t.crossTextFontSize[Min([l,t.crossTextFontSize.length-1])]+"px "+t.crossTextFontFamily[Min([l,t.crossTextFontFamily.length-1])];e.fillStyle=t.crossTextFontColor[Min([l,t.crossTextFontColor.length-1])];d=t.crossTextAlign[Min([l,t.crossTextAlign.length-1])];v=t.crossTextBaseline[Min([l,t.crossTextBaseline.length-1])];h=1*t.crossTextPosX[Min([l,t.crossTextPosX.length-1])];p=1*t.crossTextPosY[Min([l,t.crossTextPosY.length-1])];switch(1*t.crossTextRelativePosX[Min([l,t.crossTextRelativePosX.length-1])]){case 0:if(d=="default")d="left";break;case 1:h+=i;if(d=="default")d="right";break;case 2:h+=n;if(d=="default")d="center";break;case-2:h+=context.canvas.width/2;if(d=="default")d="center";break;case 3:h+=h+2*n-i;if(d=="default")d="left";break;case 4:h+=context.canvas.width;if(d=="default")d="right";break;default:h+=n;if(d=="default")d="center";break}switch(1*t.crossTextRelativePosY[Min([l,t.crossTextRelativePosY.length-1])]){case 0:if(v=="default")v="top";break;case 3:p+=s;if(v=="default")v="top";break;case 2:p+=r;if(v=="default")v="middle";break;case-2:p+=context.canvas.height/2;if(v=="default")v="middle";break;case 1:p+=p+2*r-s;if(v=="default")v="bottom";break;case 4:p+=context.canvas.height;if(v=="default")v="bottom";break;default:p+=r;if(v=="default")v="middle";break}e.textAlign=d;e.textBaseline=v;e.translate(1*h,1*p);e.rotate(Math.PI*t.crossTextAngle[Min([l,t.crossTextAngle.length-1])]/180);if(t.crossText[l].substring(0,1)=="%"){if(typeof t.crossTextFunction=="function")c=t.crossTextFunction(l,t.crossText[l],e,t,n,r,i,s,o,u,a)}else c=t.crossText[l];e.fillTextMultiLine(c,0,0,e.textBaseline,t.crossTextFontSize[Min([l,t.crossTextFontSize.length-1])],true);e.stroke();e.restore()}}}function dispCrossImage(e,t,n,r,i,s,o,u,a,f){var l,c,h,p,d,v;for(l=0;l<t.crossImage.length;l++){if(typeof t.crossImage[l]!="undefined"&&t.crossImageOverlay[Min([l,t.crossImageOverlay.length-1])]==o&&(f==-1&&t.crossImageIter[Min([l,t.crossImageIter.length-1])]=="background"||f==1&&t.crossImageIter[Min([l,t.crossImageIter.length-1])]=="first"||t.crossImageIter[Min([l,t.crossImageIter.length-1])]==f||f!=-1&&t.crossImageIter[Min([l,t.crossImageIter.length-1])]=="all"||a==1&&t.crossImageIter[Min([l,t.crossImageIter.length-1])]=="last")){e.save();e.beginPath();d=t.crossImageAlign[Min([l,t.crossImageAlign.length-1])];v=t.crossImageBaseline[Min([l,t.crossImageBaseline.length-1])];h=1*t.crossImagePosX[Min([l,t.crossImagePosX.length-1])];p=1*t.crossImagePosY[Min([l,t.crossImagePosY.length-1])];switch(1*t.crossImageRelativePosX[Min([l,t.crossImageRelativePosX.length-1])]){case 0:if(d=="default")d="left";break;case 1:h+=i;if(d=="default")d="right";break;case 2:h+=n;if(d=="default")d="center";break;case-2:h+=context.canvas.width/2;if(d=="default")d="center";break;case 3:h+=h+2*n-i;if(d=="default")d="left";break;case 4:h+=context.canvas.width;if(d=="default")d="right";break;default:h+=n;if(d=="default")d="center";break}switch(1*t.crossImageRelativePosY[Min([l,t.crossImageRelativePosY.length-1])]){case 0:if(v=="default")v="top";break;case 3:p+=s;if(v=="default")v="top";break;case 2:p+=r;if(v=="default")v="middle";break;case-2:p+=context.canvas.height/2;if(v=="default")v="middle";break;case 1:p+=p+2*r-s;if(v=="default")v="bottom";break;case 4:p+=context.canvas.height;if(v=="default")v="bottom";break;default:p+=r;if(v=="default")v="middle";break}var m=t.crossImage[l].width;switch(d){case"left":break;case"right":h-=m;break;case"center":h-=m/2;break;default:break}var g=t.crossImage[l].height;switch(v){case"top":break;case"bottom":p-=g;break;case"middle":p-=g/2;break;default:break}e.translate(1*h,1*p);e.rotate(Math.PI*t.crossImageAngle[Min([l,t.crossImageAngle.length-1])]/180);e.drawImage(t.crossImage[l],0,0);e.restore()}}}function setMeasures(e,t,n,r,i,s,o,u,a,f,l,c,h){if(t.canvasBackgroundColor!="none")n.canvas.style.background=t.canvasBackgroundColor;var p=0;var d=0;var v=0;var m=0;var g=0;var y=0;var b=0;var w=0;var E=0;var S=0;var x=0;var T=0;var N=0;var C=0;var k=0;var L=0;var A=0;var O=0;var M=0;var _=0;var D=0;var P=0;var H=0;var B=0;var j=1;var F=1;var I=0;var q=1;var R=0;var U=1;var z=0;var W=0;var X=0;var V=0;var $=0;var J=0;n.widthAtSetMeasures=i;n.heightAtSetMeasures=r;if(t.canvasBorders)p=t.canvasBordersWidth;if(f){n.font=t.scaleFontStyle+" "+t.scaleFontSize+"px "+t.scaleFontFamily;for(var K=0;K<e.labels.length;K++){var Q=n.measureTextMultiLine(fmtChartJS(t,e.labels[K],t.fmtXLabel),t.scaleFontSize);j=Q.textWidth>j?Q.textWidth:j;F=Q.textHeight>F?Q.textHeight:F}if(j<t.xScaleLabelsMinimumWidth){j=t.xScaleLabelsMinimumWidth}}if(f){I=1;if(s!=null&&s!="nihil"){n.font=t.scaleFontStyle+" "+t.scaleFontSize+"px "+t.scaleFontFamily;for(var K=s.length-1;K>=0;K--){if(typeof s[K]=="string"){if(s[K].trim()!=""){var Q=n.measureTextMultiLine(fmtChartJS(t,s[K],t.fmtYLabel),t.scaleFontSize);I=Q.textWidth>I?Q.textWidth:I;q=Q.textHeight>q?Q.textHeight:q}}}}if(I<t.yScaleLabelsMinimumWidth){I=t.yScaleLabelsMinimumWidth}R=1;if(o!=null&&t.yAxisRight){n.font=t.scaleFontStyle+" "+t.scaleFontSize+"px "+t.scaleFontFamily;for(var K=o.length-1;K>=0;K--){if(typeof o[K]=="string"){if(o[K].trim()!=""){var Q=n.measureTextMultiLine(fmtChartJS(t,o[K],t.fmtYLabel2),t.scaleFontSize);R=Q.textWidth>R?Q.textWidth:R;U=Q.textHeight>U?Q.textHeight:U}}}}else{R=I}if(R<t.yScaleLabelsMinimumWidth){R=t.yScaleLabelsMinimumWidth}}z=p+t.spaceLeft;W=p+t.spaceRight;if(f){if(typeof t.yAxisLabel!="undefined"){if(t.yAxisLabel.trim()!=""){_=t.yAxisFontSize*(t.yAxisLabel.split("\n").length||1)+t.yAxisLabelSpaceLeft+t.yAxisLabelSpaceRight;D=p+t.spaceLeft+t.yAxisLabelSpaceLeft+t.yAxisFontSize;P=i-p-t.spaceRight-t.yAxisLabelSpaceLeft-t.yAxisFontSize}}if(t.yAxisLeft){if(a==false)z=p+t.spaceLeft+_+I+t.yAxisSpaceLeft+t.yAxisSpaceRight;else z=p+t.spaceLeft+_+j+t.yAxisSpaceLeft+t.yAxisSpaceRight}if(t.yAxisRight){if(a==false)W=p+t.spaceRight+_+R+t.yAxisSpaceLeft+t.yAxisSpaceRight;else W=p+t.spaceRight+_+j+t.yAxisSpaceLeft+t.yAxisSpaceRight}}availableWidth=i-z-W;if(t.graphTitle.trim()!=""){v=t.graphTitleFontSize*(t.graphTitle.split("\n").length||1)+t.graphTitleSpaceBefore+t.graphTitleSpaceAfter;m=p+t.spaceTop+v-t.graphTitleSpaceAfter}if(t.graphSubTitle.trim()!=""){g=t.graphSubTitleFontSize*(t.graphSubTitle.split("\n").length||1)+t.graphSubTitleSpaceBefore+t.graphSubTitleSpaceAfter;y=p+t.spaceTop+v+g-t.graphSubTitleSpaceAfter}if(f){if(t.yAxisUnit.trim()!=""){E=t.yAxisUnitFontSize*(t.yAxisUnit.split("\n").length||1)+t.yAxisUnitSpaceBefore+t.yAxisUnitSpaceAfter;S=p+t.spaceTop+v+g+E-t.yAxisUnitSpaceAfter}}topNotUsableSize=p+t.spaceTop+v+g+E+t.graphSpaceBefore;if(typeof t.footNote!="undefined"){if(t.footNote.trim()!=""){b=t.footNoteFontSize*(t.footNote.split("\n").length||1)+t.footNoteSpaceBefore+t.footNoteSpaceAfter;w=r-t.spaceBottom-p-t.footNoteSpaceAfter}}if(f){if(typeof t.xAxisLabel!="undefined"){if(t.xAxisLabel.trim()!=""){H=t.xAxisFontSize*(t.xAxisLabel.split("\n").length||1)+t.xAxisLabelSpaceBefore+t.xAxisLabelSpaceAfter;d=r-p-t.spaceBottom-b-t.xAxisLabelSpaceAfter}}}bottomNotUsableHeightWithoutXLabels=p+t.spaceBottom+b+H+t.graphSpaceAfter;if(typeof t.legend!="undefined"){if(t.legend==true){n.font=t.legendFontStyle+" "+t.legendFontSize+"px "+t.legendFontFamily;if(l){for(var K=e.datasets.length-1;K>=0;K--){if(typeof e.datasets[K].title=="string"){if(e.datasets[K].title.trim()!=""){T++;var G=n.measureText(fmtChartJS(t,e.datasets[K].title,t.fmtLegend)).width;x=G>x?G:x}}}}else{for(var K=e.length-1;K>=0;K--){if(typeof e[K].title=="string"){if(e[K].title.trim()!=""){T++;var G=n.measureText(fmtChartJS(t,e[K].title,t.fmtLegend)).width;x=G>x?G:x}}}}if(T>1||T==1&&t.showSingleLegend){x+=t.legendBlockSize+t.legendSpaceBetweenBoxAndText;if(t.legendPosY==1||t.legendPosY==2||t.legendPosY==3){availableLegendWidth=availableWidth-t.legendSpaceLeftText-t.legendSpaceRightText}else{availableLegendWidth=i-t.spaceLeft-t.spaceRight-2*p-t.legendSpaceLeftText-t.legendSpaceRightText}if(t.legendBorders==true)availableLegendWidth-=2*t.legendBordersWidth-t.legendBordersSpaceLeft-t.legendBordersSpaceRight;maxLegendOnLine=Min([Math.floor((availableLegendWidth+t.legendSpaceBetweenTextHorizontal)/(x+t.legendSpaceBetweenTextHorizontal)),t.maxLegendCols]);N=Math.ceil(T/maxLegendOnLine);C=Math.ceil(T/N);var Y=N*(t.legendFontSize+t.legendSpaceBetweenTextVertical)-t.legendSpaceBetweenTextVertical+t.legendSpaceBeforeText+t.legendSpaceAfterText;switch(t.legendPosY){case 0:L=t.spaceLeft+(i-t.spaceLeft-t.spaceRight-C*(x+t.legendSpaceBetweenTextHorizontal)+t.legendSpaceBetweenTextHorizontal)/2;k=Y;if(t.legendBorders==true){M=topNotUsableSize+t.legendBordersSpaceBefore+t.legendBordersWidth/2;A=M+t.legendBordersWidth/2+t.legendSpaceBeforeText+t.legendFontSize;k+=2*t.legendBordersWidth+t.legendBordersSpaceBefore+t.legendBordersSpaceAfter;O=Math.floor(L-t.legendSpaceLeftText-t.legendBordersWidth/2);J=Math.ceil(k-t.legendBordersWidth)-t.legendBordersSpaceBefore-t.legendBordersSpaceAfter;$=Math.ceil(C*(x+t.legendSpaceBetweenTextHorizontal))-t.legendSpaceBetweenTextHorizontal+t.legendBordersWidth+t.legendSpaceRightText+t.legendSpaceLeftText}else{A=topNotUsableSize+t.legendBordersSpaceBefore+t.legendBordersWidth/2}if(E>0){S+=k;if(t.legendBorders==true)M-=E;A-=E}topNotUsableSize+=k;break;case 1:k=Y;L=t.spaceLeft+(i-t.spaceLeft-t.spaceRight-C*(x+t.legendSpaceBetweenTextHorizontal)+t.legendSpaceBetweenTextHorizontal)/2;A=topNotUsableSize+t.legendSpaceBeforeText+t.legendFontSize;if(t.legendBorders==true){A+=t.legendBordersSpaceBefore+t.legendBordersWidth;M=A-t.legendSpaceBeforeText-t.legendFontSize-t.legendBordersWidth/2;k+=2*t.legendBordersWidth+t.legendBordersSpaceBefore+t.legendBordersSpaceAfter;O=Math.floor(L-t.legendSpaceLeftText-t.legendBordersWidth/2);J=Math.ceil(k-t.legendBordersWidth)-t.legendBordersSpaceBefore-t.legendBordersSpaceAfter;$=Math.ceil(C*(x+t.legendSpaceBetweenTextHorizontal))-t.legendSpaceBetweenTextHorizontal+t.legendBordersWidth+t.legendSpaceRightText+t.legendSpaceLeftText}break;case 2:k=Y;L=t.spaceLeft+(i-t.spaceLeft-t.spaceRight-C*(x+t.legendSpaceBetweenTextHorizontal)+t.legendSpaceBetweenTextHorizontal)/2;A=topNotUsableSize+(r-topNotUsableSize-bottomNotUsableHeightWithoutXLabels-k)/2+t.legendSpaceBeforeText+t.legendFontSize;if(t.legendBorders==true){A+=t.legendBordersSpaceBefore-t.legendBordersSpaceAfter;M=A-t.legendSpaceBeforeText-t.legendFontSize-t.legendBordersWidth/2;k+=2*t.legendBordersWidth+t.legendBordersSpaceBefore+t.legendBordersSpaceAfter;O=Math.floor(L-t.legendSpaceLeftText-t.legendBordersWidth/2);J=Math.ceil(k-t.legendBordersWidth)-t.legendBordersSpaceBefore-t.legendBordersSpaceAfter;$=Math.ceil(C*(x+t.legendSpaceBetweenTextHorizontal))-t.legendSpaceBetweenTextHorizontal+t.legendBordersWidth+t.legendSpaceRightText+t.legendSpaceLeftText}break;case-2:k=Y;L=t.spaceLeft+(i-t.spaceLeft-t.spaceRight-C*(x+t.legendSpaceBetweenTextHorizontal)+t.legendSpaceBetweenTextHorizontal)/2;A=(r-k)/2+t.legendSpaceBeforeText+t.legendFontSize;if(t.legendBorders==true){A+=t.legendBordersSpaceBefore-t.legendBordersSpaceAfter;M=A-t.legendSpaceBeforeText-t.legendFontSize-t.legendBordersWidth/2;k+=2*t.legendBordersWidth+t.legendBordersSpaceBefore+t.legendBordersSpaceAfter;O=Math.floor(L-t.legendSpaceLeftText-t.legendBordersWidth/2);J=Math.ceil(k-t.legendBordersWidth)-t.legendBordersSpaceBefore-t.legendBordersSpaceAfter;$=Math.ceil(C*(x+t.legendSpaceBetweenTextHorizontal))-t.legendSpaceBetweenTextHorizontal+t.legendBordersWidth+t.legendSpaceRightText+t.legendSpaceLeftText}break;case 3:k=Y;L=t.spaceLeft+(i-t.spaceLeft-t.spaceRight-C*(x+t.legendSpaceBetweenTextHorizontal)+t.legendSpaceBetweenTextHorizontal)/2;availableHeight=r-topNotUsableSize-bottomNotUsableHeightWithoutXLabels;A=topNotUsableSize+availableHeight-k+t.legendSpaceBeforeText+t.legendFontSize;if(t.legendBorders==true){A-=t.legendBordersSpaceAfter+t.legendBordersWidth;M=A-t.legendSpaceBeforeText-t.legendFontSize-t.legendBordersWidth/2;k+=2*t.legendBordersWidth+t.legendBordersSpaceBefore+t.legendBordersSpaceAfter;O=Math.floor(L-t.legendSpaceLeftText-t.legendBordersWidth/2);J=Math.ceil(k-t.legendBordersWidth)-t.legendBordersSpaceBefore-t.legendBordersSpaceAfter;$=Math.ceil(C*(x+t.legendSpaceBetweenTextHorizontal))-t.legendSpaceBetweenTextHorizontal+t.legendBordersWidth+t.legendSpaceRightText+t.legendSpaceLeftText}break;default:k=Y;A=r-p-t.spaceBottom-b-k+t.legendSpaceBeforeText+t.legendFontSize;L=t.spaceLeft+(i-t.spaceLeft-t.spaceRight-C*(x+t.legendSpaceBetweenTextHorizontal)+t.legendSpaceBetweenTextHorizontal)/2;if(t.legendBorders==true){k+=2*t.legendBordersWidth+t.legendBordersSpaceBefore+t.legendBordersSpaceAfter;A-=t.legendBordersWidth+t.legendBordersSpaceAfter;M=Math.floor(r-p-t.spaceBottom-b-k+t.legendBordersWidth/2+t.legendBordersSpaceBefore);O=Math.floor(L-t.legendSpaceLeftText-t.legendBordersWidth/2);J=Math.ceil(k-t.legendBordersWidth)-t.legendBordersSpaceBefore-t.legendBordersSpaceAfter;$=Math.ceil(C*(x+t.legendSpaceBetweenTextHorizontal))-t.legendSpaceBetweenTextHorizontal+t.legendBordersWidth+t.legendSpaceRightText+t.legendSpaceLeftText}d-=k;bottomNotUsableHeightWithoutXLabels+=k;break}var Z=t.legendSpaceRightText+C*(x+t.legendSpaceBetweenTextHorizontal)-t.legendSpaceBetweenTextHorizontal+t.legendSpaceLeftText;if(t.legendBorders==true){Z+=2*t.legendBordersWidth+t.legendBordersSpaceLeft+t.legendBordersSpaceRight}switch(t.legendPosX){case 0:L=t.spaceLeft+t.canvasBorders*t.canvasBordersWidth+t.legendSpaceLeftText;if(t.legendBorders==true){L+=t.legendBordersWidth/2+t.legendBordersSpaceLeft;O=t.spaceLeft+t.canvasBorders*t.canvasBordersWidth+t.legendBordersSpaceLeft}if(t.legendPosY>=1&&t.legendPosY<=3||t.legendPosY==-2){z+=Z;D+=Z}break;case 1:L=z+t.legendSpaceLeftText;if(t.legendBorders==true){O=L;L+=t.legendBordersWidth/2+t.legendBordersSpaceLeft}break;case 2:L=z+(i-W-z)/2-(t.legendSpaceLeftText-t.legendSpaceRightText)-(C*(x+t.legendSpaceBetweenTextHorizontal)-t.legendSpaceBetweenTextHorizontal)/2;if(t.legendBorders==true){L-=t.legendBordersWidth/2+t.legendBordersSpaceRight;O=L-t.legendBordersWidth/2-t.legendSpaceLeftText}break;case 3:L=i-W-t.legendSpaceRightText-C*(x+t.legendSpaceBetweenTextHorizontal)+t.legendSpaceBetweenTextHorizontal/2;if(t.legendBorders==true){L-=t.legendBordersWidth/2+t.legendBordersSpaceRight;O=L-t.legendBordersWidth/2-t.legendSpaceLeftText}break;case 4:L=i-t.spaceRight-t.canvasBorders*t.canvasBordersWidth-t.legendSpaceRightText-C*(x+t.legendSpaceBetweenTextHorizontal)+t.legendSpaceBetweenTextHorizontal/2;if(t.legendBorders==true){L-=t.legendBordersWidth/2+t.legendBordersSpaceRight;O=L-t.legendBordersSpaceLeft-t.legendBordersWidth/2}if(t.legendPosY>=1&&t.legendPosY<=3||t.legendPosY==-2){W+=Z;P-=Z}break;default:break}if(t.legendBorders==true){M+=t.legendYPadding;O+=t.legendXPadding}A+=t.legendYPadding;L+=t.legendXPadding}}}xLabelWidth=0;bottomNotUsableHeightWithXLabels=bottomNotUsableHeightWithoutXLabels;if(f&&(t.xAxisBottom||t.xAxisTop)){if(a==false){var et=j;var tt=F;nblab=e.labels.length}else{var et=I;var tt=q;nblab=s.length}if(t.rotateLabels=="smart"){X=0;if((availableWidth+t.xAxisSpaceBetweenLabels)/nblab<et+t.xAxisSpaceBetweenLabels){X=45;if(availableWidth/nblab<Math.abs(Math.cos(X*Math.PI/180)*et)){X=90}}}else{X=t.rotateLabels;if(X<0)X=0;if(X>180)X=180}if(X>90)X+=180;B=Math.abs(Math.sin(X*Math.PI/180)*et)+Math.abs(Math.sin((X+90)*Math.PI/180)*tt)+t.xAxisSpaceBefore+t.xAxisSpaceAfter;V=r-p-t.spaceBottom-b-H-(B-t.xAxisSpaceBefore)-t.graphSpaceAfter;xLabelWidth=Math.abs(Math.cos(X*Math.PI/180)*et)+Math.abs(Math.cos((X+90)*Math.PI/180)*tt);z=Max([z,p+t.spaceLeft+xLabelWidth/2]);W=Max([W,p+t.spaceRight+xLabelWidth/2]);availableWidth=i-z-W;if(t.legend&&t.xAxisBottom&&t.legendPosY==4){V-=k}bottomNotUsableHeightWithXLabels=bottomNotUsableHeightWithoutXLabels+B}else{availableWidth=i-z-W}availableHeight=r-topNotUsableSize-bottomNotUsableHeightWithXLabels;dispCrossImage(n,t,i/2,r/2,i/2,r/2,false,e,-1,-1);if(s!="nihil"){if(p>0){n.save();n.beginPath();n.lineWidth=2*p;n.strokeStyle=t.canvasBordersColor;n.moveTo(0,0);n.lineTo(0,r);n.lineTo(i,r);n.lineTo(i,0);n.lineTo(0,0);n.stroke();n.restore()}if(v>0){n.save();n.beginPath();n.font=t.graphTitleFontStyle+" "+t.graphTitleFontSize+"px "+t.graphTitleFontFamily;n.fillStyle=t.graphTitleFontColor;n.textAlign="center";n.textBaseline="bottom";n.translate(t.spaceLeft+(i-t.spaceLeft-t.spaceRight)/2,m);n.fillTextMultiLine(t.graphTitle,0,0,n.textBaseline,t.graphTitleFontSize,true);n.stroke();n.restore()}if(g>0){n.save();n.beginPath();n.font=t.graphSubTitleFontStyle+" "+t.graphSubTitleFontSize+"px "+t.graphSubTitleFontFamily;n.fillStyle=t.graphSubTitleFontColor;n.textAlign="center";n.textBaseline="bottom";n.translate(t.spaceLeft+(i-t.spaceLeft-t.spaceRight)/2,y);n.fillTextMultiLine(t.graphSubTitle,0,0,n.textBaseline,t.graphSubTitleFontSize,true);n.stroke();n.restore()}if(E>0){if(t.yAxisLeft){n.save();n.beginPath();n.font=t.yAxisUnitFontStyle+" "+t.yAxisUnitFontSize+"px "+t.yAxisUnitFontFamily;n.fillStyle=t.yAxisUnitFontColor;n.textAlign="center";n.textBaseline="bottom";n.translate(z,S);n.fillTextMultiLine(t.yAxisUnit,0,0,n.textBaseline,t.yAxisUnitFontSize,true);n.stroke();n.restore()}if(t.yAxisRight){if(t.yAxisUnit2=="")t.yAxisUnit2=t.yAxisUnit;n.save();n.beginPath();n.font=t.yAxisUnitFontStyle+" "+t.yAxisUnitFontSize+"px "+t.yAxisUnitFontFamily;n.fillStyle=t.yAxisUnitFontColor;n.textAlign="center";n.textBaseline="bottom";n.translate(i-W,S);n.fillTextMultiLine(t.yAxisUnit2,0,0,n.textBaseline,t.yAxisUnitFontSize,true);n.stroke();n.restore()}}if(_>0){if(t.yAxisLeft){n.save();n.beginPath();n.font=t.yAxisFontStyle+" "+t.yAxisFontSize+"px "+t.yAxisFontFamily;n.fillStyle=t.yAxisFontColor;n.textAlign="center";n.textBaseline="bottom";n.translate(D,topNotUsableSize+availableHeight/2);n.rotate(-(90*(Math.PI/180)));n.fillTextMultiLine(t.yAxisLabel,0,0,n.textBaseline,t.yAxisFontSize,false);n.stroke();n.restore()}if(t.yAxisRight){if(t.yAxisLabel2=="")t.yAxisLabel2=t.yAxisLabel;n.save();n.beginPath();n.font=t.yAxisFontStyle+" "+t.yAxisFontSize+"px "+t.yAxisFontFamily;n.fillStyle=t.yAxisFontColor;n.textAlign="center";n.textBaseline="bottom";n.translate(P,topNotUsableSize+availableHeight/2);n.rotate(+(90*(Math.PI/180)));n.fillTextMultiLine(t.yAxisLabel2,0,0,n.textBaseline,t.yAxisFontSize,false);n.stroke();n.restore()}}if(H>0){if(t.xAxisBottom){n.save();n.beginPath();n.font=t.xAxisFontStyle+" "+t.xAxisFontSize+"px "+t.xAxisFontFamily;n.fillStyle=t.xAxisFontColor;n.textAlign="center";n.textBaseline="bottom";n.translate(z+availableWidth/2,d);n.fillTextMultiLine(t.xAxisLabel,0,0,n.textBaseline,t.xAxisFontSize,true);n.stroke();n.restore()}}if(T>1||T==1&&t.showSingleLegend){var nt={dispLegend:true,xLegendBorderPos:O,yLegendBorderPos:M,legendBorderWidth:$,legendBorderHeight:J,nbLegendCols:C,xFirstLegendTextPos:L,yFirstLegendTextPos:A,drawLegendOnData:l,reverseLegend:u,legendBox:c,widestLegend:x};if(t.legendPosY==0||t.legendPosY==4||t.legendPosX==0||t.legendPosX==4){drawLegend(nt,e,t,n,h);var nt={dispLegend:false}}}else{var nt={dispLegend:false}}if(t.footNote.trim()!=""){n.save();n.font=t.footNoteFontStyle+" "+t.footNoteFontSize+"px "+t.footNoteFontFamily;n.fillStyle=t.footNoteFontColor;n.textAlign="center";n.textBaseline="bottom";n.translate(z+availableWidth/2,w);n.fillTextMultiLine(t.footNote,0,0,n.textBaseline,t.footNoteFontSize,true);n.stroke();n.restore()}}clrx=z;clrwidth=availableWidth;clry=topNotUsableSize;clrheight=availableHeight;return{leftNotUsableSize:z,rightNotUsableSize:W,availableWidth:availableWidth,topNotUsableSize:topNotUsableSize,bottomNotUsableHeightWithoutXLabels:bottomNotUsableHeightWithoutXLabels,bottomNotUsableHeightWithXLabels:bottomNotUsableHeightWithXLabels,availableHeight:availableHeight,widestXLabel:j,highestXLabel:F,widestYLabel:I,widestYLabel2:R,highestYLabel:q,rotateLabels:X,xLabelPos:V,clrx:clrx,clry:clry,clrwidth:clrwidth,clrheight:clrheight,legendMsr:nt}}function drawLinesDataset(e,t,n,r,i,s){function x(e,s,o,u){if(setOptionValue("BEZIERCURVE",r,t,i,undefined,n.bezierCurve,u,-1,{nullValue:true})){e.length=0;e.push(s);e.push(o)}}function T(e,t,n,r,i,s,o,u){if(setOptionValue("BEZIERCURVE",t,s,o,undefined,i.bezierCurve,u,-1,{nullValue:true})){e.push(n);e.push(r)}else{t.lineTo(n,r)}}function N(e,n,r,s){if(setOptionValue("BEZIERCURVE",n,t,i,undefined,r.bezierCurve,s,-1,{nullValue:true})){minimumpos=i[s][0].xAxisPosY;maximumpos=i[s][0].xAxisPosY-i[s][0].calculatedScale.steps*i[s][0].scaleHop;k(n,e,setOptionValue("BEZIERCURVETENSION",n,t,i,undefined,r.bezierCurveTension,s,-1,{nullValue:true}),minimumpos,maximumpos);e.length=0}}function C(e,t,n,r,i,s,o){var u=Math.sqrt(Math.pow(n-e,2)+Math.pow(r-t,2));var a=Math.sqrt(Math.pow(i-n,2)+Math.pow(s-r,2));var f=o*u/(u+a);var l=o-f;var c=n+f*(e-i);var h=r+f*(t-s);var p=n-l*(e-i);var d=r-l*(t-s);return[c,h,p,d]}function k(e,r,s,a,f){var l=[];var c=r.length;r.push(2*r[c-2]-r[c-4]);r.push(2*r[c-1]-r[c-3]);if(c==4){e.moveTo(r[0],r[1]);e.lineTo(r[2],r[3]);return}for(var h=0;h<c-2;h+=2){l=l.concat(C(r[h],r[h+1],r[h+2],r[h+3],r[h+4],r[h+5],s))}e.beginPath();e.strokeStyle=setOptionValue("STROKECOLOR",e,t,i,t.datasets[p].strokeColor,n.defaultStrokeColor,p,m,{nullvalue:null});e.lineWidth=n.datasetStrokeWidth;e.moveTo(r[0],r[1]);e.quadraticCurveTo(l[0],Math.max(Math.min(l[1],a),f),r[2],r[3]);for(var h=2;h<r.length-3;h+=2){o=Math.max(Math.min(l[2*h-1],a),f);u=Math.max(Math.min(l[2*h+1],a),f);e.bezierCurveTo(l[2*h-2],o,l[2*h],u,r[h+2],r[h+3])}e.stroke()}var o,u,a,f,l,c;var h=[];for(var p=0;p<t.datasets.length;p++){if(i[p][0].tpchart!="Line")continue;if(i[p].length==0)continue;if(i[p][0].firstNotMissing==-1)continue;r.save();r.beginPath();prevAnimPc={mainVal:0,subVal:0,animVal:0};var d=-1;var v=-1;for(var m=i[p][0].firstNotMissing;m<=i[p][0].lastNotMissing;m++){if(prevAnimPc.animVal==0&&m>i[p][0].firstNotMissing)continue;var g=animationCorrection(e,t,n,p,m,0);if(g.mainVal==0&&prevAnimPc.mainVal>0&&d!=-1){r.stroke();if(n.extrapolateMissingData){o=i[p][i[p][m].prevNotMissing].yAxisPos-prevAnimPc.mainVal*i[p][i[p][m].prevNotMissing].yPosOffset;u=i[p][m].yAxisPos-prevAnimPc.mainVal*i[p][i[p][m-1].nextNotMissing].yPosOffset;f=i[p][m-1].nextNotMissing-i[p][m].prevNotMissing;l=m-1-i[p][m].prevNotMissing;c=(l+prevAnimPc.subVal)/f;a=o+c*(u-o);T(h,r,i[p][m-1].xPos+prevAnimPc.subVal*(i[p][m].xPos-i[p][m-1].xPos),a,n,t,i,p);N(h,r,n,p);r.stroke();r.strokeStyle="rgba(0,0,0,0)";if(n.datasetFill){r.lineTo(i[p][m-1].xPos+prevAnimPc.subVal*(i[p][m].xPos-i[p][m-1].xPos),i[p][m].yAxisPos);r.lineTo(i[p][d].xPos,i[p][d].xAxisPosY-i[p][0].zeroY);r.closePath();r.fillStyle=setOptionValue("COLOR",r,t,i,t.datasets[p].fillColor,n.defaultFillColor,p,m,{animationValue:g.mainVal,xPosLeft:i[p][0].xPos,yPosBottom:Math.max(i[p][0].yAxisPos,i[p][0].yAxisPos-(n.animationLeftToRight?1:1*g.mainVal)*i[p][0].lminvalue_offset),xPosRight:i[p][t.datasets[p].data.length-1].xPos,yPosTop:Math.min(i[p][0].yAxisPos,i[p][0].yAxisPos-(n.animationLeftToRight?1:1*g.mainVal)*i[p][0].lmaxvalue_offset)});r.fill();d=-1}}else if(!(typeof i[p][m].value=="undefined")){T(h,r,i[p][m-1].xPos+prevAnimPc.subVal*(i[p][m].xPos-i[p][m-1].xPos),i[p][m].yAxisPos-prevAnimPc.mainVal*i[p][i[p][m-1].nextNotMissing].yPosOffset,n,t,i,p);N(h,r,n,p);r.stroke();r.strokeStyle="rgba(0,0,0,0)";if(n.datasetFill){r.lineTo(i[p][m-1].xPos+prevAnimPc.subVal*(i[p][m].xPos-i[p][m-1].xPos),i[p][m].yAxisPos);r.lineTo(i[p][d].xPos,i[p][d].xAxisPosY-i[p][0].zeroY);r.closePath();r.fillStyle=setOptionValue("COLOR",r,t,i,t.datasets[p].fillColor,n.defaultFillColor,p,m,{animationValue:g.mainVal,xPosLeft:i[p][0].xPos,yPosBottom:Math.max(i[p][0].yAxisPos,i[p][0].yAxisPos-(n.animationLeftToRight?1:1*g.mainVal)*i[p][0].lminvalue_offset),xPosRight:i[p][t.datasets[p].data.length-1].xPos,yPosTop:Math.min(i[p][0].yAxisPos,i[p][0].yAxisPos-(n.animationLeftToRight?1:1*g.mainVal)*i[p][0].lmaxvalue_offset)});r.fill()}}prevAnimPc=g;continue}else if(g.totVal==0){r.stroke();r.strokeStyle="rgba(0,0,0,0)"}else{r.stroke();r.strokeStyle=setOptionValue("STROKECOLOR",r,t,i,t.datasets[p].strokeColor,n.defaultStrokeColor,p,m,{nullvalue:null})}prevAnimPc=g;switch(typeof t.datasets[p].data[m]){case"undefined":if(!n.extrapolateMissingData){if(d==-1)continue;N(h,r,n,p);r.stroke();if(n.datasetFill&&d!=-1){v=-1;r.strokeStyle="rgba(0,0,0,0)";r.lineTo(i[p][m-1].xPos,i[p][m-1].yAxisPos);r.lineTo(i[p][d].xPos,i[p][d].yAxisPos);r.closePath();r.fillStyle=setOptionValue("COLOR",r,t,i,t.datasets[p].fillColor,n.defaultFillColor,p,m,{animationValue:g.mainVal,xPosLeft:i[p][0].xPos,yPosBottom:Math.max(i[p][0].yAxisPos,i[p][0].yAxisPos-(n.animationLeftToRight?1:1*g.mainVal)*i[p][0].lminvalue_offset),xPosRight:i[p][t.datasets[p].data.length-1].xPos,yPosTop:Math.min(i[p][0].yAxisPos,i[p][0].yAxisPos-(n.animationLeftToRight?1:1*g.mainVal)*i[p][0].lmaxvalue_offset)});r.fill()}r.beginPath();prevAnimPc={mainVal:0,subVal:0};d=-1}else if(g.subVal>0){v=i[p][m].xPos+g.subVal*(i[p][m+1].xPos-i[p][m].xPos);o=i[p][i[p][m+1].prevNotMissing].yAxisPos-i[p][i[p][m+1].prevNotMissing].yPosOffset;u=i[p][i[p][m].nextNotMissing].yAxisPos-i[p][i[p][m].nextNotMissing].yPosOffset;f=i[p][m].nextNotMissing-i[p][m+1].prevNotMissing;l=m-i[p][m+1].prevNotMissing;c=(l+prevAnimPc.subVal)/f;var a=o+c*(u-o);T(h,r,i[p][m].xPos+g.subVal*(i[p][m+1].xPos-i[p][m].xPos),a,n,t,i,p)}break;default:r.lineWidth=n.datasetStrokeWidth;if(d==-1){d=m;r.beginPath();r.moveTo(i[p][m].xPos,i[p][m].yAxisPos-g.mainVal*i[p][m].yPosOffset);x(h,i[p][m].xPos,i[p][m].yAxisPos-g.mainVal*i[p][m].yPosOffset,p);v=i[p][m].xPos}else{v=i[p][m].xPos;T(h,r,i[p][m].xPos,i[p][m].yAxisPos-g.mainVal*i[p][m].yPosOffset,n,t,i,p)}if(g.subVal>0&&i[p][m].nextNotMissing!=-1&&(n.extrapolateMissing||i[p][m].nextNotMissing==m+1)){v=i[p][m].xPos+g.subVal*(i[p][m+1].xPos-i[p][m].xPos);var o=i[p][i[p][m+1].prevNotMissing].yAxisPos-i[p][i[p][m+1].prevNotMissing].yPosOffset;var u=i[p][i[p][m].nextNotMissing].yAxisPos-i[p][i[p][m].nextNotMissing].yPosOffset;var a=o+g.subVal*(u-o);T(h,r,i[p][m].xPos+g.subVal*(i[p][m+1].xPos-i[p][m].xPos),a,n,t,i,p)}break}}N(h,r,n,p);r.stroke();if(n.datasetFill){if(d>=0){r.strokeStyle="rgba(0,0,0,0)";r.lineTo(v,i[p][0].xAxisPosY-i[p][0].zeroY);r.lineTo(i[p][d].xPos,i[p][d].xAxisPosY-i[p][0].zeroY);r.closePath();r.fillStyle=setOptionValue("COLOR",r,t,i,t.datasets[p].fillColor,n.defaultFillColor,p,-1,{animationValue:g.mainVal,xPosLeft:i[p][0].xPos,yPosBottom:Math.max(i[p][0].yAxisPos,i[p][0].yAxisPos-(n.animationLeftToRight?1:1*g.mainVal)*i[p][0].lminvalue_offset),xPosRight:i[p][t.datasets[p].data.length-1].xPos,yPosTop:Math.min(i[p][0].yAxisPos,i[p][0].yAxisPos-(n.animationLeftToRight?1:1*g.mainVal)*i[p][0].lmaxvalue_offset)});r.fill()}}r.restore();if(n.pointDot&&e>=1){for(var m=0;m<t.datasets[p].data.length;m++){if(!(typeof t.datasets[p].data[m]=="undefined")){var g=animationCorrection(e,t,n,p,m,0);if(g.mainVal>0||!n.animationLeftToRight){r.beginPath();r.fillStyle=setOptionValue("MARKERFILLCOLOR",r,t,i,t.datasets[p].pointColor,n.defaultStrokeColor,p,m,{nullvalue:true});r.strokeStyle=setOptionValue("MARKERSTROKESTYLE",r,t,i,t.datasets[p].pointStrokeColor,n.defaultStrokeColor,p,m,{nullvalue:true});r.lineWidth=setOptionValue("MARKERLINEWIDTH",r,t,i,t.datasets[p].pointDotStrokeWidth,n.pointDotStrokeWidth,p,m,{nullvalue:true});var y=setOptionValue("MARKERSHAPE",r,t,i,t.datasets[p].markerShape,n.markerShape,p,m,{nullvalue:true});var b=setOptionValue("MARKERRADIUS",r,t,i,t.datasets[p].pointDotRadius,n.pointDotRadius,p,m,{nullvalue:true});drawMarker(r,i[p][m].xPos,i[p][m].yAxisPos-g.mainVal*i[p][m].yPosOffset,y,b)}}}}if(e>=n.animationStopValue){for(var m=0;m<t.datasets[p].data.length;m++){if(typeof t.datasets[p].data[m]=="undefined")continue;if(setOptionValue("ANNOTATEDISPLAY",r,t,i,undefined,n.annotateDisplay,p,m,{nullValue:true})){jsGraphAnnotate[r.ChartNewId][jsGraphAnnotate[r.ChartNewId].length]=["POINT",p,m,i]}if(setOptionValue("INGRAPHDATASHOW",r,t,i,undefined,n.inGraphDataShow,p,m,{nullValue:true})){r.save();r.textAlign=setOptionValue("INGRAPHDATAALIGN",r,t,i,undefined,n.inGraphDataAlign,p,m,{nullValue:true});r.textBaseline=setOptionValue("INGRAPHDATAVALIGN",r,t,i,undefined,n.inGraphDataVAlign,p,m,{nullValue:true});r.font=setOptionValue("INGRAPHDATAFONTSTYLE",r,t,i,undefined,n.inGraphDataFontStyle,p,m,{nullValue:true})+" "+setOptionValue("INGRAPHDATAFONTSIZE",r,t,i,undefined,n.inGraphDataFontSize,p,m,{nullValue:true})+"px "+setOptionValue("INGRAPHDATAFONTFAMILY",r,t,i,undefined,n.inGraphDataFontFamily,p,m,{nullValue:true});r.fillStyle=setOptionValue("INGRAPHDATAFONTCOLOR",r,t,i,undefined,n.inGraphDataFontColor,p,m,{nullValue:true});var w=setOptionValue("INGRAPHDATAPADDINGX",r,t,i,undefined,n.inGraphDataPaddingX,p,m,{nullValue:true}),E=setOptionValue("INGRAPHDATAPADDINGY",r,t,i,undefined,n.inGraphDataPaddingY,p,m,{nullValue:true});var S=tmplbis(setOptionValue("INGRAPHDATATMPL",r,t,i,undefined,n.inGraphDataTmpl,p,m,{nullValue:true}),i[p][m]);r.translate(i[p][m].xPos+w,i[p][m].yAxisPos-g.mainVal*i[p][m].yPosOffset-E);r.rotate(setOptionValue("INGRAPHDATAROTATE",r,t,i,undefined,n.inGraphDataRotate,p,m,{nullValue:true})*(Math.PI/180));r.fillTextMultiLine(S,0,0,r.textBaseline,setOptionValue("INGRAPHDATAFONTSIZE",r,t,i,undefined,n.inGraphDataFontSize,p,m,{nullValue:true}),true);r.restore()}}}}}function log10(e){return Math.log(e)/Math.LN10}function setRect(e,t){if(t.clearRect){if(!t.multiGraph){clear(e);e.clearRect(0,0,width,height)}}else{clear(e);e.clearRect(0,0,width,height);e.fillStyle=t.savePngBackgroundColor;e.strokeStyle=t.savePngBackgroundColor;e.beginPath();e.moveTo(0,0);e.lineTo(0,e.canvas.height);e.lineTo(e.canvas.width,e.canvas.height);e.lineTo(e.canvas.width,0);e.lineTo(0,0);e.stroke();e.fill()}}function defMouse(e,t,n){function s(r,i,s){function o(r){if(s==null||s(r))doMouseAction(n,e,r,t,"mouseaction",i)}if(typeof i!="function")return;var u=r+" "+i.name;if(u in e._eventListeners){if(e.canvas.removeEventListener)e.canvas.removeEventListener(r,e._eventListeners[u]);else if(e.canvas.detachEvent)e.canvas.detachEvent(r,e._eventListeners[u])}e._eventListeners[u]=o;if(e.canvas.addEventListener){if(r=="mousewheel")r="DOMMouseScroll";e.canvas.addEventListener(r,o,false)}else if(e.canvas.attachEvent){e.canvas.attachEvent("on"+r,o)}}var r=false;if(typeof n.annotateDisplay=="function"){r=true}else if(typeof n.annotateDisplay=="object"){for(var i=0;i<n.annotateDisplay.length;i++)if(n.annotateDisplay[i])r=true}else todoannotage=n.annotateDisplay;if(isBooleanOptionTrue(undefined,n.annotateDisplay)){if(cursorDivCreated==false)oCursor=new makeCursorObj("divCursor");if(isIE()<9&&isIE()!=false)e.canvas.attachEvent("on"+n.annotateFunction.split(" ")[0],function(r){if(n.annotateFunction.split(" ")[1]=="left"&&r.which==1||n.annotateFunction.split(" ")[1]=="middle"&&r.which==2||n.annotateFunction.split(" ")[1]=="right"&&r.which==3||typeof n.annotateFunction.split(" ")[1]!="string")doMouseAction(n,e,r,t,"annotate",n.mouseDownRight)});else e.canvas.addEventListener(n.annotateFunction.split(" ")[0],function(r){if(n.annotateFunction.split(" ")[1]=="left"&&r.which==1||n.annotateFunction.split(" ")[1]=="middle"&&r.which==2||n.annotateFunction.split(" ")[1]=="right"&&r.which==3||typeof n.annotateFunction.split(" ")[1]!="string")doMouseAction(n,e,r,t,"annotate",n.mouseDownRight)},false)}if(n.savePng){if(isIE()<9&&isIE()!=false)e.canvas.attachEvent("on"+n.savePngFunction.split(" ")[0],function(r){if(n.savePngFunction.split(" ")[1]=="left"&&r.which==1||n.savePngFunction.split(" ")[1]=="middle"&&r.which==2||n.savePngFunction.split(" ")[1]=="right"&&r.which==3||typeof n.savePngFunction.split(" ")[1]!="string")saveCanvas(e,t,n)});else e.canvas.addEventListener(n.savePngFunction.split(" ")[0],function(r){if(n.savePngFunction.split(" ")[1]=="left"&&r.which==1||n.savePngFunction.split(" ")[1]=="middle"&&r.which==2||n.savePngFunction.split(" ")[1]=="right"&&r.which==3||typeof n.savePngFunction.split(" ")[1]!="string")saveCanvas(e,t,n)},false)}if(isIE()<9&&isIE()!=false)e.canvas.attachEvent("onmousewheel",function(e){if(cursorDivCreated)document.getElementById("divCursor").style.display="none"});else e.canvas.addEventListener("DOMMouseScroll",function(e){if(cursorDivCreated)document.getElementById("divCursor").style.display="none"},false);s("mousedown",n.mouseDownLeft,function(e){return e.which==1});s("mousedown",n.mouseDownMiddle,function(e){return e.which==2});s("mousedown",n.mouseDownRight,function(e){return e.which==3});s("mousemove",n.mouseMove);s("mouseout",n.mouseOut);s("mousewheel",n.mouseWheel)}var chart=this;var animationOptions={linear:function(e){return e},easeInQuad:function(e){return e*e},easeOutQuad:function(e){return-1*e*(e-2)},easeInOutQuad:function(e){if((e/=1/2)<1)return 1/2*e*e;return-1/2*(--e*(e-2)-1)},easeInCubic:function(e){return e*e*e},easeOutCubic:function(e){return 1*((e=e/1-1)*e*e+1)},easeInOutCubic:function(e){if((e/=1/2)<1)return 1/2*e*e*e;return 1/2*((e-=2)*e*e+2)},easeInQuart:function(e){return e*e*e*e},easeOutQuart:function(e){return-1*((e=e/1-1)*e*e*e-1)},easeInOutQuart:function(e){if((e/=1/2)<1)return 1/2*e*e*e*e;return-1/2*((e-=2)*e*e*e-2)},easeInQuint:function(e){return 1*(e/=1)*e*e*e*e},easeOutQuint:function(e){return 1*((e=e/1-1)*e*e*e*e+1)},easeInOutQuint:function(e){if((e/=1/2)<1)return 1/2*e*e*e*e*e;return 1/2*((e-=2)*e*e*e*e+2)},easeInSine:function(e){return-1*Math.cos(e/1*(Math.PI/2))+1},easeOutSine:function(e){return 1*Math.sin(e/1*(Math.PI/2))},easeInOutSine:function(e){return-1/2*(Math.cos(Math.PI*e/1)-1)},easeInExpo:function(e){return e==0?1:1*Math.pow(2,10*(e/1-1))},easeOutExpo:function(e){return e==1?1:1*(-Math.pow(2,-10*e/1)+1)},easeInOutExpo:function(e){if(e==0)return 0;if(e==1)return 1;if((e/=1/2)<1)return 1/2*Math.pow(2,10*(e-1));return 1/2*(-Math.pow(2,-10*--e)+2)},easeInCirc:function(e){if(e>=1)return e;return-1*(Math.sqrt(1-(e/=1)*e)-1)},easeOutCirc:function(e){return 1*Math.sqrt(1-(e=e/1-1)*e)},easeInOutCirc:function(e){if((e/=1/2)<1)return-1/2*(Math.sqrt(1-e*e)-1);return 1/2*(Math.sqrt(1-(e-=2)*e)+1)},easeInElastic:function(e){var t=1.70158;var n=0;var r=1;if(e==0)return 0;if((e/=1)==1)return 1;if(!n)n=1*.3;if(r<Math.abs(1)){r=1;var t=n/4}else var t=n/(2*Math.PI)*Math.asin(1/r);return-(r*Math.pow(2,10*(e-=1))*Math.sin((e*1-t)*2*Math.PI/n))},easeOutElastic:function(e){var t=1.70158;var n=0;var r=1;if(e==0)return 0;if((e/=1)==1)return 1;if(!n)n=1*.3;if(r<Math.abs(1)){r=1;var t=n/4}else var t=n/(2*Math.PI)*Math.asin(1/r);return r*Math.pow(2,-10*e)*Math.sin((e*1-t)*2*Math.PI/n)+1},easeInOutElastic:function(e){var t=1.70158;var n=0;var r=1;if(e==0)return 0;if((e/=1/2)==2)return 1;if(!n)n=1*.3*1.5;if(r<Math.abs(1)){r=1;var t=n/4}else var t=n/(2*Math.PI)*Math.asin(1/r);if(e<1)return-.5*r*Math.pow(2,10*(e-=1))*Math.sin((e*1-t)*2*Math.PI/n);return r*Math.pow(2,-10*(e-=1))*Math.sin((e*1-t)*2*Math.PI/n)*.5+1},easeInBack:function(e){var t=1.70158;return 1*(e/=1)*e*((t+1)*e-t)},easeOutBack:function(e){var t=1.70158;return 1*((e=e/1-1)*e*((t+1)*e+t)+1)},easeInOutBack:function(e){var t=1.70158;if((e/=1/2)<1)return 1/2*e*e*(((t*=1.525)+1)*e-t);return 1/2*((e-=2)*e*(((t*=1.525)+1)*e+t)+2)},easeInBounce:function(e){return 1-animationOptions.easeOutBounce(1-e)},easeOutBounce:function(e){if((e/=1)<1/2.75){return 1*7.5625*e*e}else if(e<2/2.75){return 1*(7.5625*(e-=1.5/2.75)*e+.75)}else if(e<2.5/2.75){return 1*(7.5625*(e-=2.25/2.75)*e+.9375)}else{return 1*(7.5625*(e-=2.625/2.75)*e+.984375)}},easeInOutBounce:function(e){if(e<1/2)return animationOptions.easeInBounce(e*2)*.5;return animationOptions.easeOutBounce(e*2-1)*.5+1*.5}};var width=context.canvas.width;var height=context.canvas.height;if(window.devicePixelRatio){context.canvas.style.width=width+"px";context.canvas.style.height=height+"px";context.canvas.height=height*window.devicePixelRatio;context.canvas.width=width*window.devicePixelRatio;context.scale(window.devicePixelRatio,window.devicePixelRatio)}this.PolarArea=function(e,t){chart.PolarArea.defaults={inGraphDataShow:false,inGraphDataPaddingRadius:5,inGraphDataPaddingAngle:0,inGraphDataTmpl:"<%=(v1 == ''? '' : v1+':')+ v2 + ' (' + v6 + ' %)'%>",inGraphDataAlign:"off-center",inGraphDataVAlign:"off-center",inGraphDataRotate:0,inGraphDataFontFamily:"'Arial'",inGraphDataFontSize:12,inGraphDataFontStyle:"normal",inGraphDataFontColor:"#666",inGraphDataRadiusPosition:3,inGraphDataAnglePosition:2,scaleOverlay:true,scaleOverride:false,scaleOverride2:false,scaleSteps:null,scaleStepWidth:null,scaleStartValue:null,scaleShowLine:true,scaleLineColor:"rgba(0,0,0,.1)",scaleLineWidth:1,scaleShowLabels:true,scaleShowLabels2:true,scaleLabel:"<%=value%>",scaleFontFamily:"'Arial'",scaleFontSize:12,scaleFontStyle:"normal",scaleFontColor:"#666",scaleShowLabelBackdrop:true,scaleBackdropColor:"rgba(255,255,255,0.75)",scaleBackdropPaddingY:2,scaleBackdropPaddingX:2,segmentShowStroke:true,segmentStrokeColor:"#fff",segmentStrokeWidth:2,animation:true,animationByData:"ByArc",animationSteps:100,animationEasing:"easeOutBounce",animateRotate:true,animateScale:false,onAnimationComplete:null,annotateLabel:"<%=(v1 == ''? '' : v1+':')+ v2 + ' (' + v6 + ' %)'%>",startAngle:90};chart.PolarArea.defaults=mergeChartConfig(chart.defaults.commonOptions,chart.PolarArea.defaults);chart.PolarArea.defaults=mergeChartConfig(chart.PolarArea.defaults,charJSPersonalDefaultOptions);chart.PolarArea.defaults=mergeChartConfig(chart.PolarArea.defaults,charJSPersonalDefaultOptionsPolarArea);var n=t?mergeChartConfig(chart.PolarArea.defaults,t):chart.PolarArea.defaults;return new PolarArea(e,n,context)};this.Radar=function(e,t){chart.Radar.defaults={inGraphDataShow:false,inGraphDataPaddingRadius:5,inGraphDataTmpl:"<%=v3%>",inGraphDataAlign:"off-center",inGraphDataVAlign:"off-center",inGraphDataRotate:0,inGraphDataFontFamily:"'Arial'",inGraphDataFontSize:12,inGraphDataFontStyle:"normal",inGraphDataFontColor:"#666",inGraphDataRadiusPosition:3,yAxisMinimumInterval:"none",scaleOverlay:false,scaleOverride:false,scaleOverride2:false,scaleSteps:null,scaleStepWidth:null,scaleStartValue:null,scaleShowLine:true,scaleLineColor:"rgba(0,0,0,.1)",scaleLineWidth:1,scaleShowLabels:false,scaleShowLabels2:true,scaleLabel:"<%=value%>",scaleFontFamily:"'Arial'",scaleFontSize:12,scaleFontStyle:"normal",scaleFontColor:"#666",scaleShowLabelBackdrop:true,scaleBackdropColor:"rgba(255,255,255,0.75)",scaleBackdropPaddingY:2,scaleBackdropPaddingX:2,angleShowLineOut:true,angleLineColor:"rgba(0,0,0,.1)",angleLineWidth:1,pointLabelFontFamily:"'Arial'",pointLabelFontStyle:"normal",pointLabelFontSize:12,pointLabelFontColor:"#666",pointDot:true,pointDotRadius:3,pointDotStrokeWidth:1,datasetFill:true,datasetStrokeWidth:2,animation:true,animationSteps:60,animationEasing:"easeOutQuart",onAnimationComplete:null,annotateLabel:"<%=(v1 == '' ? '' : v1) + (v1!='' && v2 !='' ? ' - ' : '')+(v2 == '' ? '' : v2)+(v1!='' || v2 !='' ? ':' : '') + v3%>",pointHitDetectionRadius:10,startAngle:90,graphMaximized:false};chart.Radar.defaults=mergeChartConfig(chart.defaults.commonOptions,chart.Radar.defaults);chart.Radar.defaults=mergeChartConfig(chart.Radar.defaults,charJSPersonalDefaultOptions);chart.Radar.defaults=mergeChartConfig(chart.Radar.defaults,charJSPersonalDefaultOptionsRadar);var n=t?mergeChartConfig(chart.Radar.defaults,t):chart.Radar.defaults;return new Radar(e,n,context)};this.Pie=function(e,t){chart.Pie.defaults={inGraphDataShow:false,inGraphDataPaddingRadius:5,inGraphDataPaddingAngle:0,inGraphDataTmpl:"<%=(v1 == ''? '' : v1+':')+ v2 + ' (' + v6 + ' %)'%>",inGraphDataAlign:"off-center",inGraphDataVAlign:"off-center",inGraphDataRotate:0,inGraphDataFontFamily:"'Arial'",inGraphDataFontSize:12,inGraphDataFontStyle:"normal",inGraphDataFontColor:"#666",inGraphDataRadiusPosition:3,inGraphDataAnglePosition:2,inGraphDataMinimumAngle:0,segmentShowStroke:true,segmentStrokeColor:"#fff",segmentStrokeWidth:2,animation:true,animationByData:false,animationSteps:100,animationEasing:"easeOutBounce",animateRotate:true,animateScale:false,onAnimationComplete:null,annotateLabel:"<%=(v1 == ''? '' : v1+':')+ v2 + ' (' + v6 + ' %)'%>",startAngle:90,radiusScale:1};chart.Pie.defaults=mergeChartConfig(chart.defaults.commonOptions,chart.Pie.defaults);chart.Pie.defaults=mergeChartConfig(chart.Pie.defaults,charJSPersonalDefaultOptions);chart.Pie.defaults=mergeChartConfig(chart.Pie.defaults,charJSPersonalDefaultOptionsPie);var n=t?mergeChartConfig(chart.Pie.defaults,t):chart.Pie.defaults;return new Pie(e,n,context)};this.Doughnut=function(e,t){chart.Doughnut.defaults={inGraphDataShow:false,inGraphDataPaddingRadius:5,inGraphDataPaddingAngle:0,inGraphDataTmpl:"<%=(v1 == ''? '' : v1+':')+ v2 + ' (' + v6 + ' %)'%>",inGraphDataAlign:"off-center",inGraphDataVAlign:"off-center",inGraphDataRotate:0,inGraphDataFontFamily:"'Arial'",inGraphDataFontSize:12,inGraphDataFontStyle:"normal",inGraphDataFontColor:"#666",inGraphDataRadiusPosition:3,inGraphDataAnglePosition:2,inGraphDataMinimumAngle:0,segmentShowStroke:true,segmentStrokeColor:"#fff",segmentStrokeWidth:2,percentageInnerCutout:50,animation:true,animationByData:false,animationSteps:100,animationEasing:"easeOutBounce",animateRotate:true,animateScale:false,onAnimationComplete:null,annotateLabel:"<%=(v1 == ''? '' : v1+':')+ v2 + ' (' + v6 + ' %)'%>",startAngle:90,radiusScale:1};chart.Doughnut.defaults=mergeChartConfig(chart.defaults.commonOptions,chart.Doughnut.defaults);chart.Doughnut.defaults=mergeChartConfig(chart.Doughnut.defaults,charJSPersonalDefaultOptions);chart.Doughnut.defaults=mergeChartConfig(chart.Doughnut.defaults,charJSPersonalDefaultOptionsDoughnut);var n=t?mergeChartConfig(chart.Doughnut.defaults,t):chart.Doughnut.defaults;return new Doughnut(e,n,context)};this.Line=function(e,t){chart.Line.defaults={inGraphDataShow:false,inGraphDataPaddingX:3,inGraphDataPaddingY:3,inGraphDataTmpl:"<%=v3%>",inGraphDataAlign:"left",inGraphDataVAlign:"bottom",inGraphDataRotate:0,inGraphDataFontFamily:"'Arial'",inGraphDataFontSize:12,inGraphDataFontStyle:"normal",inGraphDataFontColor:"#666",drawXScaleLine:[{position:"bottom"}],scaleOverlay:false,scaleOverride:false,scaleOverride2:false,scaleSteps:null,scaleStepWidth:null,scaleStartValue:null,scaleSteps2:null,scaleStepWidth2:null,scaleStartValue2:null,scaleLabel2:"<%=value%>",scaleLineColor:"rgba(0,0,0,.1)",scaleLineWidth:1,scaleShowLabels:true,scaleShowLabels2:true,scaleLabel:"<%=value%>",scaleFontFamily:"'Arial'",scaleFontSize:12,scaleFontStyle:"normal",scaleFontColor:"#666",scaleShowGridLines:true,scaleXGridLinesStep:1,scaleYGridLinesStep:1,scaleGridLineColor:"rgba(0,0,0,.05)",scaleGridLineWidth:1,showYAxisMin:true,rotateLabels:"smart",logarithmic:false,logarithmic2:false,scaleTickSizeLeft:5,scaleTickSizeRight:5,scaleTickSizeBottom:5,scaleTickSizeTop:5,bezierCurve:true,bezierCurveTension:.4,pointDot:true,pointDotRadius:4,pointDotStrokeWidth:2,datasetStrokeWidth:2,datasetFill:true,animation:true,animationSteps:60,animationEasing:"easeOutQuart",extrapolateMissingData:true,onAnimationComplete:null,annotateLabel:"<%=(v1 == '' ? '' : v1) + (v1!='' && v2 !='' ? ' - ' : '')+(v2 == '' ? '' : v2)+(v1!='' || v2 !='' ? ':' : '') + v3%>",pointHitDetectionRadius:10};chart.Line.defaults=mergeChartConfig(chart.defaults.commonOptions,chart.Line.defaults);chart.Line.defaults=mergeChartConfig(chart.defaults.xyAxisCommonOptions,chart.Line.defaults);chart.Line.defaults=mergeChartConfig(chart.Line.defaults,charJSPersonalDefaultOptions);chart.Line.defaults=mergeChartConfig(chart.Line.defaults,charJSPersonalDefaultOptionsLine);var n=t?mergeChartConfig(chart.Line.defaults,t):chart.Line.defaults;return new Line(e,n,context)};this.StackedBar=function(e,t){chart.StackedBar.defaults={inGraphDataShow:false,inGraphDataPaddingX:0,inGraphDataPaddingY:-3,inGraphDataTmpl:"<%=v3%>",inGraphDataAlign:"center",inGraphDataVAlign:"top",inGraphDataRotate:0,inGraphDataFontFamily:"'Arial'",inGraphDataFontSize:12,inGraphDataFontStyle:"normal",inGraphDataFontColor:"#666",inGraphDataXPosition:2,inGraphDataYPosition:3,scaleOverlay:false,scaleOverride:false,scaleOverride2:false,scaleSteps:null,scaleStepWidth:null,scaleStartValue:null,scaleLineColor:"rgba(0,0,0,.1)",scaleLineWidth:1,scaleShowLabels:true,scaleShowLabels2:true,scaleLabel:"<%=value%>",scaleFontFamily:"'Arial'",scaleFontSize:12,scaleFontStyle:"normal",scaleFontColor:"#666",scaleShowGridLines:true,scaleXGridLinesStep:1,scaleYGridLinesStep:1,scaleGridLineColor:"rgba(0,0,0,.05)",scaleGridLineWidth:1,showYAxisMin:true,rotateLabels:"smart",scaleTickSizeLeft:5,scaleTickSizeRight:5,scaleTickSizeBottom:5,scaleTickSizeTop:5,barShowStroke:true,barStrokeWidth:2,barValueSpacing:5,barDatasetSpacing:1,spaceBetweenBar:0,animation:true,animationSteps:60,animationEasing:"easeOutQuart",onAnimationComplete:null,annotateLabel:"<%=(v1 == '' ? '' : v1) + (v1!='' && v2 !='' ? ' - ' : '')+(v2 == '' ? '' : v2)+(v1!='' || v2 !='' ? ':' : '') + v3 + ' (' + v6 + ' %)'%>"};chart.StackedBar.defaults=mergeChartConfig(chart.defaults.commonOptions,chart.StackedBar.defaults);chart.StackedBar.defaults=mergeChartConfig(chart.defaults.xyAxisCommonOptions,chart.StackedBar.defaults);chart.StackedBar.defaults=mergeChartConfig(chart.StackedBar.defaults,charJSPersonalDefaultOptions);chart.StackedBar.defaults=mergeChartConfig(chart.StackedBar.defaults,charJSPersonalDefaultOptionsStackedBar);var n=t?mergeChartConfig(chart.StackedBar.defaults,t):chart.StackedBar.defaults;return new StackedBar(e,n,context)};this.HorizontalStackedBar=function(e,t){chart.HorizontalStackedBar.defaults={inGraphDataShow:false,inGraphDataPaddingX:-3,inGraphDataPaddingY:0,inGraphDataTmpl:"<%=v3%>",inGraphDataAlign:"right",inGraphDataVAlign:"middle",inGraphDataRotate:0,inGraphDataFontFamily:"'Arial'",inGraphDataFontSize:12,inGraphDataFontStyle:"normal",inGraphDataFontColor:"#666",inGraphDataXPosition:3,inGraphDataYPosition:2,scaleOverlay:false,scaleOverride:false,scaleOverride2:false,scaleSteps:null,scaleStepWidth:null,scaleStartValue:null,scaleLineColor:"rgba(0,0,0,.1)",scaleLineWidth:1,scaleShowLabels:true,scaleShowLabels2:true,scaleLabel:"<%=value%>",scaleFontFamily:"'Arial'",scaleFontSize:12,scaleFontStyle:"normal",scaleFontColor:"#666",scaleShowGridLines:true,scaleXGridLinesStep:1,scaleYGridLinesStep:1,scaleGridLineColor:"rgba(0,0,0,.05)",scaleGridLineWidth:1,scaleTickSizeLeft:5,scaleTickSizeRight:5,scaleTickSizeBottom:5,scaleTickSizeTop:5,showYAxisMin:true,rotateLabels:"smart",barShowStroke:true,barStrokeWidth:2,barValueSpacing:5,barDatasetSpacing:1,spaceBetweenBar:0,animation:true,animationSteps:60,animationEasing:"easeOutQuart",onAnimationComplete:null,annotateLabel:"<%=(v1 == '' ? '' : v1) + (v1!='' && v2 !='' ? ' - ' : '')+(v2 == '' ? '' : v2)+(v1!='' || v2 !='' ? ':' : '') + v3 + ' (' + v6 + ' %)'%>",reverseOrder:false};chart.HorizontalStackedBar.defaults=mergeChartConfig(chart.defaults.commonOptions,chart.HorizontalStackedBar.defaults);chart.HorizontalStackedBar.defaults=mergeChartConfig(chart.defaults.xyAxisCommonOptions,chart.HorizontalStackedBar.defaults);chart.HorizontalStackedBar.defaults=mergeChartConfig(chart.HorizontalStackedBar.defaults,charJSPersonalDefaultOptions);chart.HorizontalStackedBar.defaults=mergeChartConfig(chart.HorizontalStackedBar.defaults,charJSPersonalDefaultOptionsHorizontalStackedBar);var n=t?mergeChartConfig(chart.HorizontalStackedBar.defaults,t):chart.HorizontalStackedBar.defaults;return new HorizontalStackedBar(e,n,context)};this.Bar=function(e,t){chart.Bar.defaults={inGraphDataShow:false,inGraphDataPaddingX:0,inGraphDataPaddingY:3,inGraphDataTmpl:"<%=v3%>",inGraphDataAlign:"center",inGraphDataVAlign:"bottom",inGraphDataRotate:0,inGraphDataFontFamily:"'Arial'",inGraphDataFontSize:12,inGraphDataFontStyle:"normal",inGraphDataFontColor:"#666",inGraphDataXPosition:2,inGraphDataYPosition:3,scaleOverlay:false,scaleOverride:false,scaleOverride2:false,scaleSteps:null,scaleStepWidth:null,scaleStartValue:null,scaleSteps2:null,scaleStepWidth2:null,scaleStartValue2:null,scaleLineColor:"rgba(0,0,0,.1)",scaleLineWidth:1,scaleShowLabels:true,scaleShowLabels2:true,scaleLabel:"<%=value%>",scaleLabel2:"<%=value%>",scaleFontFamily:"'Arial'",scaleFontSize:12,scaleFontStyle:"normal",scaleFontColor:"#666",scaleShowGridLines:true,scaleXGridLinesStep:1,scaleYGridLinesStep:1,scaleGridLineColor:"rgba(0,0,0,.05)",scaleGridLineWidth:1,showYAxisMin:true,rotateLabels:"smart",logarithmic:false,logarithmic2:false,scaleTickSizeLeft:5,scaleTickSizeRight:5,scaleTickSizeBottom:5,scaleTickSizeTop:5,barShowStroke:true,barStrokeWidth:2,barValueSpacing:5,barDatasetSpacing:1,barBorderRadius:0,extrapolateMissingData:true,animation:true,animationSteps:60,animationEasing:"easeOutQuart",onAnimationComplete:null,pointDot:true,bezierCurve:true,bezierCurveTension:.4,annotateLabel:"<%=(v1 == '' ? '' : v1) + (v1!='' && v2 !='' ? ' - ' : '')+(v2 == '' ? '' : v2)+(v1!='' || v2 !='' ? ':' : '') + v3 + ' (' + v6 + ' %)'%>"};chart.Bar.defaults=mergeChartConfig(chart.defaults.commonOptions,chart.Bar.defaults);chart.Bar.defaults=mergeChartConfig(chart.defaults.xyAxisCommonOptions,chart.Bar.defaults);chart.Bar.defaults=mergeChartConfig(chart.Bar.defaults,charJSPersonalDefaultOptions);chart.Bar.defaults=mergeChartConfig(chart.Bar.defaults,charJSPersonalDefaultOptionsBar);var n=t?mergeChartConfig(chart.Bar.defaults,t):chart.Bar.defaults;return new Bar(e,n,context)};this.HorizontalBar=function(e,t){chart.HorizontalBar.defaults={inGraphDataShow:false,inGraphDataPaddingX:3,inGraphDataPaddingY:0,inGraphDataTmpl:"<%=v3%>",inGraphDataAlign:"left",inGraphDataVAlign:"middle",inGraphDataRotate:0,inGraphDataFontFamily:"'Arial'",inGraphDataFontSize:12,inGraphDataFontStyle:"normal",inGraphDataFontColor:"#666",inGraphDataXPosition:3,inGraphDataYPosition:2,scaleOverlay:false,scaleOverride:false,scaleOverride2:false,scaleSteps:null,scaleStepWidth:null,scaleStartValue:null,scaleLineColor:"rgba(0,0,0,.1)",scaleLineWidth:1,scaleShowLabels:true,scaleShowLabels2:true,scaleLabel:"<%=value%>",scaleFontFamily:"'Arial'",scaleFontSize:12,scaleFontStyle:"normal",scaleFontColor:"#666",scaleShowGridLines:true,scaleXGridLinesStep:1,scaleYGridLinesStep:1,scaleGridLineColor:"rgba(0,0,0,.05)",scaleGridLineWidth:1,scaleTickSizeLeft:5,scaleTickSizeRight:5,scaleTickSizeBottom:5,scaleTickSizeTop:5,showYAxisMin:true,rotateLabels:"smart",barShowStroke:true,barStrokeWidth:2,barValueSpacing:5,barDatasetSpacing:1,barBorderRadius:0,animation:true,animationSteps:60,animationEasing:"easeOutQuart",onAnimationComplete:null,annotateLabel:"<%=(v1 == '' ? '' : v1) + (v1!='' && v2 !='' ? ' - ' : '')+(v2 == '' ? '' : v2)+(v1!='' || v2 !='' ? ':' : '') + v3 + ' (' + v6 + ' %)'%>",reverseOrder:false};chart.HorizontalBar.defaults=mergeChartConfig(chart.defaults.commonOptions,chart.HorizontalBar.defaults);chart.HorizontalBar.defaults=mergeChartConfig(chart.defaults.xyAxisCommonOptions,chart.HorizontalBar.defaults);chart.HorizontalBar.defaults=mergeChartConfig(chart.HorizontalBar.defaults,charJSPersonalDefaultOptions);chart.HorizontalBar.defaults=mergeChartConfig(chart.HorizontalBar.defaults,charJSPersonalDefaultOptionsHorizontalBar);var n=t?mergeChartConfig(chart.HorizontalBar.defaults,t):chart.HorizontalBar.defaults;return new HorizontalBar(e,n,context)};chart.defaults={};chart.defaults.commonOptions={multiGraph:false,clearRect:true,dynamicDisplay:false,graphSpaceBefore:5,graphSpaceAfter:5,canvasBorders:false,canvasBackgroundColor:"none",canvasBordersWidth:3,canvasBordersColor:"black",zeroValue:1e-10,graphTitle:"",graphTitleFontFamily:"'Arial'",graphTitleFontSize:24,graphTitleFontStyle:"bold",graphTitleFontColor:"#666",graphTitleSpaceBefore:5,graphTitleSpaceAfter:5,graphSubTitle:"",graphSubTitleFontFamily:"'Arial'",graphSubTitleFontSize:18,graphSubTitleFontStyle:"normal",graphSubTitleFontColor:"#666",graphSubTitleSpaceBefore:5,graphSubTitleSpaceAfter:5,footNote:"",footNoteFontFamily:"'Arial'",footNoteFontSize:8,footNoteFontStyle:"bold",footNoteFontColor:"#666",footNoteSpaceBefore:5,footNoteSpaceAfter:5,legend:false,showSingleLegend:false,maxLegendCols:999,legendPosY:4,legendPosX:-2,legendFontFamily:"'Arial'",legendFontSize:12,legendFontStyle:"normal",legendFontColor:"#666",legendBlockSize:15,legendBorders:true,legendBordersWidth:1,legendBordersColors:"#666",legendBordersSpaceBefore:5,legendBordersSpaceAfter:5,legendBordersSpaceLeft:5,legendBordersSpaceRight:5,legendSpaceBeforeText:5,legendSpaceAfterText:5,legendSpaceLeftText:5,legendSpaceRightText:5,legendSpaceBetweenTextVertical:5,legendSpaceBetweenTextHorizontal:5,legendSpaceBetweenBoxAndText:5,legendFillColor:"rgba(0,0,0,0)",legendXPadding:0,legendYPadding:0,annotateDisplay:false,savePng:false,savePngOutput:"NewWindow",savePngFunction:"mousedown right",savePngBackgroundColor:"WHITE",annotateFunction:"mousemove",annotateFontFamily:"'Arial'",annotateBorder:"none",annotateBorderRadius:"2px",annotateBackgroundColor:"rgba(0,0,0,0.8)",annotateFontSize:12,annotateFontColor:"white",annotateFontStyle:"normal",annotatePadding:"3px",annotateClassName:"",crossText:[""],crossTextIter:["all"],crossTextOverlay:[true],crossTextFontFamily:["'Arial'"],crossTextFontSize:[12],crossTextFontStyle:["normal"],crossTextFontColor:["rgba(220,220,220,1)"],crossTextRelativePosX:[2],crossTextRelativePosY:[2],crossTextBaseline:["middle"],crossTextAlign:["center"],crossTextPosX:[0],crossTextPosY:[0],crossTextAngle:[0],crossTextFunction:null,crossImage:[undefined],crossImageIter:["all"],crossImageOverlay:[true],crossImageRelativePosX:[2],crossImageRelativePosY:[2],crossImageBaseline:["middle"],crossImageAlign:["center"],crossImagePosX:[0],crossImagePosY:[0],crossImageAngle:[0],spaceTop:0,spaceBottom:0,spaceRight:0,spaceLeft:0,decimalSeparator:".",thousandSeparator:"",roundNumber:"none",roundPct:-1,fmtV1:"none",fmtV2:"none",fmtV3:"none",fmtV4:"none",fmtV5:"none",fmtV6:"none",fmtV7:"none",fmtV8:"none",fmtV9:"none",fmtV10:"none",fmtV11:"none",fmtV12:"none",fmtV13:"none",fmtXLabel:"none",fmtYLabel:"none",fmtYLabel2:"none",fmtLegend:"none",animationStartValue:0,animationStopValue:1,animationCount:1,animationPauseTime:5,animationBackward:false,animationStartWithDataset:1,animationStartWithData:1,animationLeftToRight:false,animationByDataset:false,defaultStrokeColor:"rgba(220,220,220,1)",defaultFillColor:"rgba(220,220,220,0.5)",defaultLineWidth:2,mouseDownRight:null,mouseDownLeft:null,mouseDownMiddle:null,mouseMove:null,mouseOut:null,mouseWheel:null,savePngName:"canvas",responsive:false,responsiveMinWidth:0,responsiveMinHeight:0,responsiveMaxWidth:9999999,responsiveMaxHeight:9999999,maintainAspectRatio:true,pointMarker:"circle"};chart.defaults.xyAxisCommonOptions={yAxisMinimumInterval:"none",yAxisMinimumInterval2:"none",yScaleLabelsMinimumWidth:0,xScaleLabelsMinimumWidth:0,yAxisLeft:true,yAxisRight:false,xAxisBottom:true,xAxisTop:false,xAxisSpaceBetweenLabels:5,fullWidthGraph:false,yAxisLabel:"",yAxisLabel2:"",yAxisFontFamily:"'Arial'",yAxisFontSize:16,yAxisFontStyle:"normal",yAxisFontColor:"#666",yAxisLabelSpaceRight:5,yAxisLabelSpaceLeft:5,yAxisSpaceRight:5,yAxisSpaceLeft:5,xAxisLabel:"",xAxisFontFamily:"'Arial'",xAxisFontSize:16,xAxisFontStyle:"normal",xAxisFontColor:"#666",xAxisLabelSpaceBefore:5,xAxisLabelSpaceAfter:5,xAxisSpaceBefore:5,xAxisSpaceAfter:5,yAxisUnit:"",yAxisUnit2:"",yAxisUnitFontFamily:"'Arial'",yAxisUnitFontSize:8,yAxisUnitFontStyle:"normal",yAxisUnitFontColor:"#666",yAxisUnitSpaceBefore:5,yAxisUnitSpaceAfter:5};var clear=function(e){e.clearRect(0,0,width,height)};var PolarArea=function(e,t,n){function g(r){for(var o=0;o<e.length;o++){var u=1,a=1;if(t.animation){if(t.animateScale){u=r}if(t.animateRotate){a=r}}correctedRotateAnimation=animationCorrection(a,e,t,o,-1,0).mainVal;if(!(typeof e[o].value=="undefined")){n.beginPath();if(t.animationByData=="ByArc"){endAngle=p[o].startAngle+correctedRotateAnimation*p[o].segmentAngle;n.arc(c,h,u*p[o].radiusOffset,p[o].startAngle,endAngle,false)}else if(t.animationByData){if(p[o].startAngle-p[o].firstAngle<correctedRotateAnimation*2*Math.PI){endAngle=p[o].endAngle;if(p[o].endAngle-p[o].firstAngle>correctedRotateAnimation*2*Math.PI)endAngle=p[o].firstAngle+correctedRotateAnimation*2*Math.PI;n.arc(c,h,u*p[o].radiusOffset,p[o].startAngle,endAngle,false)}else continue}else{n.arc(c,h,u*p[o].radiusOffset,p[o].firstAngle+correctedRotateAnimation*(p[o].startAngle-p[o].firstAngle),p[o].firstAngle+correctedRotateAnimation*(p[o].endAngle-p[o].firstAngle))}n.lineTo(c,h);n.closePath();n.fillStyle=setOptionValue("COLOR",n,e,p,e[o].color,t.defaultFillColor,o,-1,{animationDecimal:r,scaleAnimation:u});n.fill();if(t.segmentShowStroke){n.strokeStyle=t.segmentStrokeColor;n.lineWidth=t.segmentStrokeWidth;n.stroke()}}}if(r>=t.animationStopValue){for(var o=0;o<e.length;o++){if(typeof e[o].value=="undefined")continue;if(setOptionValue("ANNOTATEDISPLAY",n,e,p,undefined,t.annotateDisplay,o,-1,{nullValue:true})){jsGraphAnnotate[n.ChartNewId][jsGraphAnnotate[n.ChartNewId].length]=["ARC",o,-1,p]}if(setOptionValue("INGRAPHDATASHOW",n,e,p,undefined,t.inGraphDataShow,o,-1,{nullValue:true})){if(setOptionValue("INGRAPHDATAANGLEPOSITION",n,e,p,undefined,t.inGraphDataAnglePosition,o,-1,{nullValue:true})==1)posAngle=p[o].realStartAngle+setOptionValue("INGRAPHDATAPADDINANGLE",n,e,p,undefined,t.inGraphDataPaddingAngle,o,-1,{nullValue:true})*(Math.PI/180);else if(setOptionValue("INGRAPHDATAANGLEPOSITION",n,e,p,undefined,t.inGraphDataAnglePosition,o,-1,{nullValue:true})==2)posAngle=(2*p[o].realStartAngle-p[o].segmentAngle)/2+setOptionValue("INGRAPHDATAPADDINANGLE",n,e,p,undefined,t.inGraphDataPaddingAngle,o,-1,{nullValue:true})*(Math.PI/180);else if(setOptionValue("INGRAPHDATAANGLEPOSITION",n,e,p,undefined,t.inGraphDataAnglePosition,o,-1,{nullValue:true})==3)posAngle=p[o].realStartAngle-p[o].segmentAngle+setOptionValue("INGRAPHDATAPADDINANGLE",n,e,p,undefined,t.inGraphDataPaddingAngle,o,-1,{nullValue:true})*(Math.PI/180);if(setOptionValue("INGRAPHDATARADIUSPOSITION",n,e,p,undefined,t.inGraphDataRadiusPosition,o,-1,{nullValue:true})==1)labelRadius=0+setOptionValue("INGRAPHDATAPADDINGRADIUS",n,e,p,undefined,t.inGraphDataPaddingRadius,o,-1,{nullValue:true});else if(setOptionValue("INGRAPHDATARADIUSPOSITION",n,e,p,undefined,t.inGraphDataRadiusPosition,o,-1,{nullValue:true})==2)labelRadius=p[o].radiusOffset/2+setOptionValue("INGRAPHDATAPADDINGRADIUS",n,e,p,undefined,t.inGraphDataPaddingRadius,o,-1,{nullValue:true});else if(setOptionValue("INGRAPHDATARADIUSPOSITION",n,e,p,undefined,t.inGraphDataRadiusPosition,o,-1,{nullValue:true})==3)labelRadius=p[o].radiusOffset+setOptionValue("INGRAPHDATAPADDINGRADIUS",n,e,p,undefined,t.inGraphDataPaddingRadius,o,-1,{nullValue:true});else if(setOptionValue("INGRAPHDATARADIUSPOSITION",n,e,p,undefined,t.inGraphDataRadiusPosition,o,-1,{nullValue:true})==4)labelRadius=i*s.steps+setOptionValue("INGRAPHDATAPADDINGRADIUS",n,e,p,undefined,t.inGraphDataPaddingRadius,o,-1,{nullValue:true});n.save();if(setOptionValue("INGRAPHDATAALIGN",n,e,p,undefined,t.inGraphDataAlign,o,-1,{nullValue:true})=="off-center"){if(setOptionValue("INGRAPHDATAROTATE",n,e,p,undefined,t.inGraphDataRotate,o,-1,{nullValue:true})=="inRadiusAxis"||(posAngle+2*Math.PI)%(2*Math.PI)>3*Math.PI/2||(posAngle+2*Math.PI)%(2*Math.PI)<Math.PI/2)n.textAlign="left";else n.textAlign="right"}else if(setOptionValue("INGRAPHDATAALIGN",n,e,p,undefined,t.inGraphDataAlign,o,-1,{nullValue:true})=="to-center"){if(setOptionValue("INGRAPHDATAROTATE",n,e,p,undefined,t.inGraphDataRotate,o,-1,{nullValue:true})=="inRadiusAxis"||(posAngle+2*Math.PI)%(2*Math.PI)>3*Math.PI/2||(posAngle+2*Math.PI)%(2*Math.PI)<Math.PI/2)n.textAlign="right";else n.textAlign="left"}else n.textAlign=setOptionValue("INGRAPHDATAALIGN",n,e,p,undefined,t.inGraphDataAlign,o,-1,{nullValue:true});if(setOptionValue("INGRAPHDATAVALIGN",n,e,p,undefined,t.inGraphDataVAlign,o,-1,{nullValue:true})=="off-center"){if((posAngle+2*Math.PI)%(2*Math.PI)>Math.PI)n.textBaseline="top";else n.textBaseline="bottom"}else if(setOptionValue("INGRAPHDATAVALIGN",n,e,p,undefined,t.inGraphDataVAlign,o,-1,{nullValue:true})=="to-center"){if((posAngle+2*Math.PI)%(2*Math.PI)>Math.PI)n.textBaseline="bottom";else n.textBaseline="top"}else n.textBaseline=setOptionValue("INGRAPHDATAVALIGN",n,e,p,undefined,t.inGraphDataVAlign,o,-1,{nullValue:true});n.font=setOptionValue("INGRAPHDATAFONTSTYLE",n,e,p,undefined,t.inGraphDataFontStyle,o,-1,{nullValue:true})+" "+setOptionValue("INGRAPHDATAFONTSIZE",n,e,p,undefined,t.inGraphDataFontSize,o,-1,{nullValue:true})+"px "+setOptionValue("INGRAPHDATAFONTFAMILY",n,e,p,undefined,t.inGraphDataFontFamily,o,-1,{nullValue:true});n.fillStyle=setOptionValue("INGRAPHDATAFONTCOLOR",n,e,p,undefined,t.inGraphDataFontColor,o,-1,{nullValue:true});var f=tmplbis(setOptionValue("INGRAPHDATATMPL",n,e,p,undefined,t.inGraphDataTmpl,o,-1,{nullValue:true}),p[o]);n.translate(c+labelRadius*Math.cos(posAngle),h-labelRadius*Math.sin(posAngle));if(setOptionValue("INGRAPHDATAROTATE",n,e,p,undefined,t.inGraphDataRotate,o,-1,{nullValue:true})=="inRadiusAxis")n.rotate(2*Math.PI-posAngle);else if(setOptionValue("INGRAPHDATAROTATE",n,e,p,undefined,t.inGraphDataRotate,o,-1,{nullValue:true})=="inRadiusAxisRotateLabels"){if((posAngle+2*Math.PI)%(2*Math.PI)>Math.PI/2&&(posAngle+2*Math.PI)%(2*Math.PI)<3*Math.PI/2)n.rotate(3*Math.PI-posAngle);else n.rotate(2*Math.PI-posAngle)}else n.rotate(setOptionValue("INGRAPHDATAROTATE",n,e,p,undefined,t.inGraphDataRotate,o,-1,{nullValue:true})*(Math.PI/180));n.fillTextMultiLine(f,0,0,n.textBaseline,setOptionValue("INGRAPHDATAFONTSIZE",n,e,p,undefined,t.inGraphDataFontSize,o,-1,{nullValue:true}),true);n.restore()}}}if(l.legendMsr.dispLegend)drawLegend(l.legendMsr,e,t,n,"PolarArea")}function y(){for(var e=0;e<s.steps;e++){if(t.scaleShowLine){n.beginPath();n.arc(c,h,i*(e+1),0,Math.PI*2,true);n.strokeStyle=t.scaleLineColor;n.lineWidth=t.scaleLineWidth;n.stroke()}if(t.scaleShowLabels){n.textAlign="center";n.font=t.scaleFontStyle+" "+t.scaleFontSize+"px "+t.scaleFontFamily;var r=s.labels[e+1];if(t.scaleShowLabelBackdrop){var o=n.measureTextMultiLine(r,t.scaleFontSize).textWidth;n.fillStyle=t.scaleBackdropColor;n.beginPath();n.rect(Math.round(c-o/2-t.scaleBackdropPaddingX),Math.round(h-i*(e+1)-t.scaleFontSize*.5-t.scaleBackdropPaddingY),Math.round(o+t.scaleBackdropPaddingX*2),Math.round(t.scaleFontSize+t.scaleBackdropPaddingY*2));n.fill()}n.textBaseline="middle";n.fillStyle=t.scaleFontColor;n.fillTextMultiLine(r,c,h-i*(e+1),n.textBaseline,t.scaleFontSize,true)}}}function b(){var r=-Number.MAX_VALUE;var i=Number.MAX_VALUE;for(var s=0;s<e.length;s++){if(typeof e[s].value=="undefined")continue;if(1*e[s].value>r){r=1*e[s].value}if(1*e[s].value<i){i=1*e[s].value}}if(r<i){r=0;i=0}if(Math.abs(r-i)<t.zeroValue){if(Math.abs(r)<t.zeroValue)r=.9;if(r>0){r=r*1.1;i=i*.9}else{r=r*.9;i=i*1.1}}if(typeof t.graphMin=="function")i=setOptionValue("GRAPHMIN",n,e,p,undefined,t.graphMin,-1,-1,{nullValue:true});else if(!isNaN(t.graphMin))i=t.graphMin;if(typeof t.graphMax=="function")r=setOptionValue("GRAPHMAX",n,e,p,undefined,t.graphMax,-1,-1,{nullValue:true});else if(!isNaN(t.graphMax))r=t.graphMax;var a=Math.floor(u/(o*.66));var f=Math.floor(u/o*.5);return{maxValue:r,minValue:i,maxSteps:a,minSteps:f}}var r,i,s,o,u,a,f,l,c,h;n.tpchart="PolarArea";if(!init_and_start(n,e,t))return;var p=initPassVariableData_part1(e,t,n);a=b();t.logarithmic=false;t.logarithmic2=false;f=t.scaleShowLabels?t.scaleLabel:"";if(!t.scaleOverride){s=calculateScale(1,t,a.maxSteps,a.minSteps,a.maxValue,a.minValue,f);l=setMeasures(e,t,n,height,width,s.labels,null,true,false,false,false,true,"PolarArea")}else{var d=setOptionValue("SCALESTARTVALUE",n,e,p,undefined,t.scaleStartValue,-1,-1,{nullValue:true});var v=setOptionValue("SCALESTEPS",n,e,p,undefined,t.scaleSteps,-1,-1,{nullValue:true});var m=setOptionValue("SCALESTEPWIDTH",n,e,p,undefined,t.scaleStepWidth,-1,-1,{nullValue:true});s={steps:v,stepValue:m,graphMin:d,graphMax:d+v*m,labels:[]};populateLabels(1,t,f,s.labels,s.steps,d,s.graphMax,m);l=setMeasures(e,t,n,height,width,s.labels,null,true,false,false,false,true,"PolarArea")}c=l.leftNotUsableSize+l.availableWidth/2;h=l.topNotUsableSize+l.availableHeight/2;i=Math.floor((Min([l.availableHeight,l.availableWidth])/2-5)/s.steps);if(i>0){initPassVariableData_part2(p,e,t,n,{midPosX:c,midPosY:h,int_radius:0,ext_radius:i*s.steps,calculatedScale:s,scaleHop:i});animationLoop(t,y,g,n,l.clrx,l.clry,l.clrwidth,l.clrheight,c,h,c-(Min([l.availableHeight,l.availableWidth])/2-5),h+(Min([l.availableHeight,l.availableWidth])/2-5),e)}else{testRedraw(n,e,t)}};var Radar=function(e,t,n){function g(r){var i=2*Math.PI/e.datasets[0].data.length;n.save();for(var s=0;s<e.datasets.length;s++){var o=-1;for(var u=0;u<e.datasets[s].data.length;u++){var a=animationCorrection(r,e,t,s,u,1).animVal;if(a>1)a=a-1;if(!(typeof e.datasets[s].data[u]=="undefined")){if(o==-1){n.beginPath();n.moveTo(c+a*p[s][u].offsetX,h-a*p[s][u].offsetY);o=u}else{n.lineTo(c+a*p[s][u].offsetX,h-a*p[s][u].offsetY)}}}n.closePath();if(t.datasetFill){n.fillStyle=setOptionValue("COLOR",n,e,p,e.datasets[s].fillColor,t.defaultFillColor,s,-1,{animationValue:a,midPosX:p[s][0].midPosX,midPosY:p[s][0].midPosY,ext_radius:(t.animationLeftToRight?1:a)*p[s][0].calculated_offset_max})}else n.fillStyle="rgba(0,0,0,0)";n.strokeStyle=setOptionValue("STROKECOLOR",n,e,p,e.datasets[s].strokeColor,t.defaultStrokeColor,s,-1,{nullvalue:null});n.lineWidth=t.datasetStrokeWidth;n.fill();n.stroke();if(t.pointDot&&(!t.animationLeftToRight||t.animationLeftToRight&&r>=1)){n.beginPath();n.fillStyle=setOptionValue("MARKERFILLCOLOR",n,e,p,e.datasets[s].pointColor,t.defaultStrokeColor,s,-1,{nullvalue:true});n.strokeStyle=setOptionValue("MARKERSTROKESTYLE",n,e,p,e.datasets[s].pointStrokeColor,t.defaultStrokeColor,s,-1,{nullvalue:true});n.lineWidth=setOptionValue("MARKERLINEWIDTH",n,e,p,e.datasets[s].pointDotStrokeWidth,t.pointDotStrokeWidth,s,-1,{nullvalue:true});for(var f=0;f<e.datasets[s].data.length;f++){if(!(typeof e.datasets[s].data[f]=="undefined")){n.beginPath();var d=setOptionValue("MARKERSHAPE",n,e,p,e.datasets[s].markerShape,t.markerShape,s,u,{nullvalue:true});var v=setOptionValue("MARKERRADIUS",n,e,p,e.datasets[s].pointDotRadius,t.pointDotRadius,s,u,{nullvalue:true});drawMarker(n,c+a*p[s][f].offsetX,h-a*p[s][f].offsetY,d,v)}}}}n.restore();if(r>=t.animationStopValue){for(var s=0;s<e.datasets.length;s++){for(var u=0;u<e.datasets[s].data.length;u++){if(typeof e.datasets[s].data[u]=="undefined")continue;if(setOptionValue("ANNOTATEDISPLAY",n,e,p,undefined,t.annotateDisplay,s,u,{nullValue:true})){jsGraphAnnotate[n.ChartNewId][jsGraphAnnotate[n.ChartNewId].length]=["POINT",s,u,p]}if(setOptionValue("INGRAPHDATASHOW",n,e,p,undefined,t.inGraphDataShow,s,u,{nullValue:true})){n.save();n.beginPath();n.textAlign=setOptionValue("INGRAPHDATAALIGN",n,e,p,undefined,t.inGraphDataAlign,s,-1,{nullValue:true});n.textBaseline=setOptionValue("INGRAPHDATAVALIGN",n,e,p,undefined,t.inGraphDataVAlign,s,-1,{nullValue:true});if(setOptionValue("INGRAPHDATAALIGN",n,e,p,undefined,t.inGraphDataAlign,s,-1,{nullValue:true})=="off-center"){if(setOptionValue("INGRAPHDATAROTATE",n,e,p,undefined,t.inGraphDataRotate,s,-1,{nullValue:true})=="inRadiusAxis"||(t.startAngle*Math.PI/180-u*i+4*Math.PI)%(2*Math.PI)>3*Math.PI/2||(t.startAngle*Math.PI/180-u*i+4*Math.PI)%(2*Math.PI)<=Math.PI/2)n.textAlign="left";else n.textAlign="right"}else if(setOptionValue("INGRAPHDATAALIGN",n,e,p,undefined,t.inGraphDataAlign,s,-1,{nullValue:true})=="to-center"){if(setOptionValue("INGRAPHDATAROTATE",n,e,p,undefined,t.inGraphDataRotate,s,-1,{nullValue:true})=="inRadiusAxis"||(t.startAngle*Math.PI/180-u*i+4*Math.PI)%(2*Math.PI)>3*Math.PI/2||(t.startAngle*Math.PI/180-u*i+4*Math.PI)%(2*Math.PI)<Math.PI/2)n.textAlign="right";else n.textAlign="left"}else n.textAlign=setOptionValue("INGRAPHDATAALIGN",n,e,p,undefined,t.inGraphDataAlign,s,-1,{nullValue:true});if(setOptionValue("INGRAPHDATAVALIGN",n,e,p,undefined,t.inGraphDataVAlign,s,-1,{nullValue:true})=="off-center"){if((t.startAngle*Math.PI/180-u*i+4*Math.PI)%(2*Math.PI)>Math.PI)n.textBaseline="bottom";else n.textBaseline="top"}else if(setOptionValue("INGRAPHDATAVALIGN",n,e,p,undefined,t.inGraphDataVAlign,s,-1,{nullValue:true})=="to-center"){if((t.startAngle*Math.PI/180-u*i+4*Math.PI)%(2*Math.PI)>Math.PI)n.textBaseline="top";else n.textBaseline="bottom"}else n.textBaseline=setOptionValue("INGRAPHDATAVALIGN",n,e,p,undefined,t.inGraphDataVAlign,s,-1,{nullValue:true});n.font=setOptionValue("INGRAPHDATAFONTSTYLE",n,e,p,undefined,t.inGraphDataFontStyle,s,-1,{nullValue:true})+" "+setOptionValue("INGRAPHDATAFONTSIZE",n,e,p,undefined,t.inGraphDataFontSize,s,-1,{nullValue:true})+"px "+setOptionValue("INGRAPHDATAFONTFAMILY",n,e,p,undefined,t.inGraphDataFontFamily,s,-1,{nullValue:true});n.fillStyle=setOptionValue("INGRAPHDATAFONTCOLOR",n,e,p,undefined,t.inGraphDataFontColor,s,-1,{nullValue:true});var m;if(setOptionValue("INGRAPHDATARADIUSPOSITION",n,e,p,undefined,t.inGraphDataRadiusPosition,s,-1,{nullValue:true})==1)m=0+setOptionValue("INGRAPHDATAPADDINGRADIUS",n,e,p,undefined,t.inGraphDataPaddingRadius,s,-1,{nullValue:true});else if(setOptionValue("INGRAPHDATARADIUSPOSITION",n,e,p,undefined,t.inGraphDataRadiusPosition,s,-1,{nullValue:true})==2)m=p[s][u].calculated_offset/2+setOptionValue("INGRAPHDATAPADDINGRADIUS",n,e,p,undefined,t.inGraphDataPaddingRadius,s,-1,{nullValue:true});else if(setOptionValue("INGRAPHDATARADIUSPOSITION",n,e,p,undefined,t.inGraphDataRadiusPosition,s,-1,{nullValue:true})==3)m=p[s][u].calculated_offset+setOptionValue("INGRAPHDATAPADDINGRADIUS",n,e,p,undefined,t.inGraphDataPaddingRadius,s,-1,{nullValue:true});if(p[s][u].calculated_offset>0){n.translate(c+p[s][u].offsetX*(m/p[s][u].calculated_offset),h-p[s][u].offsetY*(m/p[s][u].calculated_offset))}else{n.translate(c,h)}if(setOptionValue("INGRAPHDATAROTATE",n,e,p,undefined,t.inGraphDataRotate,s,-1,{nullValue:true})=="inRadiusAxis")n.rotate(u*i);else if(setOptionValue("INGRAPHDATAROTATE",n,e,p,undefined,t.inGraphDataRotate,s,-1,{nullValue:true})=="inRadiusAxisRotateLabels"){if((u*i+2*Math.PI)%(2*Math.PI)>Math.PI/2&&(u*i+2*Math.PI)%(2*Math.PI)<3*Math.PI/2)n.rotate(3*Math.PI+u*i);else n.rotate(2*Math.PI+u*i)}else n.rotate(setOptionValue("INGRAPHDATAROTATE",n,e,p,undefined,t.inGraphDataRotate,s,-1,{nullValue:true})*(Math.PI/180));var g=tmplbis(setOptionValue("INGRAPHDATATMPL",n,e,p,undefined,t.inGraphDataTmpl,s,-1,{nullValue:true}),p[s][u]);n.fillTextMultiLine(g,0,0,n.textBaseline,setOptionValue("INGRAPHDATAFONTSIZE",n,e,p,undefined,t.inGraphDataFontSize,s,-1,{nullValue:true}),true);n.restore()}}}}if(l.legendMsr.dispLegend)drawLegend(l.legendMsr,e,t,n,"Radar")}function y(){var o=2*Math.PI/e.datasets[0].data.length;n.save();n.translate(c,h);n.rotate((90-t.startAngle)*Math.PI/180);if(t.angleShowLineOut){n.strokeStyle=t.angleLineColor;n.lineWidth=t.angleLineWidth;for(var u=0;u<e.datasets[0].data.length;u++){n.rotate(o);n.beginPath();n.moveTo(0,0);n.lineTo(0,-r);n.stroke()}}for(var a=0;a<s.steps;a++){n.beginPath();if(t.scaleShowLine){n.strokeStyle=t.scaleLineColor;n.lineWidth=t.scaleLineWidth;n.moveTo(0,-i*(a+1));for(var f=0;f<e.datasets[0].data.length;f++){n.rotate(o);n.lineTo(0,-i*(a+1))}n.closePath();n.stroke()}}n.rotate(-(90-t.startAngle)*Math.PI/180);if(t.scaleShowLabels){for(var a=0;a<s.steps;a++){n.textAlign="center";n.font=t.scaleFontStyle+" "+t.scaleFontSize+"px "+t.scaleFontFamily;n.textBaseline="middle";if(t.scaleShowLabelBackdrop){var l=n.measureTextMultiLine(s.labels[a+1],t.scaleFontSize).textWidth;n.fillStyle=t.scaleBackdropColor;n.beginPath();n.rect(Math.round(Math.cos(t.startAngle*Math.PI/180)*i*(a+1)-l/2-t.scaleBackdropPaddingX),Math.round(-Math.sin(t.startAngle*Math.PI/180)*i*(a+1)-t.scaleFontSize*.5-t.scaleBackdropPaddingY),Math.round(l+t.scaleBackdropPaddingX*2),Math.round(t.scaleFontSize+t.scaleBackdropPaddingY*2));n.fill()}n.fillStyle=t.scaleFontColor;n.fillTextMultiLine(s.labels[a+1],Math.cos(t.startAngle*Math.PI/180)*i*(a+1),-Math.sin(t.startAngle*Math.PI/180)*i*(a+1),n.textBaseline,t.scaleFontSize,true)}}for(var p=0;p<e.labels.length;p++){n.font=t.pointLabelFontStyle+" "+t.pointLabelFontSize+"px "+t.pointLabelFontFamily;n.fillStyle=t.pointLabelFontColor;var d=Math.sin((90-t.startAngle)*Math.PI/180+o*p)*(r+t.pointLabelFontSize);var v=Math.cos((90-t.startAngle)*Math.PI/180+o*p)*(r+t.pointLabelFontSize);var m=(90-t.startAngle)*Math.PI/180+o*p;while(m<0)m=m+2*Math.PI;while(m>2*Math.PI)m=m-2*Math.PI;if(m==Math.PI||m==0){n.textAlign="center"}else if(m>Math.PI){n.textAlign="right"}else{n.textAlign="left"}n.textBaseline="middle";n.fillTextMultiLine(e.labels[p],d,-v,n.textBaseline,t.pointLabelFontSize,true)}n.restore()}function b(){var i,s,u,a,f,h,p,d;var v=2*Math.PI/e.datasets[0].data.length;var m=t.startAngle*Math.PI/180;n.font=t.pointLabelFontStyle+" "+t.pointLabelFontSize+"px "+t.pointLabelFontFamily;if(!t.graphMaximized){a=l.availableWidth/2;u=l.availableWidth/2;h=1}else{a=l.availableWidth/2;u=l.availableWidth/2;h=40;for(var g=0;g<e.labels.length;g++){var y=n.measureTextMultiLine(e.labels[g],t.scaleFontSize).textWidth+n.measureTextMultiLine(e.labels[g],t.scaleFontSize).textHeight;s=(l.availableWidth-y)/(1+Math.abs(Math.cos(m)));if(m<Math.PI/2&&m>-Math.PI/2||m>3*Math.PI/2){if(s<a)a=s}else if(Math.cos(m)!=0){if(s<u)u=s}m-=v}}p=0;d=0;c=a+l.rightNotUsableSize;for(i=a,f=0;f<h;++f,i+=(l.availableWidth-u-a)/h){r=Max([i,l.availableWidth-i]);var m=t.startAngle*Math.PI/180;s=l.available;for(var g=0;g<e.labels.length;g++){var y=n.measureTextMultiLine(e.labels[g],t.scaleFontSize).textWidth+n.measureTextMultiLine(e.labels[g],t.scaleFontSize).textHeight;if(m<Math.PI/2&&m>-Math.PI/2||m>3*Math.PI/2){s=(l.availableWidth-i-y)/Math.abs(Math.cos(m))}else if(Math.cos(m!=0)){s=(i-y)/Math.abs(Math.cos(m))}if(s<r)r=s;if(Math.sin(m)*l.availableHeight/2>l.availableHeight/2-t.scaleFontSize*2){s=Math.sin(m)*l.availableHeight/2-1.5*t.scaleFontSize;if(s<r)r=s}m-=v}if(r>p){p=r;c=i+l.rightNotUsableSize}}r=p-t.scaleFontSize/2;o=Default(o,5)}function w(){var r=-Number.MAX_VALUE;var i=Number.MAX_VALUE;for(var s=0;s<e.datasets.length;s++){for(var a=0;a<e.datasets[s].data.length;a++){if(typeof e.datasets[s].data[a]=="undefined")continue;if(1*e.datasets[s].data[a]>r){r=1*e.datasets[s].data[a]}if(1*e.datasets[s].data[a]<i){i=1*e.datasets[s].data[a]}}}if(r<i){r=0;i=0}if(Math.abs(r-i)<t.zeroValue){if(Math.abs(r)<t.zeroValue){r=.9;i=-.9}if(r>0){r=r*1.1;i=i*.9}else{r=r*.9;i=i*1.1}}if(typeof t.graphMin=="function")i=setOptionValue("GRAPHMIN",n,e,p,undefined,t.graphMin,-1,-1,{nullValue:true});else if(!isNaN(t.graphMin))i=t.graphMin;if(typeof t.graphMax=="function")r=setOptionValue("GRAPHMAX",n,e,p,undefined,t.graphMax,-1,-1,{nullValue:true});else if(!isNaN(t.graphMax))r=t.graphMax;var f=Math.floor(u/(o*.66));var l=Math.floor(u/o*.5);return{maxValue:r,minValue:i,maxSteps:f,minSteps:l}}var r,i,s,o,u,a,f,l,c,h;n.tpchart="Radar";if(!init_and_start(n,e,t))return;var p=initPassVariableData_part1(e,t,n);a=w();t.logarithmic=false;t.logarithmic2=false;if(!e.labels)e.labels=[];f=t.scaleShowLabels?t.scaleLabel:"";if(!t.scaleOverride){s=calculateScale(1,t,a.maxSteps,a.minSteps,a.maxValue,a.minValue,f);l=setMeasures(e,t,n,height,width,s.labels,null,true,false,false,true,t.datasetFill,"Radar")}else{var d=setOptionValue("SCALESTARTVALUE",n,e,p,undefined,t.scaleStartValue,-1,-1,{nullValue:true});var v=setOptionValue("SCALESTEPS",n,e,p,undefined,t.scaleSteps,-1,-1,{nullValue:true});var m=setOptionValue("SCALESTEPWIDTH",n,e,p,undefined,t.scaleStepWidth,-1,-1,{nullValue:true});s={steps:v,stepValue:m,graphMin:d,graphMax:d+v*m,labels:[]};populateLabels(1,t,f,s.labels,s.steps,d,s.graphMax,m);l=setMeasures(e,t,n,height,width,s.labels,null,true,false,false,true,t.datasetFill,"Radar")}b();h=l.topNotUsableSize+l.availableHeight/2;i=r/s.steps;initPassVariableData_part2(p,e,t,n,{midPosX:c,midPosY:h,calculatedScale:s,scaleHop:i,maxSize:r});animationLoop(t,y,g,n,l.clrx,l.clry,l.clrwidth,l.clrheight,c,h,c-r,h+r,e);};var Pie=function(e,t,n){function f(r){for(var f=0;f<e.length;f++){var l=1,c=1;if(t.animation){if(t.animateScale){l=r}if(t.animateRotate){c=r}}correctedRotateAnimation=animationCorrection(c,e,t,f,-1,0).mainVal;if(!(typeof e[f].value=="undefined")&&1*e[f].value>=0){n.beginPath();if(t.animationByData=="ByArc"){endAngle=a[f].startAngle+correctedRotateAnimation*a[f].segmentAngle;n.arc(s,o,l*u,a[f].startAngle,endAngle)}else if(t.animationByData){if(a[f].startAngle-a[f].firstAngle<correctedRotateAnimation*2*Math.PI){endAngle=a[f].endAngle;if(a[f].endAngle-a[f].firstAngle>correctedRotateAnimation*2*Math.PI)endAngle=a[f].firstAngle+correctedRotateAnimation*2*Math.PI;n.arc(s,o,l*u,a[f].startAngle,endAngle)}else continue}else{n.arc(s,o,l*u,a[f].firstAngle+correctedRotateAnimation*(a[f].startAngle-a[f].firstAngle),a[f].firstAngle+correctedRotateAnimation*(a[f].endAngle-a[f].firstAngle))}n.lineTo(s,o);n.closePath();n.fillStyle=setOptionValue("COLOR",n,e,a,e[f].color,t.defaultFillColor,f,-1,{animationDecimal:r,scaleAnimation:l});n.fill();if(t.segmentShowStroke){n.lineWidth=t.segmentStrokeWidth;n.strokeStyle=t.segmentStrokeColor;n.stroke()}}}if(r>=t.animationStopValue){for(var f=0;f<e.length;f++){if(typeof e[f].value=="undefined"||1*e[f].value<0)continue;if(setOptionValue("ANNOTATEDISPLAY",n,e,a,undefined,t.annotateDisplay,f,-1,{nullValue:true})){jsGraphAnnotate[n.ChartNewId][jsGraphAnnotate[n.ChartNewId].length]=["ARC",f,-1,a]}if(setOptionValue("INGRAPHDATASHOW",n,e,a,undefined,t.inGraphDataShow,f,-1,{nullValue:true})&&a[f]["segmentAngle"]>=Math.PI/180*setOptionValue("INGRAPHDATAMINIMUMANGLE",n,e,a,undefined,t.inGraphDataMinimumAngle,f,-1,{nullValue:true})){if(setOptionValue("INGRAPHDATAANGLEPOSITION",n,e,a,undefined,t.inGraphDataAnglePosition,f,-1,{nullValue:true})==1)posAngle=a[f].realStartAngle+setOptionValue("INGRAPHDATAPADDINANGLE",n,e,a,undefined,t.inGraphDataPaddingAngle,f,-1,{nullValue:true})*(Math.PI/180);else if(setOptionValue("INGRAPHDATAANGLEPOSITION",n,e,a,undefined,t.inGraphDataAnglePosition,f,-1,{nullValue:true})==2)posAngle=a[f].realStartAngle-a[f]["segmentAngle"]/2+setOptionValue("INGRAPHDATAPADDINANGLE",n,e,a,undefined,t.inGraphDataPaddingAngle,f,-1,{nullValue:true})*(Math.PI/180);else if(setOptionValue("INGRAPHDATAANGLEPOSITION",n,e,a,undefined,t.inGraphDataAnglePosition,f,-1,{nullValue:true})==3)posAngle=a[f].realStartAngle-a[f].segmentAngle+setOptionValue("INGRAPHDATAPADDINANGLE",n,e,a,undefined,t.inGraphDataPaddingAngle,f,-1,{nullValue:true})*(Math.PI/180);if(setOptionValue("INGRAPHDATARADIUSPOSITION",n,e,a,undefined,t.inGraphDataRadiusPosition,f,-1,{nullValue:true})==1)labelRadius=0+setOptionValue("INGRAPHDATAPADDINGRADIUS",n,e,a,undefined,t.inGraphDataPaddingRadius,f,-1,{nullValue:true});else if(setOptionValue("INGRAPHDATARADIUSPOSITION",n,e,a,undefined,t.inGraphDataRadiusPosition,f,-1,{nullValue:true})==2)labelRadius=u/2+setOptionValue("INGRAPHDATAPADDINGRADIUS",n,e,a,undefined,t.inGraphDataPaddingRadius,f,-1,{nullValue:true});else if(setOptionValue("INGRAPHDATARADIUSPOSITION",n,e,a,undefined,t.inGraphDataRadiusPosition,f,-1,{nullValue:true})==3)labelRadius=u+setOptionValue("INGRAPHDATAPADDINGRADIUS",n,e,a,undefined,t.inGraphDataPaddingRadius,f,-1,{nullValue:true});n.save();if(setOptionValue("INGRAPHDATAALIGN",n,e,a,undefined,t.inGraphDataAlign,f,-1,{nullValue:true})=="off-center"){if(setOptionValue("INGRAPHDATAROTATE",n,e,a,undefined,t.inGraphDataRotate,f,-1,{nullValue:true})=="inRadiusAxis"||(posAngle+2*Math.PI)%(2*Math.PI)>3*Math.PI/2||(posAngle+2*Math.PI)%(2*Math.PI)<Math.PI/2)n.textAlign="left";else n.textAlign="right"}else if(setOptionValue("INGRAPHDATAALIGN",n,e,a,undefined,t.inGraphDataAlign,f,-1,{nullValue:true})=="to-center"){if(setOptionValue("INGRAPHDATAROTATE",n,e,a,undefined,t.inGraphDataRotate,f,-1,{nullValue:true})=="inRadiusAxis"||(posAngle+2*Math.PI)%(2*Math.PI)>3*Math.PI/2||(posAngle+2*Math.PI)%(2*Math.PI)<Math.PI/2)n.textAlign="right";else n.textAlign="left"}else n.textAlign=setOptionValue("INGRAPHDATAALIGN",n,e,a,undefined,t.inGraphDataAlign,f,-1,{nullValue:true});if(setOptionValue("INGRAPHDATAVALIGN",n,e,a,undefined,t.inGraphDataVAlign,f,-1,{nullValue:true})=="off-center"){if((posAngle+2*Math.PI)%(2*Math.PI)>Math.PI)n.textBaseline="top";else n.textBaseline="bottom"}else if(setOptionValue("INGRAPHDATAVALIGN",n,e,a,undefined,t.inGraphDataVAlign,f,-1,{nullValue:true})=="to-center"){if((posAngle+2*Math.PI)%(2*Math.PI)>Math.PI)n.textBaseline="bottom";else n.textBaseline="top"}else n.textBaseline=setOptionValue("INGRAPHDATAVALIGN",n,e,a,undefined,t.inGraphDataVAlign,f,-1,{nullValue:true});n.font=setOptionValue("INGRAPHDATAFONTSTYLE",n,e,a,undefined,t.inGraphDataFontStyle,f,-1,{nullValue:true})+" "+setOptionValue("INGRAPHDATAFONTSIZE",n,e,a,undefined,t.inGraphDataFontSize,f,-1,{nullValue:true})+"px "+setOptionValue("INGRAPHDATAFONTFAMILY",n,e,a,undefined,t.inGraphDataFontFamily,f,-1,{nullValue:true});n.fillStyle=setOptionValue("INGRAPHDATAFONTCOLOR",n,e,a,undefined,t.inGraphDataFontColor,f,-1,{nullValue:true});var h=tmplbis(setOptionValue("INGRAPHDATATMPL",n,e,a,undefined,t.inGraphDataTmpl,f,-1,{nullValue:true}),a[f]);n.translate(s+labelRadius*Math.cos(posAngle),o-labelRadius*Math.sin(posAngle));if(setOptionValue("INGRAPHDATAROTATE",n,e,a,undefined,t.inGraphDataRotate,f,-1,{nullValue:true})=="inRadiusAxis")n.rotate(2*Math.PI-posAngle);else if(setOptionValue("INGRAPHDATAROTATE",n,e,a,undefined,t.inGraphDataRotate,f,-1,{nullValue:true})=="inRadiusAxisRotateLabels"){if((posAngle+2*Math.PI)%(2*Math.PI)>Math.PI/2&&(posAngle+2*Math.PI)%(2*Math.PI)<3*Math.PI/2)n.rotate(3*Math.PI-posAngle);else n.rotate(2*Math.PI-posAngle)}else n.rotate(setOptionValue("INGRAPHDATAROTATE",n,e,a,undefined,t.inGraphDataRotate,f,-1,{nullValue:true})*(Math.PI/180));n.fillTextMultiLine(h,0,0,n.textBaseline,setOptionValue("INGRAPHDATAFONTSIZE",n,e,a,undefined,t.inGraphDataFontSize,f,-1,{nullValue:true}),true);n.restore()}}}if(i.legendMsr.dispLegend)drawLegend(i.legendMsr,e,t,n,"Pie")}function l(){s=i.leftNotUsableSize+i.availableWidth/2;o=i.topNotUsableSize+i.availableHeight/2;u=Min([i.availableHeight/2,i.availableWidth/2])-5;if(isBooleanOptionTrue(undefined,t.inGraphDataShow)&&setOptionValue("INGRAPHDATARADIUSPOSITION",n,e,a,undefined,t.inGraphDataRadiusPosition,0,-1,{nullValue:true})==3&&setOptionValue("INGRAPHDATAALIGN",n,e,a,undefined,t.inGraphDataAlign,0,-1,{nullValue:true})=="off-center"&&setOptionValue("INGRAPHDATAROTATE",n,e,a,undefined,t.inGraphDataRotate,0,-1,{nullValue:true})==0){u=Min([i.availableHeight/2,i.availableWidth/2])-setOptionValue("INGRAPHDATAFONTSIZE",n,e,a,undefined,t.inGraphDataFontSize,0,-1,{nullValue:true})-setOptionValue("INGRAPHDATAPADDINGRADIUS",n,e,a,undefined,t.inGraphDataPaddingRadius,0,-1,{nullValue:true})-5;var r=((t.startAngle*(Math.PI/180)+2*Math.PI)%(2*Math.PI)+2*Math.PI)%(2*Math.PI);for(var f=0;f<e.length;f++){if(!(typeof e[f].value=="undefined")&&1*e[f].value>=0){n.font=setOptionValue("INGRAPHDATAFONTSTYLE",n,e,a,undefined,t.inGraphDataFontStyle,f,-1,{nullValue:true})+" "+setOptionValue("INGRAPHDATAFONTSIZE",n,e,a,undefined,t.inGraphDataFontSize,0,-1,{nullValue:true})+"px "+setOptionValue("INGRAPHDATAFONTFAMILY",n,e,a,undefined,t.inGraphDataFontFamily,f,-1,{nullValue:true});if(setOptionValue("INGRAPHDATAANGLEPOSITION",n,e,a,undefined,t.inGraphDataAnglePosition,f,-1,{nullValue:true})==1)posAngle=r+setOptionValue("INGRAPHDATAPADDINANGLE",n,e,a,undefined,t.inGraphDataPaddingAngle,f,-1,{nullValue:true})*(Math.PI/180);else if(setOptionValue("INGRAPHDATAANGLEPOSITION",n,e,a,undefined,t.inGraphDataAnglePosition,f,-1,{nullValue:true})==2)posAngle=r-a[f].segmentAngle/2+setOptionValue("INGRAPHDATAPADDINANGLE",n,e,a,undefined,t.inGraphDataPaddingAngle,f,-1,{nullValue:true})*(Math.PI/180);else if(setOptionValue("INGRAPHDATAANGLEPOSITION",n,e,a,undefined,t.inGraphDataAnglePosition,f,-1,{nullValue:true})==3)posAngle=r-a[f].segmentAngle+setOptionValue("INGRAPHDATAPADDINANGLE",n,e,a,undefined,t.inGraphDataPaddingAngle,f,-1,{nullValue:true})*(Math.PI/180);r-=a[f].segmentAngle;var l=tmplbis(setOptionValue("INGRAPHDATATMPL",n,e,a,undefined,t.inGraphDataTmpl,f,-1,{nullValue:true}),a[f]);var c=n.measureText(l).width;var h=Math.abs((i.availableWidth/2-c)/Math.cos(posAngle))-setOptionValue("INGRAPHDATAPADDINGRADIUS",n,e,a,undefined,t.inGraphDataPaddingRadius,f,-1,{nullValue:true})-5;if(h<u)u=h}}}u=u*t.radiusScale}var r=0;var i,s,o,u;n.tpchart="Pie";if(!init_and_start(n,e,t))return;var a=initPassVariableData_part1(e,t,n);t.logarithmic=false;t.logarithmic2=false;i=setMeasures(e,t,n,height,width,"none",null,true,false,false,false,true,"Pie");l();if(u>0){initPassVariableData_part2(a,e,t,n,{midPosX:s,midPosY:o,int_radius:0,ext_radius:u});animationLoop(t,null,f,n,i.clrx,i.clry,i.clrwidth,i.clrheight,s,o,s-u,o+u,e)}else{testRedraw(n,e,t)}};var Doughnut=function(e,t,n){function l(a){var l=((-t.startAngle*(Math.PI/180)+2*Math.PI)%(2*Math.PI)+2*Math.PI)%(2*Math.PI);for(var c=0;c<e.length;c++){var h=1,p=1;if(t.animation){if(t.animateScale){h=a}if(t.animateRotate){p=a}}correctedRotateAnimation=animationCorrection(p,e,t,c,-1,0).mainVal;if(!(typeof e[c].value=="undefined")&&1*e[c].value>=0){n.beginPath();if(t.animationByData=="ByArc"){endAngle=u[c].startAngle+correctedRotateAnimation*u[c].segmentAngle;n.arc(i,s,h*o,u[c].startAngle,endAngle,false);n.arc(i,s,h*f,endAngle,u[c].startAngle,true)}else if(t.animationByData){if(u[c].startAngle-u[c].firstAngle<correctedRotateAnimation*2*Math.PI){endAngle=u[c].endAngle;if(u[c].endAngle-u[c].firstAngle>correctedRotateAnimation*2*Math.PI)endAngle=u[c].firstAngle+correctedRotateAnimation*2*Math.PI;n.arc(i,s,h*o,u[c].startAngle,endAngle,false);n.arc(i,s,h*f,endAngle,u[c].startAngle,true)}else continue}else{n.arc(i,s,h*o,u[c].firstAngle+correctedRotateAnimation*(u[c].startAngle-u[c].firstAngle),u[c].firstAngle+correctedRotateAnimation*(u[c].endAngle-u[c].firstAngle),false);n.arc(i,s,h*f,u[c].firstAngle+correctedRotateAnimation*(u[c].endAngle-u[c].firstAngle),u[c].firstAngle+correctedRotateAnimation*(u[c].startAngle-u[c].firstAngle),true)}n.closePath();n.fillStyle=setOptionValue("COLOR",n,e,u,e[c].color,t.defaultFillColor,c,-1,{animationDecimal:a,scaleAnimation:h});n.fill();if(t.segmentShowStroke){n.lineWidth=t.segmentStrokeWidth;n.strokeStyle=t.segmentStrokeColor;n.stroke()}}}if(a>=t.animationStopValue){for(var c=0;c<e.length;c++){if(typeof e[c].value=="undefined"||1*e[c].value<0)continue;if(setOptionValue("ANNOTATEDISPLAY",n,e,u,undefined,t.annotateDisplay,c,-1,{nullValue:true})){jsGraphAnnotate[n.ChartNewId][jsGraphAnnotate[n.ChartNewId].length]=["ARC",c,-1,u]}if(setOptionValue("INGRAPHDATASHOW",n,e,u,undefined,t.inGraphDataShow,c,-1,{nullValue:true})&&u[c].segmentAngle>=Math.PI/180*setOptionValue("INGRAPHDATAMINIMUMANGLE",n,e,u,undefined,t.inGraphDataMinimumAngle,c,-1,{nullValue:true})){if(setOptionValue("INGRAPHDATAANGLEPOSITION",n,e,u,undefined,t.inGraphDataAnglePosition,c,-1,{nullValue:true})==1)posAngle=u[c].realStartAngle+setOptionValue("INGRAPHDATAPADDINANGLE",n,e,u,undefined,t.inGraphDataPaddingAngle,c,-1,{nullValue:true})*(Math.PI/180);else if(setOptionValue("INGRAPHDATAANGLEPOSITION",n,e,u,undefined,t.inGraphDataAnglePosition,c,-1,{nullValue:true})==2)posAngle=u[c].realStartAngle-u[c].segmentAngle/2+setOptionValue("INGRAPHDATAPADDINANGLE",n,e,u,undefined,t.inGraphDataPaddingAngle,c,-1,{nullValue:true})*(Math.PI/180);else if(setOptionValue("INGRAPHDATAANGLEPOSITION",n,e,u,undefined,t.inGraphDataAnglePosition,c,-1,{nullValue:true})==3)posAngle=u[c].realStartAngle-u[c].segmentAngle+setOptionValue("INGRAPHDATAPADDINANGLE",n,e,u,undefined,t.inGraphDataPaddingAngle,c,-1,{nullValue:true})*(Math.PI/180);if(setOptionValue("INGRAPHDATARADIUSPOSITION",n,e,u,undefined,t.inGraphDataRadiusPosition,c,-1,{nullValue:true})==1)labelRadius=f+setOptionValue("INGRAPHDATAPADDINGRADIUS",n,e,u,undefined,t.inGraphDataPaddingRadius,c,-1,{nullValue:true});else if(setOptionValue("INGRAPHDATARADIUSPOSITION",n,e,u,undefined,t.inGraphDataRadiusPosition,c,-1,{nullValue:true})==2)labelRadius=f+(o-f)/2+setOptionValue("INGRAPHDATAPADDINGRADIUS",n,e,u,undefined,t.inGraphDataPaddingRadius,c,-1,{nullValue:true});else if(setOptionValue("INGRAPHDATARADIUSPOSITION",n,e,u,undefined,t.inGraphDataRadiusPosition,c,-1,{nullValue:true})==3)labelRadius=o+setOptionValue("INGRAPHDATAPADDINGRADIUS",n,e,u,undefined,t.inGraphDataPaddingRadius,c,-1,{nullValue:true});n.save();if(setOptionValue("INGRAPHDATAALIGN",n,e,u,undefined,t.inGraphDataAlign,c,-1,{nullValue:true})=="off-center"){if(setOptionValue("INGRAPHDATAROTATE",n,e,u,undefined,t.inGraphDataRotate,c,-1,{nullValue:true})=="inRadiusAxis"||(posAngle+2*Math.PI)%(2*Math.PI)>3*Math.PI/2||(posAngle+2*Math.PI)%(2*Math.PI)<Math.PI/2)n.textAlign="left";else n.textAlign="right"}else if(setOptionValue("INGRAPHDATAALIGN",n,e,u,undefined,t.inGraphDataAlign,c,-1,{nullValue:true})=="to-center"){if(setOptionValue("INGRAPHDATAROTATE",n,e,u,undefined,t.inGraphDataRotate,c,-1,{nullValue:true})=="inRadiusAxis"||(posAngle+2*Math.PI)%(2*Math.PI)>3*Math.PI/2||(posAngle+2*Math.PI)%(2*Math.PI)<Math.PI/2)n.textAlign="right";else n.textAlign="left"}else n.textAlign=setOptionValue("INGRAPHDATAALIGN",n,e,u,undefined,t.inGraphDataAlign,c,-1,{nullValue:true});if(setOptionValue("INGRAPHDATAVALIGN",n,e,u,undefined,t.inGraphDataVAlign,c,-1,{nullValue:true})=="off-center"){if((posAngle+2*Math.PI)%(2*Math.PI)>Math.PI)n.textBaseline="top";else n.textBaseline="bottom"}else if(setOptionValue("INGRAPHDATAVALIGN",n,e,u,undefined,t.inGraphDataVAlign,c,-1,{nullValue:true})=="to-center"){if((posAngle+2*Math.PI)%(2*Math.PI)>Math.PI)n.textBaseline="bottom";else n.textBaseline="top"}else n.textBaseline=setOptionValue("INGRAPHDATAVALIGN",n,e,u,undefined,t.inGraphDataVAlign,c,-1,{nullValue:true});n.font=setOptionValue("INGRAPHDATAFONTSTYLE",n,e,u,undefined,t.inGraphDataFontStyle,c,-1,{nullValue:true})+" "+setOptionValue("INGRAPHDATAFONTSIZE",n,e,u,undefined,t.inGraphDataFontSize,c,-1,{nullValue:true})+"px "+setOptionValue("INGRAPHDATAFONTFAMILY",n,e,u,undefined,t.inGraphDataFontFamily,c,-1,{nullValue:true});n.fillStyle=setOptionValue("INGRAPHDATAFONTCOLOR",n,e,u,undefined,t.inGraphDataFontColor,c,-1,{nullValue:true});var d=tmplbis(setOptionValue("INGRAPHDATATMPL",n,e,u,undefined,t.inGraphDataTmpl,c,-1,{nullValue:true}),u[c]);n.translate(i+labelRadius*Math.cos(posAngle),s-labelRadius*Math.sin(posAngle));if(setOptionValue("INGRAPHDATAROTATE",n,e,u,undefined,t.inGraphDataRotate,c,-1,{nullValue:true})=="inRadiusAxis")n.rotate(2*Math.PI-posAngle);else if(setOptionValue("INGRAPHDATAROTATE",n,e,u,undefined,t.inGraphDataRotate,c,-1,{nullValue:true})=="inRadiusAxisRotateLabels"){if((posAngle+2*Math.PI)%(2*Math.PI)>Math.PI/2&&(posAngle+2*Math.PI)%(2*Math.PI)<3*Math.PI/2)n.rotate(3*Math.PI-posAngle);else n.rotate(2*Math.PI-posAngle)}else n.rotate(setOptionValue("INGRAPHDATAROTATE",n,e,u,undefined,t.inGraphDataRotate,c,-1,{nullValue:true})*(Math.PI/180));n.fillTextMultiLine(d,0,0,n.textBaseline,setOptionValue("INGRAPHDATAFONTSIZE",n,e,u,undefined,t.inGraphDataFontSize,c,-1,{nullValue:true}),true);n.restore()}}}if(r.legendMsr.dispLegend)drawLegend(r.legendMsr,e,t,n,"Doughnut")}function c(){i=r.leftNotUsableSize+r.availableWidth/2;s=r.topNotUsableSize+r.availableHeight/2;o=Min([r.availableHeight/2,r.availableWidth/2])-5;if(isBooleanOptionTrue(undefined,t.inGraphDataShow)&&setOptionValue("INGRAPHDATARADIUSPOSITION",n,e,u,undefined,t.inGraphDataRadiusPosition,0,-1,{nullValue:true})==3&&setOptionValue("INGRAPHDATAALIGN",n,e,u,undefined,t.inGraphDataAlign,0,-1,{nullValue:true})=="off-center"&&setOptionValue("INGRAPHDATAROTATE",n,e,u,undefined,t.inGraphDataRotate,0,-1,{nullValue:true})==0){o=Min([r.availableHeight/2,r.availableWidth/2])-setOptionValue("INGRAPHDATAFONTSIZE",n,e,u,undefined,t.inGraphDataFontSize,0,-1,{nullValue:true})-setOptionValue("INGRAPHDATAPADDINGRADIUS",n,e,u,undefined,t.inGraphDataPaddingRadius,0,-1,{nullValue:true})-5;var a=((t.startAngle*(Math.PI/180)+2*Math.PI)%(2*Math.PI)+2*Math.PI)%(2*Math.PI);var f;for(var l=0;l<e.length;l++){if(!(typeof e[l].value=="undefined")&&1*e[l].value>=0){n.font=setOptionValue("INGRAPHDATAFONTSTYLE",n,e,u,undefined,t.inGraphDataFontStyle,l,-1,{nullValue:true})+" "+setOptionValue("INGRAPHDATAFONTSIZE",n,e,u,undefined,t.inGraphDataFontSize,l,-1,{nullValue:true})+"px "+setOptionValue("INGRAPHDATAFONTFAMILY",n,e,u,undefined,t.inGraphDataFontFamily,l,-1,{nullValue:true});if(setOptionValue("INGRAPHDATAANGLEPOSITION",n,e,u,undefined,t.inGraphDataAnglePosition,l,-1,{nullValue:true})==1)f=a+setOptionValue("INGRAPHDATAPADDINANGLE",n,e,u,undefined,t.inGraphDataPaddingAngle,l,-1,{nullValue:true})*(Math.PI/180);else if(setOptionValue("INGRAPHDATAANGLEPOSITION",n,e,u,undefined,t.inGraphDataAnglePosition,l,-1,{nullValue:true})==2)f=a-u[l].segmentAngle/2+setOptionValue("INGRAPHDATAPADDINANGLE",n,e,u,undefined,t.inGraphDataPaddingAngle,l,-1,{nullValue:true})*(Math.PI/180);else if(setOptionValue("INGRAPHDATAANGLEPOSITION",n,e,u,undefined,t.inGraphDataAnglePosition,l,-1,{nullValue:true})==3)f=a-u[l].segmentAngle+setOptionValue("INGRAPHDATAPADDINANGLE",n,e,u,undefined,t.inGraphDataPaddingAngle,l,-1,{nullValue:true})*(Math.PI/180);a-=u[l].segmentAngle;var c=tmplbis(setOptionValue("INGRAPHDATATMPL",n,e,u,undefined,t.inGraphDataTmpl,l,-1,{nullValue:true}),u[l]);var h=n.measureText(c).width;var p=Math.abs((r.availableWidth/2-h)/Math.cos(f))-setOptionValue("INGRAPHDATAPADDINGRADIUS",n,e,u,undefined,t.inGraphDataPaddingRadius,l,-1,{nullValue:true})-5;if(p<o)o=p}}}o=o*t.radiusScale}var r,i,s,o;n.tpchart="Doughnut";if(!init_and_start(n,e,t))return;var u=initPassVariableData_part1(e,t,n);var a=((t.startAngle*(Math.PI/180)+2*Math.PI)%(2*Math.PI)+2*Math.PI)%(2*Math.PI);t.logarithmic=false;t.logarithmic2=false;r=setMeasures(e,t,n,height,width,"none",null,true,false,false,false,true,"Doughnut");c();var f=o*(t.percentageInnerCutout/100);if(o>0){initPassVariableData_part2(u,e,t,n,{midPosX:i,midPosY:s,int_radius:f,ext_radius:o});animationLoop(t,null,l,n,r.clrx,r.clry,r.clrwidth,r.clrheight,i,s,i-o,s+o,e)}else{testRedraw(n,e,t)}};var Line=function(data,config,ctx){function drawLines(e){drawLinesDataset(e,data,config,ctx,statData,{xAxisPosY:xAxisPosY,yAxisPosX:yAxisPosX,valueHop:valueHop,nbValueHop:data.labels.length-1});if(e>=1){if(typeof drawMath=="function"){drawMath(ctx,config,data,msr,{xAxisPosY:xAxisPosY,yAxisPosX:yAxisPosX,valueHop:valueHop,scaleHop:scaleHop,zeroY:zeroY,calculatedScale:calculatedScale,calculateOffset:calculateOffset,statData:statData})}}if(msr.legendMsr.dispLegend)drawLegend(msr.legendMsr,data,config,ctx,"Line")}function drawScale(){if(config.drawXScaleLine!==false){for(var e=0;e<config.drawXScaleLine.length;e++){ctx.lineWidth=config.drawXScaleLine[e].lineWidth?config.drawXScaleLine[e].lineWidth:config.scaleLineWidth;ctx.strokeStyle=config.drawXScaleLine[e].lineColor?config.drawXScaleLine[e].lineColor:config.scaleLineColor;ctx.beginPath();var t;switch(config.drawXScaleLine[e].position){case"bottom":t=xAxisPosY;break;case"top":t=xAxisPosY-msr.availableHeight-config.scaleTickSizeTop;break;case"0":case 0:if(zeroY!=0){t=xAxisPosY-zeroY}break}ctx.moveTo(yAxisPosX-config.scaleTickSizeLeft,t);ctx.lineTo(yAxisPosX+msr.availableWidth+config.scaleTickSizeRight,t);ctx.stroke()}}for(var n=0;n<data.labels.length;n++){ctx.beginPath();ctx.moveTo(yAxisPosX+n*valueHop,xAxisPosY+config.scaleTickSizeBottom);ctx.lineWidth=config.scaleGridLineWidth;ctx.strokeStyle=config.scaleGridLineColor;if(config.scaleShowGridLines&&n>0&&n%config.scaleXGridLinesStep==0){ctx.lineTo(yAxisPosX+n*valueHop,xAxisPosY-msr.availableHeight-config.scaleTickSizeTop)}else{ctx.lineTo(yAxisPosX+n*valueHop,xAxisPosY)}ctx.stroke()}ctx.lineWidth=config.scaleLineWidth;ctx.strokeStyle=config.scaleLineColor;ctx.beginPath();ctx.moveTo(yAxisPosX,xAxisPosY+config.scaleTickSizeBottom);ctx.lineTo(yAxisPosX,xAxisPosY-msr.availableHeight-config.scaleTickSizeTop);ctx.stroke();for(var r=0;r<calculatedScale.steps;r++){ctx.beginPath();ctx.moveTo(yAxisPosX-config.scaleTickSizeLeft,xAxisPosY-(r+1)*scaleHop);ctx.lineWidth=config.scaleGridLineWidth;ctx.strokeStyle=config.scaleGridLineColor;if(config.scaleShowGridLines&&r%config.scaleYGridLinesStep==0){ctx.lineTo(yAxisPosX+msr.availableWidth+config.scaleTickSizeRight,xAxisPosY-(r+1)*scaleHop)}else{ctx.lineTo(yAxisPosX,xAxisPosY-(r+1)*scaleHop)}ctx.stroke()}}function drawLabels(){ctx.font=config.scaleFontStyle+" "+config.scaleFontSize+"px "+config.scaleFontFamily;if(config.xAxisTop||config.xAxisBottom){ctx.textBaseline="top";if(msr.rotateLabels>90){ctx.save();ctx.textAlign="left"}else if(msr.rotateLabels>0){ctx.save();ctx.textAlign="right"}else{ctx.textAlign="center"}ctx.fillStyle=config.scaleFontColor;if(config.xAxisBottom){for(var e=0;e<data.labels.length;e++){ctx.save();if(msr.rotateLabels>0){ctx.translate(yAxisPosX+e*valueHop-msr.highestXLabel/2,msr.xLabelPos);ctx.rotate(-(msr.rotateLabels*(Math.PI/180)));ctx.fillTextMultiLine(fmtChartJS(config,data.labels[e],config.fmtXLabel),0,0,ctx.textBaseline,config.scaleFontSize,true)}else{ctx.fillTextMultiLine(fmtChartJS(config,data.labels[e],config.fmtXLabel),yAxisPosX+e*valueHop,msr.xLabelPos,ctx.textBaseline,config.scaleFontSize,true)}ctx.restore()}}}ctx.textAlign="right";ctx.textBaseline="middle";for(var t=config.showYAxisMin?-1:0;t<calculatedScale.steps;t++){if(config.scaleShowLabels){if(config.yAxisLeft){ctx.textAlign="right";ctx.fillTextMultiLine(calculatedScale.labels[t+1],yAxisPosX-(config.scaleTickSizeLeft+config.yAxisSpaceRight),xAxisPosY-(t+1)*scaleHop,ctx.textBaseline,config.scaleFontSize,true)}if(config.yAxisRight&&!valueBounds.dbAxis){ctx.textAlign="left";ctx.fillTextMultiLine(calculatedScale.labels[t+1],yAxisPosX+msr.availableWidth+(config.scaleTickSizeRight+config.yAxisSpaceRight),xAxisPosY-(t+1)*scaleHop,ctx.textBaseline,config.scaleFontSize,true)}}}if(config.yAxisRight&&valueBounds.dbAxis){for(var t=config.showYAxisMin?-1:0;t<calculatedScale2.steps;t++){if(config.scaleShowLabels){ctx.textAlign="left";ctx.fillTextMultiLine(calculatedScale2.labels[t+1],yAxisPosX+msr.availableWidth+(config.scaleTickSizeRight+config.yAxisSpaceRight),xAxisPosY-(t+1)*scaleHop2,ctx.textBaseline,config.scaleFontSize,true)}}}}function getValueBounds(){var upperValue=-Number.MAX_VALUE;var lowerValue=Number.MAX_VALUE;var upperValue2=-Number.MAX_VALUE;var lowerValue2=Number.MAX_VALUE;var secondAxis=false;var firstAxis=false;for(var i=0;i<data.datasets.length;i++){var mathFctName=data.datasets[i].drawMathDeviation;var mathValueHeight=0;if(typeof eval(mathFctName)=="function"){var parameter={data:data,datasetNr:i};mathValueHeight=window[mathFctName](parameter)}for(var j=0;j<data.datasets[i].data.length;j++){if(typeof data.datasets[i].data[j]=="undefined")continue;if(data.datasets[i].axis==2){secondAxis=true;if(1*data.datasets[i].data[j]+mathValueHeight>upperValue2){upperValue2=1*data.datasets[i].data[j]+mathValueHeight}if(1*data.datasets[i].data[j]-mathValueHeight<lowerValue2){lowerValue2=1*data.datasets[i].data[j]-mathValueHeight}}else{firstAxis=true;if(1*data.datasets[i].data[j]+mathValueHeight>upperValue){upperValue=1*data.datasets[i].data[j]+mathValueHeight}if(1*data.datasets[i].data[j]-mathValueHeight<lowerValue){lowerValue=1*data.datasets[i].data[j]-mathValueHeight}}}}if(upperValue<lowerValue){upperValue=0;lowerValue=0}if(Math.abs(upperValue-lowerValue)<config.zeroValue){if(Math.abs(upperValue)<config.zeroValue)upperValue=.9;if(upperValue>0){upperValue=upperValue*1.1;lowerValue=lowerValue*.9}else{upperValue=upperValue*.9;lowerValue=lowerValue*1.1}}if(typeof config.graphMin=="function")lowerValue=setOptionValue("GRAPHMIN",ctx,data,statData,undefined,config.graphMin,-1,-1,{nullValue:true});else if(!isNaN(config.graphMin))lowerValue=config.graphMin;if(typeof config.graphMax=="function")upperValue=setOptionValue("GRAPHMAX",ctx,data,statData,undefined,config.graphMax,-1,-1,{nullValue:true});else if(!isNaN(config.graphMax))upperValue=config.graphMax;if(secondAxis){if(upperValue2<lowerValue2){upperValue2=0;lowerValue2=0}if(Math.abs(upperValue2-lowerValue2)<config.zeroValue){if(Math.abs(upperValue2)<config.zeroValue)upperValue2=.9;if(upperValue2>0){upperValue2=upperValue2*1.1;lowerValue2=lowerValue2*.9}else{upperValue2=upperValue2*.9;lowerValue2=lowerValue2*1.1}}if(typeof config.graphMin2=="function")lowerValue2=setOptionValue("GRAPHMIN",ctx,data,statData,undefined,config.graphMin2,-1,-1,{nullValue:true});else if(!isNaN(config.graphMin2))lowerValue2=config.graphMin2;if(typeof config.graphMax2=="function")upperValue2=setOptionValue("GRAPHMAX",ctx,data,statData,undefined,config.graphMax2,-1,-1,{nullValue:true});else if(!isNaN(config.graphMax2))upperValue2=config.graphMax2}if(!firstAxis&&secondAxis){upperValue=upperValue2;lowerValue=lowerValue2}labelHeight=config.scaleFontSize;scaleHeight=msr.availableHeight;var maxSteps=Math.floor(scaleHeight/(labelHeight*.66));var minSteps=Math.floor(scaleHeight/labelHeight*.5);return{maxValue:upperValue,minValue:lowerValue,maxValue2:upperValue2,minValue2:lowerValue2,dbAxis:secondAxis,maxSteps:maxSteps,minSteps:minSteps}}var maxSize,scaleHop,scaleHop2,calculatedScale,calculatedScale2,labelHeight,scaleHeight,valueBounds,labelTemplateString,labelTemplateString2;var valueHop,widestXLabel,xAxisLength,yAxisPosX,xAxisPosY,rotateLabels=0,msr;var zeroY=0;var zeroY2=0;ctx.tpchart="Line";if(!init_and_start(ctx,data,config))return;var statData=initPassVariableData_part1(data,config,ctx);var mxlgt=0;for(var i=0;i<data.datasets.length;i++){statData[i][0].tpchart="Line";mxlgt=Max([mxlgt,data.datasets[i].data.length])}if(mxlgt==1){if(typeof data.labels[0]=="string")data.labels=["",data.labels[0],""];for(var i=0;i<data.datasets.length;i++){if(typeof (data.datasets[i].data[0]!="undefined"))data.datasets[i].data=[undefined,data.datasets[i].data[0],undefined]}}msr=setMeasures(data,config,ctx,height,width,"nihil",[""],false,false,true,true,config.datasetFill,"Line");valueBounds=getValueBounds();if(config.logarithmic!==false){if(valueBounds.minValue<=0){config.logarithmic=false}}if(config.logarithmic2!==false){if(valueBounds.minValue2<=0){config.logarithmic2=false}}var OrderOfMagnitude=calculateOrderOfMagnitude(Math.pow(10,calculateOrderOfMagnitude(valueBounds.maxValue)+1))-calculateOrderOfMagnitude(Math.pow(10,calculateOrderOfMagnitude(valueBounds.minValue)));if(config.logarithmic=="fuzzy"&&OrderOfMagnitude<4||config.scaleOverride){config.logarithmic=false}var OrderOfMagnitude2=calculateOrderOfMagnitude(Math.pow(10,calculateOrderOfMagnitude(valueBounds.maxValue2)+1))-calculateOrderOfMagnitude(Math.pow(10,calculateOrderOfMagnitude(valueBounds.minValue2)));if(config.logarithmic2=="fuzzy"&&OrderOfMagnitude2<4||config.scaleOverride2){config.logarithmic2=false}labelTemplateString=config.scaleShowLabels?config.scaleLabel:"";labelTemplateString2=config.scaleShowLabels2?config.scaleLabel2:"";if(!config.scaleOverride){if(valueBounds.maxSteps>0&&valueBounds.minSteps>0){calculatedScale=calculateScale(1,config,valueBounds.maxSteps,valueBounds.minSteps,valueBounds.maxValue,valueBounds.minValue,labelTemplateString)}}else{var scaleStartValue=setOptionValue("SCALESTARTVALUE",ctx,data,statData,undefined,config.scaleStartValue,-1,-1,{nullValue:true});var scaleSteps=setOptionValue("SCALESTEPS",ctx,data,statData,undefined,config.scaleSteps,-1,-1,{nullValue:true});var scaleStepWidth=setOptionValue("SCALESTEPWIDTH",ctx,data,statData,undefined,config.scaleStepWidth,-1,-1,{nullValue:true});calculatedScale={steps:scaleSteps,stepValue:scaleStepWidth,graphMin:scaleStartValue,graphMax:scaleStartValue+scaleSteps*scaleStepWidth,labels:[]};populateLabels(1,config,labelTemplateString,calculatedScale.labels,calculatedScale.steps,scaleStartValue,calculatedScale.graphMax,scaleStepWidth)}if(valueBounds.dbAxis){if(!config.scaleOverride2){if(valueBounds.maxSteps>0&&valueBounds.minSteps>0){calculatedScale2=calculateScale(2,config,valueBounds.maxSteps,valueBounds.minSteps,valueBounds.maxValue2,valueBounds.minValue2,labelTemplateString)}}else{var scaleStartValue2=setOptionValue("SCALESTARTVALUE2",ctx,data,statData,undefined,config.scaleStartValue2,-1,-1,{nullValue:true});var scaleSteps2=setOptionValue("SCALESTEPS2",ctx,data,statData,undefined,config.scaleSteps2,-1,-1,{nullValue:true});var scaleStepWidth2=setOptionValue("SCALESTEPWIDTH2",ctx,data,statData,undefined,config.scaleStepWidth2,-1,-1,{nullValue:true});calculatedScale2={steps:scaleSteps2,stepValue:scaleStepWidth2,graphMin:scaleStartValue2,graphMax:scaleStartValue2+scaleSteps2*scaleStepWidth2,labels:[]};populateLabels(2,config,labelTemplateString2,calculatedScale2.labels,calculatedScale2.steps,scaleStartValue2,calculatedScale2.graphMax,scaleStepWidth2)}}else{calculatedScale2={steps:0,stepValue:0,graphMin:0,graphMax:0,labels:null}}if(valueBounds.maxSteps>0&&valueBounds.minSteps>0){msr=setMeasures(data,config,ctx,height,width,calculatedScale.labels,calculatedScale2.labels,false,false,true,true,config.datasetFill,"Line");var prevHeight=msr.availableHeight;msr.availableHeight=msr.availableHeight-config.scaleTickSizeBottom-config.scaleTickSizeTop;msr.availableWidth=msr.availableWidth-config.scaleTickSizeLeft-config.scaleTickSizeRight;scaleHop=Math.floor(msr.availableHeight/calculatedScale.steps);scaleHop2=Math.floor(msr.availableHeight/calculatedScale2.steps);valueHop=Math.floor(msr.availableWidth/(data.labels.length-1));if(valueHop==0||config.fullWidthGraph)valueHop=msr.availableWidth/(data.labels.length-1);msr.clrwidth=msr.clrwidth-(msr.availableWidth-(data.labels.length-1)*valueHop);msr.availableWidth=(data.labels.length-1)*valueHop;msr.availableHeight=calculatedScale.steps*scaleHop;msr.xLabelPos+=config.scaleTickSizeBottom+config.scaleTickSizeTop-(prevHeight-msr.availableHeight);msr.clrheight+=config.scaleTickSizeBottom+config.scaleTickSizeTop-(prevHeight-msr.availableHeight);yAxisPosX=msr.leftNotUsableSize+config.scaleTickSizeLeft;xAxisPosY=msr.topNotUsableSize+msr.availableHeight+config.scaleTickSizeTop;drawLabels();if(valueBounds.minValue<0){zeroY=calculateOffset(config.logarithmic,0,calculatedScale,scaleHop)}if(valueBounds.minValue2<0){zeroY2=calculateOffset(config.logarithmic2,0,calculatedScale2,scaleHop2)}initPassVariableData_part2(statData,data,config,ctx,{xAxisPosY:xAxisPosY,yAxisPosX:yAxisPosX,valueHop:valueHop,nbValueHop:data.labels.length-1,scaleHop:scaleHop,zeroY:zeroY,calculatedScale:calculatedScale,logarithmic:config.logarithmic,scaleHop2:scaleHop2,zeroY2:zeroY2,msr:msr,calculatedScale2:calculatedScale2,logarithmic2:config.logarithmic2});animationLoop(config,drawScale,drawLines,ctx,msr.clrx,msr.clry,msr.clrwidth,msr.clrheight,yAxisPosX+msr.availableWidth/2,xAxisPosY-msr.availableHeight/2,yAxisPosX,xAxisPosY,data)}else{testRedraw(ctx,data,config)}};var StackedBar=function(e,t,n){function T(r){n.lineWidth=t.barStrokeWidth;for(var i=0;i<e.datasets.length;i++){for(var s=0;s<e.datasets[i].data.length;s++){var o=animationCorrection(r,e,t,i,s,1).animVal;if(o>1)o=o-1;if(typeof e.datasets[i].data[s]=="undefined"||1*e.datasets[i].data[s]==0)continue;if(t.animationByDataset){var u=y[i][s].yPosBottom;var a=y[i][s].yPosTop;a=u+o*(a-u)}else{var u=y[y[i][s].firstNotMissing][s].yPosBottom-o*(y[y[i][s].firstNotMissing][s].yPosBottom-y[i][s].yPosBottom);var a=y[y[i][s].firstNotMissing][s].yPosBottom-o*(y[y[i][s].firstNotMissing][s].yPosBottom-y[i][s].yPosTop)}n.fillStyle=setOptionValue("COLOR",n,e,y,e.datasets[i].fillColor,t.defaultFillColor,i,s,{animationValue:o,xPosLeft:y[i][s].xPosLeft,yPosBottom:u,xPosRight:y[i][s].xPosRight,yPosTop:a});n.strokeStyle=setOptionValue("STROKECOLOR",n,e,y,e.datasets[i].strokeColor,t.defaultStrokeColor,i,s,{nullvalue:null});if(o!=0&&u!=a){n.beginPath();n.moveTo(y[i][s].xPosLeft,u);n.lineTo(y[i][s].xPosLeft,a);n.lineTo(y[i][s].xPosRight,a);n.lineTo(y[i][s].xPosRight,u);if(t.barShowStroke)n.stroke();n.closePath();n.fill()}}}if(r>=t.animationStopValue){var f=0,l=0;for(var i=0;i<e.datasets.length;i++){for(var s=0;s<e.datasets[i].data.length;s++){if(typeof e.datasets[i].data[s]=="undefined")continue;if(setOptionValue("ANNOTATEDISPLAY",n,e,y,undefined,t.annotateDisplay,i,s,{nullValue:true})){jsGraphAnnotate[n.ChartNewId][jsGraphAnnotate[n.ChartNewId].length]=["RECT",i,s,y]}if(setOptionValue("INGRAPHDATASHOW",n,e,y,undefined,t.inGraphDataShow,i,s,{nullValue:true})){n.save();n.textAlign=setOptionValue("INGRAPHDATAALIGN",n,e,y,undefined,t.inGraphDataAlign,i,s,{nullValue:true});n.textBaseline=setOptionValue("INGRAPHDATAVALIGN",n,e,y,undefined,t.inGraphDataVAlign,i,s,{nullValue:true});n.font=setOptionValue("INGRAPHDATAFONTSTYLE",n,e,y,undefined,t.inGraphDataFontStyle,i,s,{nullValue:true})+" "+setOptionValue("INGRAPHDATAFONTSIZE",n,e,y,undefined,t.inGraphDataFontSize,i,s,{nullValue:true})+"px "+setOptionValue("INGRAPHDATAFONTFAMILY",n,e,y,undefined,t.inGraphDataFontFamily,i,s,{nullValue:true});n.fillStyle=setOptionValue("INGRAPHDATAFONTCOLOR",n,e,y,undefined,t.inGraphDataFontColor,i,s,{nullValue:true});var c=tmplbis(setOptionValue("INGRAPHDATATMPL",n,e,y,undefined,t.inGraphDataTmpl,i,s,{nullValue:true}),y[i][s]);n.beginPath();n.beginPath();f=0;l=0;if(setOptionValue("INGRAPHDATAXPOSITION",n,e,y,undefined,t.inGraphDataXPosition,i,s,{nullValue:true})==1){l=y[i][s].xPosLeft+setOptionValue("INGRAPHDATAPADDINGX",n,e,y,undefined,t.inGraphDataPaddingX,i,s,{nullValue:true})}else if(setOptionValue("INGRAPHDATAXPOSITION",n,e,y,undefined,t.inGraphDataXPosition,i,s,{nullValue:true})==2){l=y[i][s].xPosLeft+v/2+setOptionValue("INGRAPHDATAPADDINGX",n,e,y,undefined,t.inGraphDataPaddingX,i,s,{nullValue:true})}else if(setOptionValue("INGRAPHDATAXPOSITION",n,e,y,undefined,t.inGraphDataXPosition,i,s,{nullValue:true})==3){l=y[i][s].xPosLeft+v+setOptionValue("INGRAPHDATAPADDINGX",n,e,y,undefined,t.inGraphDataPaddingX,i,s,{nullValue:true})}if(setOptionValue("INGRAPHDATAYPOSITION",n,e,y,undefined,t.inGraphDataYPosition,i,s,{nullValue:true})==1){f=y[i][s].yPosBottom-setOptionValue("INGRAPHDATAPADDINGY",n,e,y,undefined,t.inGraphDataPaddingY,i,s,{nullValue:true})}else if(setOptionValue("INGRAPHDATAYPOSITION",n,e,y,undefined,t.inGraphDataYPosition,i,s,{nullValue:true})==2){f=(y[i][s].yPosTop+y[i][s].yPosBottom)/2-setOptionValue("INGRAPHDATAPADDINGY",n,e,y,undefined,t.inGraphDataPaddingY,i,s,{nullValue:true})}else if(setOptionValue("INGRAPHDATAYPOSITION",n,e,y,undefined,t.inGraphDataYPosition,i,s,{nullValue:true})==3){f=y[i][s].yPosTop-setOptionValue("INGRAPHDATAPADDINGY",n,e,y,undefined,t.inGraphDataPaddingY,i,s,{nullValue:true})}if(f>g.topNotUsableSize){n.translate(l,f);n.rotate(setOptionValue("INGRAPHDATAROTATE",n,e,y,undefined,t.inGraphDataRotate,i,s,{nullValue:true})*(Math.PI/180));n.fillTextMultiLine(c,0,0,n.textBaseline,setOptionValue("INGRAPHDATAFONTSIZE",n,e,y,undefined,t.inGraphDataFontSize,i,s,{nullValue:true}),true)}n.restore()}}}}if(g.legendMsr.dispLegend)drawLegend(g.legendMsr,e,t,n,"StackedBar")}function N(){n.lineWidth=t.scaleLineWidth;n.strokeStyle=t.scaleLineColor;n.beginPath();n.moveTo(p-t.scaleTickSizeLeft,d);n.lineTo(p+g.availableWidth+t.scaleTickSizeRight,d);n.stroke();for(var r=0;r<e.labels.length;r++){n.beginPath();n.moveTo(p+r*l,d+t.scaleTickSizeBottom);n.lineWidth=t.scaleGridLineWidth;n.strokeStyle=t.scaleGridLineColor;if(t.scaleShowGridLines&&r>0&&r%t.scaleXGridLinesStep==0){n.lineTo(p+r*l,d-g.availableHeight-t.scaleTickSizeTop)}else{n.lineTo(p+r*l,d)}n.stroke()}n.lineWidth=t.scaleLineWidth;n.strokeStyle=t.scaleLineColor;n.beginPath();n.moveTo(p,d+t.scaleTickSizeBottom);n.lineTo(p,d-g.availableHeight-t.scaleTickSizeTop);n.stroke();for(var o=t.showYAxisMin?-1:0;o<s.steps;o++){n.beginPath();n.moveTo(p-t.scaleTickSizeLeft,d-(o+1)*i);n.lineWidth=t.scaleGridLineWidth;n.strokeStyle=t.scaleGridLineColor;if(t.scaleShowGridLines&&o%t.scaleYGridLinesStep==0){n.lineTo(p+g.availableWidth+t.scaleTickSizeRight,d-(o+1)*i)}else{n.lineTo(p,d-(o+1)*i)}n.stroke()}}function C(){n.font=t.scaleFontStyle+" "+t.scaleFontSize+"px "+t.scaleFontFamily;if(t.xAxisTop||t.xAxisBottom){n.textBaseline="top";if(g.rotateLabels>90){n.save();n.textAlign="left"}else if(g.rotateLabels>0){n.save();n.textAlign="right"}else{n.textAlign="center"}n.fillStyle=t.scaleFontColor;if(t.xAxisBottom){for(var r=0;r<e.labels.length;r++){n.save();if(g.rotateLabels>0){n.translate(p+t.barValueSpacing+r*l+v/2-g.highestXLabel/2,g.xLabelPos);n.rotate(-(g.rotateLabels*(Math.PI/180)));n.fillTextMultiLine(fmtChartJS(t,e.labels[r],t.fmtXLabel),0,0,n.textBaseline,t.scaleFontSize,true)}else{n.fillTextMultiLine(fmtChartJS(t,e.labels[r],t.fmtXLabel),p+t.barValueSpacing+r*l+v/2,g.xLabelPos,n.textBaseline,t.scaleFontSize,true)}n.restore()}}}n.textAlign="right";n.textBaseline="middle";for(var o=t.showYAxisMin?-1:0;o<s.steps;o++){if(t.scaleShowLabels){if(t.yAxisLeft){n.textAlign="right";n.fillTextMultiLine(s.labels[o+1],p-(t.scaleTickSizeLeft+t.yAxisSpaceRight),d-(o+1)*i,n.textBaseline,t.scaleFontSize,true)}if(t.yAxisRight){n.textAlign="left";n.fillTextMultiLine(s.labels[o+1],p+g.availableWidth+(t.scaleTickSizeRight+t.yAxisSpaceRight),d-(o+1)*i,n.textBaseline,t.scaleFontSize,true)}}}}function k(){var r=-Number.MAX_VALUE;var i=Number.MAX_VALUE;var s=new Array(e.datasets.length);var a=new Array(e.datasets.length);for(var f=0;f<e.datasets.length;f++){for(var l=0;l<e.datasets[f].data.length;l++){var c=f;var h=0;var p=0;if(!(typeof e.datasets[0].data[l]=="undefined")){if(1*e.datasets[0].data[l]>0){h+=1*e.datasets[0].data[l];if(h>r){r=h}if(h<i){i=h}}else{p+=1*e.datasets[0].data[l];if(p>r){r=p}if(p<i){i=p}}}while(c>0){if(!(typeof e.datasets[c].data[l]=="undefined")){if(1*e.datasets[c].data[l]>0){h+=1*e.datasets[c].data[l];if(h>r){r=h}if(h<i){i=h}}else{p+=1*e.datasets[c].data[l];if(p>r){r=p}if(p<i){i=p}}}c--}}}if(typeof t.graphMin=="function")i=setOptionValue("GRAPHMIN",n,e,y,undefined,t.graphMin,-1,-1,{nullValue:true});else if(!isNaN(t.graphMin))i=t.graphMin;if(typeof t.graphMax=="function")r=setOptionValue("GRAPHMAX",n,e,y,undefined,t.graphMax,-1,-1,{nullValue:true});else if(!isNaN(t.graphMax))r=t.graphMax;if(r<i){r=0;i=0}if(Math.abs(r-i)<t.zeroValue){if(Math.abs(r)<t.zeroValue)r=.9;if(r>0){r=r*1.1;i=i*.9}else{r=r*.9;i=i*1.1}}o=t.scaleFontSize;u=g.availableHeight;var d=Math.floor(u/(o*.66));var v=Math.floor(u/o*.5);return{maxValue:r,minValue:i,maxSteps:d,minSteps:v}}var r,i,s,o,u,a,f,l,c,h,p,d,v,m=0,g;n.tpchart="StackedBar";if(!init_and_start(n,e,t))return;var y=initPassVariableData_part1(e,t,n);t.logarithmic=false;g=setMeasures(e,t,n,height,width,"nihil",[""],true,false,true,true,true,"StackedBar");a=k();if(a.maxSteps>0&&a.minSteps>0){f=t.scaleShowLabels?t.scaleLabel:"";if(!t.scaleOverride){s=calculateScale(1,t,a.maxSteps,a.minSteps,a.maxValue,a.minValue,f);g=setMeasures(e,t,n,height,width,s.labels,null,true,false,true,true,true,"StackedBar")}else{var b=setOptionValue("SCALESTARTVALUE",n,e,y,undefined,t.scaleStartValue,-1,-1,{nullValue:true});var w=setOptionValue("SCALESTEPS",n,e,y,undefined,t.scaleSteps,-1,-1,{nullValue:true});var E=setOptionValue("SCALESTEPWIDTH",n,e,y,undefined,t.scaleStepWidth,-1,-1,{nullValue:true});s={steps:w,stepValue:E,graphMin:b,labels:[]};for(var S=0;S<=s.steps;S++){if(f){s.labels.push(tmpl(f,{value:fmtChartJS(t,1*(b+E*S).toFixed(getDecimalPlaces(E)),t.fmtYLabel)}))}}g=setMeasures(e,t,n,height,width,s.labels,null,true,false,true,true,true,"StackedBar")}var x=g.availableHeight;g.availableHeight=g.availableHeight-t.scaleTickSizeBottom-t.scaleTickSizeTop;g.availableWidth=g.availableWidth-t.scaleTickSizeLeft-t.scaleTickSizeRight;i=Math.floor(g.availableHeight/s.steps);l=Math.floor(g.availableWidth/e.labels.length);if(l==0||t.fullWidthGraph)l=g.availableWidth/e.labels.length;g.clrwidth=g.clrwidth-(g.availableWidth-e.labels.length*l);g.availableWidth=e.labels.length*l;g.availableHeight=s.steps*i;g.xLabelPos+=t.scaleTickSizeBottom+t.scaleTickSizeTop-(x-g.availableHeight);g.clrheight+=t.scaleTickSizeBottom+t.scaleTickSizeTop-(x-g.availableHeight);p=g.leftNotUsableSize+t.scaleTickSizeLeft;d=g.topNotUsableSize+g.availableHeight+t.scaleTickSizeTop;v=l-t.scaleGridLineWidth*2-t.barValueSpacing*2-(t.barDatasetSpacing*e.datasets.length-1)-t.barStrokeWidth/2-1;if(v>=0&&v<=1)v=1;if(v<0&&v>=-1)v=-1;C();initPassVariableData_part2(y,e,t,n,{calculatedScale:s,scaleHop:i,valueHop:l,yAxisPosX:p,xAxisPosY:d,barWidth:v});animationLoop(t,N,T,n,g.clrx,g.clry,g.clrwidth,g.clrheight,p+g.availableWidth/2,d-g.availableHeight/2,p,d,e)}else{testRedraw(n,e,t)}};var HorizontalStackedBar=function(e,t,n){function x(e,t,n){var r=t.steps*t.stepValue;var i=e-t.graphMin;var s=CapValue(i/r,1,0);return n*t.steps*s}function T(r){n.lineWidth=t.barStrokeWidth;for(var i=0;i<e.datasets.length;i++){for(var s=0;s<e.datasets[i].data.length;s++){var o=animationCorrection(r,e,t,i,s,1).animVal;if(o>1)o=o-1;if(typeof e.datasets[i].data[s]=="undefined"||1*e.datasets[i].data[s]==0)continue;if(t.animationByDataset){var u=y[i][s].xPosLeft;var a=y[i][s].xPosRight;a=u+o*(a-u)}else{var u=y[y[i][s].firstNotMissing][s].xPosLeft+o*(y[i][s].xPosLeft-y[y[i][s].firstNotMissing][s].xPosLeft);var a=y[y[i][s].firstNotMissing][s].xPosLeft+o*(y[i][s].xPosRight-y[y[i][s].firstNotMissing][s].xPosLeft)}n.fillStyle=setOptionValue("COLOR",n,e,y,e.datasets[i].fillColor,t.defaultFillColor,i,s,{animationValue:o,xPosLeft:u,yPosBottom:y[i][s].yPosBottom,xPosRight:a,yPosTop:y[i][s].yPosBottom});n.strokeStyle=setOptionValue("STROKECOLOR",n,e,y,e.datasets[i].strokeColor,t.defaultStrokeColor,i,s,{nullvalue:null});if(o!=0&&y[i][s].xPosLeft!=y[i][s].xPosRight){n.beginPath();n.moveTo(u,y[i][s].yPosTop);n.lineTo(a,y[i][s].yPosTop);n.lineTo(a,y[i][s].yPosBottom);n.lineTo(u,y[i][s].yPosBottom);n.lineTo(u,y[i][s].yPosTop);if(t.barShowStroke)n.stroke();n.closePath();n.fill()}}}if(r>=t.animationStopValue){var f=0,l=0;for(var i=0;i<e.datasets.length;i++){for(var s=0;s<e.datasets[i].data.length;s++){if(typeof e.datasets[i].data[s]=="undefined")continue;if(setOptionValue("ANNOTATEDISPLAY",n,e,y,undefined,t.annotateDisplay,i,s,{nullValue:true})){jsGraphAnnotate[n.ChartNewId][jsGraphAnnotate[n.ChartNewId].length]=["RECT",i,s,y]}if(setOptionValue("INGRAPHDATASHOW",n,e,y,undefined,t.inGraphDataShow,i,s,{nullValue:true})){n.save();n.textAlign=setOptionValue("INGRAPHDATAALIGN",n,e,y,undefined,t.inGraphDataAlign,i,s,{nullValue:true});n.textBaseline=setOptionValue("INGRAPHDATAVALIGN",n,e,y,undefined,t.inGraphDataVAlign,i,s,{nullValue:true});n.font=setOptionValue("INGRAPHDATAFONTSTYLE",n,e,y,undefined,t.inGraphDataFontStyle,i,s,{nullValue:true})+" "+setOptionValue("INGRAPHDATAFONTSIZE",n,e,y,undefined,t.inGraphDataFontSize,i,s,{nullValue:true})+"px "+setOptionValue("INGRAPHDATAFONTFAMILY",n,e,y,undefined,t.inGraphDataFontFamily,i,s,{nullValue:true});n.fillStyle=setOptionValue("INGRAPHDATAFONTCOLOR",n,e,y,undefined,t.inGraphDataFontColor,i,s,{nullValue:true});var c=tmplbis(setOptionValue("INGRAPHDATATMPL",n,e,y,undefined,t.inGraphDataTmpl,i,s,{nullValue:true}),y[i][s]);n.beginPath();f=0;l=0;if(setOptionValue("INGRAPHDATAXPOSITION",n,e,y,undefined,t.inGraphDataXPosition,i,s,{nullValue:true})==1){l=y[i][s].xPosLeft+setOptionValue("INGRAPHDATAPADDINGX",n,e,y,undefined,t.inGraphDataPaddingX,i,s,{nullValue:true})}else if(setOptionValue("INGRAPHDATAXPOSITION",n,e,y,undefined,t.inGraphDataXPosition,i,s,{nullValue:true})==2){l=y[i][s].xPosLeft+(y[i][s].xPosRight-y[i][s].xPosLeft)/2+setOptionValue("INGRAPHDATAPADDINGX",n,e,y,undefined,t.inGraphDataPaddingX,i,s,{nullValue:true})}else if(setOptionValue("INGRAPHDATAXPOSITION",n,e,y,undefined,t.inGraphDataXPosition,i,s,{nullValue:true})==3){l=y[i][s].xPosRight+setOptionValue("INGRAPHDATAPADDINGX",n,e,y,undefined,t.inGraphDataPaddingX,i,s,{nullValue:true})}if(setOptionValue("INGRAPHDATAYPOSITION",n,e,y,undefined,t.inGraphDataYPosition,i,s,{nullValue:true})==1){f=y[i][s].yPosBottom-setOptionValue("INGRAPHDATAPADDINGY",n,e,y,undefined,t.inGraphDataPaddingY,i,s,{nullValue:true})}else if(setOptionValue("INGRAPHDATAYPOSITION",n,e,y,undefined,t.inGraphDataYPosition,i,s,{nullValue:true})==2){f=y[i][s].yPosBottom-v/2-setOptionValue("INGRAPHDATAPADDINGY",n,e,y,undefined,t.inGraphDataPaddingY,i,s,{nullValue:true})}else if(setOptionValue("INGRAPHDATAYPOSITION",n,e,y,undefined,t.inGraphDataYPosition,i,s,{nullValue:true})==3){f=y[i][s].yPosTop-setOptionValue("INGRAPHDATAPADDINGY",n,e,y,undefined,t.inGraphDataPaddingY,i,s,{nullValue:true})}if(l<=g.availableWidth+g.leftNotUsableSize){n.translate(l,f);n.rotate(setOptionValue("INGRAPHDATAROTATE",n,e,y,undefined,t.inGraphDataRotate,i,s,{nullValue:true})*(Math.PI/180));n.fillTextMultiLine(c,0,0,n.textBaseline,setOptionValue("INGRAPHDATAFONTSIZE",n,e,y,undefined,t.inGraphDataFontSize,i,s,{nullValue:true}),true);n.restore()}}}}}if(g.legendMsr.dispLegend)drawLegend(g.legendMsr,e,t,n,"HorizontalStackedBar")}function N(){n.lineWidth=t.scaleLineWidth;n.strokeStyle=t.scaleLineColor;n.beginPath();n.moveTo(p-t.scaleTickSizeLeft,d);n.lineTo(p+g.availableWidth,d);n.stroke();for(var r=t.showYAxisMin?-1:0;r<s.steps;r++){if(r>=0){n.beginPath();n.moveTo(p+r*l,d+t.scaleTickSizeBottom);n.lineWidth=t.scaleGridLineWidth;n.strokeStyle=t.scaleGridLineColor;if(t.scaleShowGridLines&&r>0&&r%t.scaleXGridLinesStep==0){n.lineTo(p+r*l,d-g.availableHeight-t.scaleTickSizeTop)}else{n.lineTo(p+r*l,d)}n.stroke()}}n.lineWidth=t.scaleLineWidth;n.strokeStyle=t.scaleLineColor;n.beginPath();n.moveTo(p,d+t.scaleTickSizeBottom);n.lineTo(p,d-g.availableHeight-t.scaleTickSizeTop);n.stroke();for(var o=0;o<e.labels.length;o++){n.beginPath();n.moveTo(p-t.scaleTickSizeLeft,d-(o+1)*i);n.lineWidth=t.scaleGridLineWidth;n.strokeStyle=t.scaleGridLineColor;if(t.scaleShowGridLines&&o%t.scaleYGridLinesStep==0){n.lineTo(p+g.availableWidth,d-(o+1)*i)}else{n.lineTo(p,d-(o+1)*i)}n.stroke()}}function C(){n.font=t.scaleFontStyle+" "+t.scaleFontSize+"px "+t.scaleFontFamily;if(t.scaleShowLabels&&(t.xAxisTop||t.xAxisBottom)){n.textBaseline="top";if(g.rotateLabels>90){n.save();n.textAlign="left"}else if(g.rotateLabels>0){n.save();n.textAlign="right"}else{n.textAlign="center"}n.fillStyle=t.scaleFontColor;if(t.xAxisBottom){for(var r=t.showYAxisMin?-1:0;r<s.steps;r++){n.save();if(g.rotateLabels>0){n.translate(p+(r+1)*l-g.highestXLabel/2,g.xLabelPos);n.rotate(-(g.rotateLabels*(Math.PI/180)));n.fillTextMultiLine(s.labels[r+1],0,0,n.textBaseline,t.scaleFontSize,true)}else{n.fillTextMultiLine(s.labels[r+1],p+(r+1)*l,g.xLabelPos,n.textBaseline,t.scaleFontSize,true)}n.restore()}}}n.textAlign="right";n.textBaseline="middle";for(var o=0;o<e.labels.length;o++){if(t.yAxisLeft){n.textAlign="right";n.fillTextMultiLine(fmtChartJS(t,e.labels[o],t.fmtXLabel),p-(t.scaleTickSizeLeft+t.yAxisSpaceRight),d-(o+1)*i+v/2,n.textBaseline,t.scaleFontSize,true)}if(t.yAxisRight){n.textAlign="left";n.fillTextMultiLine(fmtChartJS(t,e.labels[o],t.fmtXLabel),p+g.availableWidth+(t.scaleTickSizeRight+t.yAxisSpaceRight),d-(o+1)*i+v/2,n.textBaseline,t.scaleFontSize,true)}}}function k(){var r=-Number.MAX_VALUE;var i=Number.MAX_VALUE;var s=new Array(e.datasets.length);var a=new Array(e.datasets.length);for(var f=0;f<e.datasets.length;f++){for(var l=0;l<e.datasets[f].data.length;l++){var c=f;var h=0;var p=0;if(!(typeof e.datasets[0].data[l]=="undefined")){if(1*e.datasets[0].data[l]>0){h+=1*e.datasets[0].data[l];if(h>r){r=h}if(h<i){i=h}}else{p+=1*e.datasets[0].data[l];if(p>r){r=p}if(p<i){i=p}}}while(c>0){if(!(typeof e.datasets[c].data[l]=="undefined")){if(1*e.datasets[c].data[l]>0){h+=1*e.datasets[c].data[l];if(h>r){r=h}if(h<i){i=h}}else{p+=1*e.datasets[c].data[l];if(p>r){r=p}if(p<i){i=p}}}c--}}}if(typeof t.graphMin=="function")i=setOptionValue("GRAPHMIN",n,e,y,undefined,t.graphMin,-1,-1,{nullValue:true});else if(!isNaN(t.graphMin))i=t.graphMin;if(typeof t.graphMax=="function")r=setOptionValue("GRAPHMAX",n,e,y,undefined,t.graphMax,-1,-1,{nullValue:true});else if(!isNaN(t.graphMax))r=t.graphMax;if(r<i){r=0;i=0}if(Math.abs(r-i)<t.zeroValue){if(Math.abs(r)<t.zeroValue)r=.9;if(r>0){r=r*1.1;i=i*.9}else{r=r*.9;i=i*1.1}}o=t.scaleFontSize;u=g.availableHeight;var d=Math.floor(u/(o*.66));var v=Math.floor(u/o*.5);return{maxValue:r,minValue:i,maxSteps:d,minSteps:v}}var r,i,s,o,u,a,f,l,c,h,p,d,v,m=0,g;if(t.reverseOrder&&typeof n.reversed=="undefined"){n.reversed=true;e=reverseData(e)}n.tpchart="HorizontalStackedBar";if(!init_and_start(n,e,t))return;var y=initPassVariableData_part1(e,t,n);t.logarithmic=false;g=setMeasures(e,t,n,height,width,"nihil",[""],true,true,true,true,true,"HorizontalStackedBar");a=k();if(a.maxSteps>0&&a.minSteps>0){f=t.scaleShowLabels?t.scaleLabel:"";if(!t.scaleOverride){s=calculateScale(1,t,a.maxSteps,a.minSteps,a.maxValue,a.minValue,f);g=setMeasures(e,t,n,height,width,s.labels,null,true,true,true,true,true,"HorizontalStackedBar")}else{var b=setOptionValue("SCALESTARTVALUE",n,e,y,undefined,t.scaleStartValue,-1,-1,{nullValue:true});var w=setOptionValue("SCALESTEPS",n,e,y,undefined,t.scaleSteps,-1,-1,{nullValue:true});var E=setOptionValue("SCALESTEPWIDTH",n,e,y,undefined,t.scaleStepWidth,-1,-1,{nullValue:true});s={steps:w,stepValue:E,graphMin:b,labels:[]};for(var S=0;S<=s.steps;S++){if(f){s.labels.push(tmpl(f,{value:fmtChartJS(t,1*(b+E*S).toFixed(getDecimalPlaces(E)),t.fmtYLabel)}))}}g=setMeasures(e,t,n,height,width,s.labels,null,true,true,true,true,true,"HorizontalStackedBar")}g.availableHeight=g.availableHeight-t.scaleTickSizeBottom-t.scaleTickSizeTop;g.availableWidth=g.availableWidth-t.scaleTickSizeLeft-t.scaleTickSizeRight;i=Math.floor(g.availableHeight/e.labels.length);l=Math.floor(g.availableWidth/s.steps);if(l==0||t.fullWidthGraph)l=g.availableWidth/s.steps;g.clrwidth=g.clrwidth-(g.availableWidth-s.steps*l);g.availableWidth=s.steps*l;g.availableHeight=e.labels.length*i;p=g.leftNotUsableSize+t.scaleTickSizeLeft;d=g.topNotUsableSize+g.availableHeight+t.scaleTickSizeTop;v=i-t.scaleGridLineWidth*2-t.barValueSpacing*2-(t.barDatasetSpacing*e.datasets.length-1)-t.barStrokeWidth/2-1;if(v>=0&&v<=1)v=1;if(v<0&&v>=-1)v=-1;C();zeroY=x(0,s,i);initPassVariableData_part2(y,e,t,n,{yAxisPosX:p,xAxisPosY:d,barWidth:v,zeroY:zeroY,scaleHop:i,valueHop:l,calculatedScale:s});animationLoop(t,N,T,n,g.clrx,g.clry,g.clrwidth,g.clrheight,p+g.availableWidth/2,d-g.availableHeight/2,p,d,e)}else{testRedraw(n,e,t)}};var Bar=function(data,config,ctx){function drawBars(e){var t,n,r;ctx.lineWidth=config.barStrokeWidth;for(var i=0;i<data.datasets.length;i++){if(data.datasets[i].type=="Line")continue;for(var s=0;s<data.datasets[i].data.length;s++){if(!(typeof data.datasets[i].data[s]=="undefined")){var o=animationCorrection(e,data,config,i,s,1).animVal;if(o>1)o=o-1;var u=o*statData[i][s].barHeight+config.barStrokeWidth/2;ctx.fillStyle=setOptionValue("COLOR",ctx,data,statData,data.datasets[i].fillColor,config.defaultFillColor,i,s,{animationValue:o,xPosLeft:statData[i][s].xPosLeft,yPosBottom:statData[i][s].yPosBottom,xPosRight:statData[i][s].xPosLeft+barWidth,yPosTop:statData[i][s].yPosBottom-u});ctx.strokeStyle=setOptionValue("STROKECOLOR",ctx,data,statData,data.datasets[i].strokeColor,config.defaultStrokeColor,i,s,{nullvalue:null});roundRect(ctx,statData[i][s].xPosLeft,statData[i][s].yPosBottom,barWidth,u,config.barShowStroke,config.barBorderRadius)}}}drawLinesDataset(e,data,config,ctx,statData,{xAxisPosY:xAxisPosY,yAxisPosX:yAxisPosX,valueHop:valueHop,nbValueHop:data.labels.length});if(e>=config.animationStopValue){for(var i=0;i<data.datasets.length;i++){for(var s=0;s<data.datasets[i].data.length;s++){if(typeof data.datasets[i].data[s]=="undefined")continue;if(data.datasets[i].type=="Line")continue;if(setOptionValue("ANNOTATEDISPLAY",ctx,data,statData,undefined,config.annotateDisplay,i,s,{nullValue:true}))jsGraphAnnotate[ctx.ChartNewId][jsGraphAnnotate[ctx.ChartNewId].length]=["RECT",i,s,statData];if(setOptionValue("INGRAPHDATASHOW",ctx,data,statData,undefined,config.inGraphDataShow,i,s,{nullValue:true})){ctx.save();ctx.textAlign=setOptionValue("INGRAPHDATAALIGN",ctx,data,statData,undefined,config.inGraphDataAlign,i,s,{nullValue:true});ctx.textBaseline=setOptionValue("INGRAPHDATAVALIGN",ctx,data,statData,undefined,config.inGraphDataVAlign,i,s,{nullValue:true});ctx.font=setOptionValue("INGRAPHDATAFONTSTYLE",ctx,data,statData,undefined,config.inGraphDataFontStyle,i,s,{nullValue:true})+" "+setOptionValue("INGRAPHDATAFONTSIZE",ctx,data,statData,undefined,config.inGraphDataFontSize,i,s,{nullValue:true})+"px "+setOptionValue("INGRAPHDATAFONTFAMILY",ctx,data,statData,undefined,config.inGraphDataFontFamily,i,s,{nullValue:true});ctx.fillStyle=setOptionValue("INGRAPHDATAFONTCOLOR",ctx,data,statData,undefined,config.inGraphDataFontColor,i,s,{nullValue:true});t=statData[i][s].yPosBottom;n=statData[i][s].yPosTop;ctx.beginPath();var a=0,f=0;if(setOptionValue("INGRAPHDATAXPOSITION",ctx,data,statData,undefined,config.inGraphDataXPosition,i,s,{nullValue:true})==1){f=statData[i][s].xPosLeft+setOptionValue("INGRAPHDATAPADDINGX",ctx,data,statData,undefined,config.inGraphDataPaddingX,i,s,{nullValue:true})}else if(setOptionValue("INGRAPHDATAXPOSITION",ctx,data,statData,undefined,config.inGraphDataXPosition,i,s,{nullValue:true})==2){f=statData[i][s].xPosLeft+barWidth/2+setOptionValue("INGRAPHDATAPADDINGX",ctx,data,statData,undefined,config.inGraphDataPaddingX,i,s,{nullValue:true})}else if(setOptionValue("INGRAPHDATAXPOSITION",ctx,data,statData,undefined,config.inGraphDataXPosition,i,s,{nullValue:true})==3){f=statData[i][s].xPosLeft+barWidth+setOptionValue("INGRAPHDATAPADDINGX",ctx,data,statData,undefined,config.inGraphDataPaddingX,i,s,{nullValue:true})}if(setOptionValue("INGRAPHDATAYPOSITION",ctx,data,statData,undefined,config.inGraphDataYPosition,i,s,{nullValue:true})==1){a=statData[i][s].yPosBottom-setOptionValue("INGRAPHDATAPADDINGY",ctx,data,statData,undefined,config.inGraphDataPaddingY,i,s,{nullValue:true})}else if(setOptionValue("INGRAPHDATAYPOSITION",ctx,data,statData,undefined,config.inGraphDataYPosition,i,s,{nullValue:true})==2){a=(statData[i][s].yPosBottom+statData[i][s].yPosTop)/2-setOptionValue("INGRAPHDATAPADDINGY",ctx,data,statData,undefined,config.inGraphDataPaddingY,i,s,{nullValue:true})}else if(setOptionValue("INGRAPHDATAYPOSITION",ctx,data,statData,undefined,config.inGraphDataYPosition,i,s,{nullValue:true})==3){a=statData[i][s].yPosTop-setOptionValue("INGRAPHDATAPADDINGY",ctx,data,statData,undefined,config.inGraphDataPaddingY,i,s,{nullValue:true})}ctx.translate(f,a);var l=tmplbis(setOptionValue("INGRAPHDATATMPL",ctx,data,statData,undefined,config.inGraphDataTmpl,i,s,{nullValue:true}),statData[i][s]);ctx.rotate(setOptionValue("INGRAPHDATAROTATE",ctx,data,statData,undefined,config.inGraphDataRotate,i,s,{nullValue:true})*(Math.PI/180));ctx.fillTextMultiLine(l,0,0,ctx.textBaseline,setOptionValue("INGRAPHDATAFONTSIZE",ctx,data,statData,undefined,config.inGraphDataFontSize,i,s,{nullValue:true}),true);ctx.restore()}}}}if(e>=1&&typeof drawMath=="function"){drawMath(ctx,config,data,msr,{xAxisPosY:xAxisPosY,yAxisPosX:yAxisPosX,valueHop:valueHop,scaleHop:scaleHop,zeroY:zeroY,calculatedScale:calculatedScale,calculateOffset:calculateOffset,barWidth:barWidth})}if(msr.legendMsr.dispLegend)drawLegend(msr.legendMsr,data,config,ctx,"Bar")}function roundRect(e,t,n,r,i,s,o){e.beginPath();e.moveTo(t+o,n);e.lineTo(t+r-o,n);e.quadraticCurveTo(t+r,n,t+r,n);e.lineTo(t+r,n-i+o);e.quadraticCurveTo(t+r,n-i,t+r-o,n-i);e.lineTo(t+o,n-i);e.quadraticCurveTo(t,n-i,t,n-i+o);e.lineTo(t,n);e.quadraticCurveTo(t,n,t+o,n);if(s)e.stroke();e.closePath();e.fill()}function drawScale(){ctx.lineWidth=config.scaleLineWidth;ctx.strokeStyle=config.scaleLineColor;ctx.beginPath();ctx.moveTo(yAxisPosX-config.scaleTickSizeLeft,xAxisPosY);ctx.lineTo(yAxisPosX+msr.availableWidth+config.scaleTickSizeRight,xAxisPosY);ctx.stroke();for(var e=0;e<data.labels.length;e++){ctx.beginPath();ctx.moveTo(yAxisPosX+e*valueHop,xAxisPosY+config.scaleTickSizeBottom);ctx.lineWidth=config.scaleGridLineWidth;ctx.strokeStyle=config.scaleGridLineColor;if(config.scaleShowGridLines&&e>0&&e%config.scaleXGridLinesStep==0){ctx.lineTo(yAxisPosX+e*valueHop,xAxisPosY-msr.availableHeight-config.scaleTickSizeTop)}else{ctx.lineTo(yAxisPosX+e*valueHop,xAxisPosY)}ctx.stroke()}ctx.lineWidth=config.scaleLineWidth;ctx.strokeStyle=config.scaleLineColor;ctx.beginPath();ctx.moveTo(yAxisPosX,xAxisPosY+config.scaleTickSizeBottom);ctx.lineTo(yAxisPosX,xAxisPosY-msr.availableHeight-config.scaleTickSizeTop);ctx.stroke();for(var t=0;t<calculatedScale.steps;t++){ctx.beginPath();ctx.moveTo(yAxisPosX-config.scaleTickSizeLeft,xAxisPosY-(t+1)*scaleHop);ctx.lineWidth=config.scaleGridLineWidth;ctx.strokeStyle=config.scaleGridLineColor;if(config.scaleShowGridLines&&t%config.scaleYGridLinesStep==0){ctx.lineTo(yAxisPosX+msr.availableWidth+config.scaleTickSizeRight,xAxisPosY-(t+1)*scaleHop)}else{ctx.lineTo(yAxisPosX,xAxisPosY-(t+1)*scaleHop)}ctx.stroke()}}function drawLabels(){ctx.font=config.scaleFontStyle+" "+config.scaleFontSize+"px "+config.scaleFontFamily;if(config.xAxisTop||config.xAxisBottom){ctx.textBaseline="top";if(msr.rotateLabels>90){ctx.save();ctx.textAlign="left"}else if(msr.rotateLabels>0){ctx.save();ctx.textAlign="right"}else{ctx.textAlign="center"}ctx.fillStyle=config.scaleFontColor;if(config.xAxisBottom){for(var e=0;e<data.labels.length;e++){ctx.save();if(msr.rotateLabels>0){ctx.translate(yAxisPosX+e*valueHop+valueHop/2-msr.highestXLabel/2,msr.xLabelPos);ctx.rotate(-(msr.rotateLabels*(Math.PI/180)));ctx.fillTextMultiLine(fmtChartJS(config,data.labels[e],config.fmtXLabel),0,0,ctx.textBaseline,config.scaleFontSize,true)}else{ctx.fillTextMultiLine(fmtChartJS(config,data.labels[e],config.fmtXLabel),yAxisPosX+e*valueHop+valueHop/2,msr.xLabelPos,ctx.textBaseline,config.scaleFontSize,true)}ctx.restore()}}}ctx.textAlign="right";ctx.textBaseline="middle";for(var t=config.showYAxisMin?-1:0;t<calculatedScale.steps;t++){if(config.scaleShowLabels){if(config.yAxisLeft){ctx.textAlign="right";ctx.fillTextMultiLine(calculatedScale.labels[t+1],yAxisPosX-(config.scaleTickSizeLeft+config.yAxisSpaceRight),xAxisPosY-(t+1)*scaleHop,ctx.textBaseline,config.scaleFontSize,true)}if(config.yAxisRight&&!valueBounds.dbAxis){ctx.textAlign="left";ctx.fillTextMultiLine(calculatedScale.labels[t+1],yAxisPosX+msr.availableWidth+(config.scaleTickSizeRight+config.yAxisSpaceRight),xAxisPosY-(t+1)*scaleHop,ctx.textBaseline,config.scaleFontSize,true)}}}if(config.yAxisRight&&valueBounds.dbAxis){for(var t=config.showYAxisMin?-1:0;t<calculatedScale2.steps;t++){if(config.scaleShowLabels){ctx.textAlign="left";ctx.fillTextMultiLine(calculatedScale2.labels[t+1],yAxisPosX+msr.availableWidth+(config.scaleTickSizeRight+config.yAxisSpaceRight),xAxisPosY-(t+1)*scaleHop2,ctx.textBaseline,config.scaleFontSize,true)}}}}function getValueBounds(){var upperValue=-Number.MAX_VALUE;var lowerValue=Number.MAX_VALUE;var upperValue2=-Number.MAX_VALUE;var lowerValue2=Number.MAX_VALUE;var secondAxis=false;var firstAxis=false;for(var i=0;i<data.datasets.length;i++){var mathFctName=data.datasets[i].drawMathDeviation;var mathValueHeight=0;if(typeof eval(mathFctName)=="function"){var parameter={data:data,datasetNr:i};mathValueHeight=window[mathFctName](parameter)}for(var j=0;j<data.datasets[i].data.length;j++){if(typeof data.datasets[i].data[j]=="undefined")continue;if(data.datasets[i].axis==2){secondAxis=true;if(1*data.datasets[i].data[j]+mathValueHeight>upperValue2){upperValue2=1*data.datasets[i].data[j]+mathValueHeight}if(1*data.datasets[i].data[j]-mathValueHeight<lowerValue2){lowerValue2=1*data.datasets[i].data[j]-mathValueHeight}}else{firstAxis=true;if(1*data.datasets[i].data[j]+mathValueHeight>upperValue){upperValue=1*data.datasets[i].data[j]+mathValueHeight}if(1*data.datasets[i].data[j]-mathValueHeight<lowerValue){lowerValue=1*data.datasets[i].data[j]-mathValueHeight}}}}if(upperValue<lowerValue){upperValue=0;lowerValue=0}if(Math.abs(upperValue-lowerValue)<config.zeroValue){if(Math.abs(upperValue)<config.zeroValue)upperValue=.9;if(upperValue>0){upperValue=upperValue*1.1;lowerValue=lowerValue*.9}else{upperValue=upperValue*.9;lowerValue=lowerValue*1.1}}if(typeof config.graphMin=="function")lowerValue=setOptionValue("GRAPHMIN",ctx,data,statData,undefined,config.graphMin,-1,-1,{nullValue:true});else if(!isNaN(config.graphMin))lowerValue=config.graphMin;if(typeof config.graphMax=="function")upperValue=setOptionValue("GRAPHMAX",ctx,data,statData,undefined,config.graphMax,-1,-1,{nullValue:true});else if(!isNaN(config.graphMax))upperValue=config.graphMax;if(secondAxis){if(upperValue2<lowerValue2){upperValue2=0;lowerValue2=0}if(Math.abs(upperValue2-lowerValue2)<config.zeroValue){if(Math.abs(upperValue2)<config.zeroValue)upperValue2=.9;if(upperValue2>0){upperValue2=upperValue2*1.1;lowerValue2=lowerValue2*.9}else{upperValue2=upperValue2*.9;lowerValue2=lowerValue2*1.1}}if(typeof config.graphMin2=="function")lowerValue2=setOptionValue("GRAPHMIN",ctx,data,statData,undefined,config.graphMin2,-1,-1,{nullValue:true});else if(!isNaN(config.graphMin2))lowerValue2=config.graphMin2;if(typeof config.graphMax2=="function")upperValue2=setOptionValue("GRAPHMAX",ctx,data,statData,undefined,config.graphMax2,-1,-1,{nullValue:true});else if(!isNaN(config.graphMax2))upperValue2=config.graphMax2}if(!firstAxis&&secondAxis){upperValue=upperValue2;lowerValue=lowerValue2}labelHeight=config.scaleFontSize;scaleHeight=msr.availableHeight;var maxSteps=Math.floor(scaleHeight/(labelHeight*.66));var minSteps=Math.floor(scaleHeight/labelHeight*.5);return{maxValue:upperValue,minValue:lowerValue,maxValue2:upperValue2,minValue2:lowerValue2,dbAxis:secondAxis,maxSteps:maxSteps,minSteps:minSteps}}var maxSize,scaleHop,scaleHop2,calculatedScale,calculatedScale2,labelHeight,scaleHeight,valueBounds,labelTemplateString,labelTemplateString2,valueHop,widestXLabel,xAxisLength,yAxisPosX,xAxisPosY,barWidth,rotateLabels=0,msr;ctx.tpchart="Bar";if(!init_and_start(ctx,data,config))return;var statData=initPassVariableData_part1(data,config,ctx);var nrOfBars=data.datasets.length;for(var i=0;i<data.datasets.length;i++){if(data.datasets[i].type=="Line"){statData[i][0].tpchart="Line";nrOfBars--}else statData[i][0].tpchart="Bar"}var bufferDataset,l=0;msr=setMeasures(data,config,ctx,height,width,"nihil",[""],true,false,true,true,true,"Bar");valueBounds=getValueBounds();if(valueBounds.minValue<=0)config.logarithmic=false;if(valueBounds.maxSteps>0&&valueBounds.minSteps>0){if(config.logarithmic!==false){if(valueBounds.minValue<=0){config.logarithmic=false}}if(config.logarithmic2!==false){if(valueBounds.minValue2<=0){config.logarithmic2=false}}var OrderOfMagnitude=calculateOrderOfMagnitude(Math.pow(10,calculateOrderOfMagnitude(valueBounds.maxValue)+1))-calculateOrderOfMagnitude(Math.pow(10,calculateOrderOfMagnitude(valueBounds.minValue)));if(config.logarithmic=="fuzzy"&&OrderOfMagnitude<4||config.scaleOverride){config.logarithmic=false}var OrderOfMagnitude2=calculateOrderOfMagnitude(Math.pow(10,calculateOrderOfMagnitude(valueBounds.maxValue2)+1))-calculateOrderOfMagnitude(Math.pow(10,calculateOrderOfMagnitude(valueBounds.minValue2)));if(config.logarithmic2=="fuzzy"&&OrderOfMagnitude2<4||config.scaleOverride2){config.logarithmic2=false}labelTemplateString=config.scaleShowLabels?config.scaleLabel:"";labelTemplateString2=config.scaleShowLabels2?config.scaleLabel2:"";if(!config.scaleOverride){calculatedScale=calculateScale(1,config,valueBounds.maxSteps,valueBounds.minSteps,valueBounds.maxValue,valueBounds.minValue,labelTemplateString)}else{var scaleStartValue=setOptionValue("SCALESTARTVALUE",ctx,data,statData,undefined,config.scaleStartValue,-1,-1,{nullValue:true});var scaleSteps=setOptionValue("SCALESTEPS",ctx,data,statData,undefined,config.scaleSteps,-1,-1,{nullValue:true});var scaleStepWidth=setOptionValue("SCALESTEPWIDTH",ctx,data,statData,undefined,config.scaleStepWidth,-1,-1,{nullValue:true});calculatedScale={steps:scaleSteps,stepValue:scaleStepWidth,graphMin:scaleStartValue,graphMax:scaleStartValue+scaleSteps*scaleStepWidth,labels:[]};populateLabels(1,config,labelTemplateString,calculatedScale.labels,calculatedScale.steps,scaleStartValue,calculatedScale.graphMax,scaleStepWidth)}if(valueBounds.dbAxis){if(!config.scaleOverride2){calculatedScale2=calculateScale(2,config,valueBounds.maxSteps,valueBounds.minSteps,valueBounds.maxValue2,valueBounds.minValue2,labelTemplateString)}else{var scaleStartValue2=setOptionValue("SCALESTARTVALUE2",ctx,data,statData,undefined,config.scaleStartValue2,-1,-1,{nullValue:true});var scaleSteps2=setOptionValue("SCALESTEPS2",ctx,data,statData,undefined,config.scaleSteps2,-1,-1,{nullValue:true});var scaleStepWidth2=setOptionValue("SCALESTEPWIDTH2",ctx,data,statData,undefined,config.scaleStepWidth2,-1,-1,{nullValue:true});calculatedScale2={steps:scaleSteps2,stepValue:scaleStepWidth2,graphMin:scaleStartValue2,graphMax:scaleStartValue2+scaleSteps2*scaleStepWidth2,labels:[]};populateLabels(2,config,labelTemplateString2,calculatedScale2.labels,calculatedScale2.steps,scaleStartValue2,calculatedScale2.graphMax,scaleStepWidth2)}}else{calculatedScale2={steps:0,stepValue:0,graphMin:0,graphMax:0,labels:null}}msr=setMeasures(data,config,ctx,height,width,calculatedScale.labels,calculatedScale2.labels,true,false,true,true,true,"Bar");var prevHeight=msr.availableHeight;msr.availableHeight=msr.availableHeight-config.scaleTickSizeBottom-config.scaleTickSizeTop;msr.availableWidth=msr.availableWidth-config.scaleTickSizeLeft-config.scaleTickSizeRight;scaleHop=Math.floor(msr.availableHeight/calculatedScale.steps);scaleHop2=Math.floor(msr.availableHeight/calculatedScale2.steps);valueHop=Math.floor(msr.availableWidth/data.labels.length);if(valueHop==0||config.fullWidthGraph)valueHop=msr.availableWidth/data.labels.length;msr.clrwidth=msr.clrwidth-(msr.availableWidth-data.labels.length*valueHop);msr.availableWidth=data.labels.length*valueHop;msr.availableHeight=calculatedScale.steps*scaleHop;msr.xLabelPos+=config.scaleTickSizeBottom+config.scaleTickSizeTop-(prevHeight-msr.availableHeight);msr.clrheight+=config.scaleTickSizeBottom+config.scaleTickSizeTop-(prevHeight-msr.availableHeight);yAxisPosX=msr.leftNotUsableSize+config.scaleTickSizeLeft;xAxisPosY=msr.topNotUsableSize+msr.availableHeight+config.scaleTickSizeTop;barWidth=(valueHop-config.scaleGridLineWidth*2-config.barValueSpacing*2-(config.barDatasetSpacing*nrOfBars-1)-(config.barStrokeWidth/2*nrOfBars-1))/nrOfBars;if(barWidth>=0&&barWidth<=1)barWidth=1;if(barWidth<0&&barWidth>=-1)barWidth=-1;var zeroY=0;var zeroY2=0;if(valueBounds.minValue<0){var zeroY=calculateOffset(config.logarithmic,0,calculatedScale,scaleHop)}if(valueBounds.minValue2<0){var zeroY2=calculateOffset(config.logarithmic2,0,calculatedScale2,scaleHop2)}initPassVariableData_part2(statData,data,config,ctx,{msr:msr,yAxisPosX:yAxisPosX,xAxisPosY:xAxisPosY,valueHop:valueHop,barWidth:barWidth,zeroY:zeroY,zeroY2:zeroY2,calculatedScale:calculatedScale,calculatedScale2:calculatedScale2,scaleHop:scaleHop,scaleHop2:scaleHop2});drawLabels();animationLoop(config,drawScale,drawBars,ctx,msr.clrx,msr.clry,msr.clrwidth,msr.clrheight,yAxisPosX+msr.availableWidth/2,xAxisPosY-msr.availableHeight/2,yAxisPosX,xAxisPosY,data)}else{testRedraw(ctx,data,config)}};var HorizontalBar=function(e,t,n){function x(r){for(var i=0;i<e.datasets.length;i++){for(var s=0;s<e.datasets[i].data.length;s++){n.lineWidth=t.barStrokeWidth;var o=animationCorrection(r,e,t,i,s,1).animVal;if(o>1)o=o-1;var u=o*y[i][s].barWidth+t.barStrokeWidth/2;n.fillStyle=setOptionValue("COLOR",n,e,y,e.datasets[i].fillColor,t.defaultFillColor,i,s,{animationValue:o,xPosLeft:y[i][s].xPosLeft,yPosBottom:y[i][s].yPosBottom,xPosRight:y[i][s].xPosLeft+u,yPosTop:y[i][s].yPosBottom});n.strokeStyle=setOptionValue("STROKECOLOR",n,e,y,e.datasets[i].strokeColor,t.defaultStrokeColor,i,s,{nullvalue:null});if(!(typeof e.datasets[i].data[s]=="undefined")){T(n,y[i][s].yPosTop,y[i][s].xPosLeft,v,u,t.barShowStroke,t.barBorderRadius,0)}}}if(r>=t.animationStopValue){for(var i=0;i<e.datasets.length;i++){for(var s=0;s<e.datasets[i].data.length;s++){if(typeof e.datasets[i].data[s]=="undefined")continue;if(setOptionValue("ANNOTATEDISPLAY",n,e,y,undefined,t.annotateDisplay,i,s,{nullValue:true})){jsGraphAnnotate[n.ChartNewId][jsGraphAnnotate[n.ChartNewId].length]=["RECT",i,s,y]}if(setOptionValue("INGRAPHDATASHOW",n,e,y,undefined,t.inGraphDataShow,i,s,{nullValue:true})){n.save();n.textAlign=setOptionValue("INGRAPHDATAALIGN",n,e,y,undefined,t.inGraphDataAlign,i,s,{nullValue:true});n.textBaseline=setOptionValue("INGRAPHDATAVALIGN",n,e,y,undefined,t.inGraphDataVAlign,i,s,{nullValue:true});n.font=setOptionValue("INGRAPHDATAFONTSTYLE",n,e,y,undefined,t.inGraphDataFontStyle,i,s,{nullValue:true})+" "+setOptionValue("INGRAPHDATAFONTSIZE",n,e,y,undefined,t.inGraphDataFontSize,i,s,{nullValue:true})+"px "+setOptionValue("INGRAPHDATAFONTFAMILY",n,e,y,undefined,t.inGraphDataFontFamily,i,s,{nullValue:true});n.fillStyle=setOptionValue("INGRAPHDATAFONTCOLOR",n,e,y,undefined,t.inGraphDataFontColor,i,s,{nullValue:true});n.beginPath();var a=0,f=0;if(setOptionValue("INGRAPHDATAYPOSITION",n,e,y,undefined,t.inGraphDataYPosition,i,s,{nullValue:true})==1){a=y[i][s].yPosTop-setOptionValue("INGRAPHDATAPADDINGY",n,e,y,undefined,t.inGraphDataPaddingY,i,s,{nullValue:true})+v}else if(setOptionValue("INGRAPHDATAYPOSITION",n,e,y,undefined,t.inGraphDataYPosition,i,s,{nullValue:true})==2){a=y[i][s].yPosTop+v/2-setOptionValue("INGRAPHDATAPADDINGY",n,e,y,undefined,t.inGraphDataPaddingY,i,s,{nullValue:true})}else if(setOptionValue("INGRAPHDATAYPOSITION",n,e,y,undefined,t.inGraphDataYPosition,i,s,{nullValue:true})==3){a=y[i][s].yPosTop-setOptionValue("INGRAPHDATAPADDINGY",n,e,y,undefined,t.inGraphDataPaddingY,i,s,{nullValue:true})}if(setOptionValue("INGRAPHDATAXPOSITION",n,e,y,undefined,t.inGraphDataXPosition,i,s,{nullValue:true})==1){f=y[i][s].xPosLeft+setOptionValue("INGRAPHDATAPADDINGX",n,e,y,undefined,t.inGraphDataPaddingX,i,s,{nullValue:true})}else if(setOptionValue("INGRAPHDATAXPOSITION",n,e,y,undefined,t.inGraphDataXPosition,i,s,{nullValue:true})==2){f=(y[i][s].xPosLeft+y[i][s].xPosRight)/2+setOptionValue("INGRAPHDATAPADDINGX",n,e,y,undefined,t.inGraphDataPaddingX,i,s,{nullValue:true})}else if(setOptionValue("INGRAPHDATAXPOSITION",n,e,y,undefined,t.inGraphDataXPosition,i,s,{nullValue:true})==3){f=y[i][s].xPosRight+setOptionValue("INGRAPHDATAPADDINGX",n,e,y,undefined,t.inGraphDataPaddingX,i,s,{nullValue:true})}n.translate(f,a);var l=tmplbis(setOptionValue("INGRAPHDATATMPL",n,e,y,undefined,t.inGraphDataTmpl,i,s,{nullValue:true}),y[i][s]);n.rotate(setOptionValue("INGRAPHDATAROTATE",n,e,y,undefined,t.inGraphDataRotate,i,s,{nullValue:true})*(Math.PI/180));n.fillTextMultiLine(l,0,0,n.textBaseline,setOptionValue("INGRAPHDATAFONTSIZE",n,e,y,undefined,t.inGraphDataFontSize,i,s,{nullValue:true}),true);n.restore()}}}}if(g.legendMsr.dispLegend)drawLegend(g.legendMsr,e,t,n,"HorizontalBar")}function T(e,t,n,r,i,s,o,u){e.beginPath();e.moveTo(n+u,t+o);e.lineTo(n+u,t+r-o);e.quadraticCurveTo(n+u,t+r,n+u,t+r);e.lineTo(n+i-o,t+r);e.quadraticCurveTo(n+i,t+r,n+i,t+r-o);e.lineTo(n+i,t+o);e.quadraticCurveTo(n+i,t,n+i-o,t);e.lineTo(n+u,t);e.quadraticCurveTo(n+u,t,n+u,t+o);if(s)e.stroke();e.closePath();e.fill()}function N(){n.lineWidth=t.scaleLineWidth;n.strokeStyle=t.scaleLineColor;n.beginPath();n.moveTo(p-t.scaleTickSizeLeft,d);n.lineTo(p+g.availableWidth+t.scaleTickSizeRight,d);n.stroke();for(var r=t.showYAxisMin?-1:0;r<s.steps;r++){if(r>=0){n.beginPath();n.moveTo(p+r*l,d+t.scaleTickSizeBottom);n.lineWidth=t.scaleGridLineWidth;n.strokeStyle=t.scaleGridLineColor;if(t.scaleShowGridLines&&r>0&&r%t.scaleXGridLinesStep==0){n.lineTo(p+r*l,d-g.availableHeight-t.scaleTickSizeTop)}else{n.lineTo(p+r*l,d)}n.stroke()}}n.lineWidth=t.scaleLineWidth;n.strokeStyle=t.scaleLineColor;n.beginPath();n.moveTo(p,d+t.scaleTickSizeBottom);n.lineTo(p,d-g.availableHeight-t.scaleTickSizeTop);n.stroke();for(var o=0;o<e.labels.length;o++){n.beginPath();n.moveTo(p-t.scaleTickSizeLeft,d-(o+1)*i);n.lineWidth=t.scaleGridLineWidth;n.strokeStyle=t.scaleGridLineColor;if(t.scaleShowGridLines&&o%t.scaleYGridLinesStep==0){n.lineTo(p+g.availableWidth+t.scaleTickSizeRight,d-(o+1)*i)}else{n.lineTo(p,d-(o+1)*i)}n.stroke()}}function C(){n.font=t.scaleFontStyle+" "+t.scaleFontSize+"px "+t.scaleFontFamily;if(t.scaleShowLabels&&(t.xAxisTop||t.xAxisBottom)){n.textBaseline="top";if(g.rotateLabels>90){n.save();n.textAlign="left"}else if(g.rotateLabels>0){n.save();n.textAlign="right"}else{n.textAlign="center"}n.fillStyle=t.scaleFontColor;if(t.xAxisBottom){for(var r=t.showYAxisMin?-1:0;r<s.steps;r++){n.save();if(g.rotateLabels>0){n.translate(p+(r+1)*l-g.highestXLabel/2,g.xLabelPos);n.rotate(-(g.rotateLabels*(Math.PI/180)));n.fillTextMultiLine(s.labels[r+1],0,0,n.textBaseline,t.scaleFontSize,true)}else{n.fillTextMultiLine(s.labels[r+1],p+(r+1)*l,g.xLabelPos,n.textBaseline,t.scaleFontSize,true)}n.restore()}}}n.textAlign="right";n.textBaseline="middle";for(var o=0;o<e.labels.length;o++){if(t.yAxisLeft){n.textAlign="right";n.fillTextMultiLine(fmtChartJS(t,e.labels[o],t.fmtXLabel),p-(t.scaleTickSizeLeft+t.yAxisSpaceRight),d-o*i-i/2,n.textBaseline,t.scaleFontSize,true)}if(t.yAxisRight){n.textAlign="left";n.fillTextMultiLine(fmtChartJS(t,e.labels[o],t.fmtXLabel),p+g.availableWidth+(t.scaleTickSizeRight+t.yAxisSpaceRight),d-o*i-i/2,n.textBaseline,t.scaleFontSize,true)}}}function k(){var r=-Number.MAX_VALUE;var i=Number.MAX_VALUE;for(var s=0;s<e.datasets.length;s++){for(var a=0;a<e.datasets[s].data.length;a++){if(typeof e.datasets[s].data[a]=="undefined")continue;if(1*e.datasets[s].data[a]>r){r=1*e.datasets[s].data[a]}if(1*e.datasets[s].data[a]<i){i=1*e.datasets[s].data[a]}}}if(r<i){r=0;i=0}if(Math.abs(r-i)<t.zeroValue){if(Math.abs(r)<t.zeroValue)r=.9;if(r>0){r=r*1.1;i=i*.9}else{r=r*.9;i=i*1.1}}if(typeof t.graphMin=="function")i=setOptionValue("GRAPHMIN",n,e,y,undefined,t.graphMin,-1,-1,{nullValue:true});else if(!isNaN(t.graphMin))i=t.graphMin;if(typeof t.graphMax=="function")r=setOptionValue("GRAPHMAX",n,e,y,undefined,t.graphMax,-1,-1,{nullValue:true});else if(!isNaN(t.graphMax))r=t.graphMax;o=t.scaleFontSize;u=g.availableHeight;var f=Math.floor(u/(o*.66));var l=Math.floor(u/o*.5);return{maxValue:r,minValue:i,maxSteps:f,minSteps:l}}var r,i,s,o,u,a,f,l,c,h,p,d,v,m=0,g;n.tpchart="HorizontalBar";if(!init_and_start(n,e,t))return;var y=initPassVariableData_part1(e,t,n);if(t.reverseOrder&&typeof n.reversed=="undefined"){n.reversed=true;e=reverseData(e)}g=setMeasures(e,t,n,height,width,"nihil",[""],true,true,true,true,true,"StackedBar");a=k();if(a.minValue<=0)t.logarithmic=false;if(a.maxSteps>0&&a.minSteps>0){if(t.logarithmic!==false){if(a.minValue<=0){t.logarithmic=false}}f=t.scaleShowLabels?t.scaleLabel:"";if(!t.scaleOverride){s=calculateScale(1,t,a.maxSteps,a.minSteps,a.maxValue,a.minValue,f);g=setMeasures(e,t,n,height,width,s.labels,null,true,true,true,true,true,"HorizontalBar")}else{var b=setOptionValue("SCALESTARTVALUE",n,e,y,undefined,t.scaleStartValue,-1,-1,{nullValue:true});var w=setOptionValue("SCALESTEPS",n,e,y,undefined,t.scaleSteps,-1,-1,{nullValue:true});var E=setOptionValue("SCALESTEPWIDTH",n,e,y,undefined,t.scaleStepWidth,-1,-1,{nullValue:true});s={steps:w,stepValue:E,graphMin:b,graphMax:b+w*E,labels:[]};populateLabels(1,t,f,s.labels,s.steps,b,s.graphMax,E);g=setMeasures(e,t,n,height,width,s.labels,null,true,true,true,true,true,"HorizontalBar")}g.availableHeight=g.availableHeight-t.scaleTickSizeBottom-t.scaleTickSizeTop;g.availableWidth=g.availableWidth-t.scaleTickSizeLeft-t.scaleTickSizeRight;i=Math.floor(g.availableHeight/e.labels.length);l=Math.floor(g.availableWidth/s.steps);if(l==0||t.fullWidthGraph)l=g.availableWidth/s.steps;g.clrwidth=g.clrwidth-(g.availableWidth-s.steps*l);g.availableWidth=s.steps*l;g.availableHeight=e.labels.length*i;p=g.leftNotUsableSize+t.scaleTickSizeLeft;d=g.topNotUsableSize+g.availableHeight+t.scaleTickSizeTop;v=(i-t.scaleGridLineWidth*2-t.barValueSpacing*2-(t.barDatasetSpacing*e.datasets.length-1)-(t.barStrokeWidth/2*e.datasets.length-1))/e.datasets.length;if(v>=0&&v<=1)v=1;if(v<0&&v>=-1)v=-1;var S=0;if(a.minValue<0){var S=calculateOffset(t.logarithmic,0,s,l)}C();initPassVariableData_part2(y,e,t,n,{yAxisPosX:p,xAxisPosY:d,barWidth:v,zeroY:S,scaleHop:i,valueHop:l,calculatedScale:s});animationLoop(t,N,x,n,g.clrx,g.clry,g.clrwidth,g.clrheight,p+g.availableWidth/2,d-g.availableHeight/2,p,d,e)}else{testRedraw(n,e,t)}};var requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)}}();var cache={};};

